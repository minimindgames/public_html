function getProfilePic(a){}function loadUpFriends(){var a={collection:"visible",orderBy:"alphabetical",userId:"me",maxResults:20};gapi.client.plus.people.list(a).execute(function(a){if(a.hasOwnProperty("items"))for(var b=0;b<a.items.length;b++);})}function copy(a){var b,c,d;b=Array.isArray(a)?[]:{};for(d in a)c=a[d],b[d]="object"==typeof c?copy(c):c;return b}function addText(a,b,c,d,e,f){var g=this.game.add.text(0,0,a,{fill:"#"+d,fontWeight:"normal",font:dataStorage.fontContent,backgroundColor:"rgba(255,255,255,0.25)"},this.textGroup);return g.anchor.set(.5),g.setShadow(1,1,"rgba(255,255,255,1)",2),g.dx=.5+b,g.dy=.5+c,g.size=Math.floor(e),g.x=g.dx*this.size.width,g.y=g.dy*this.size.height,f&&g.kill(),g}function addSpriteFromFile(a,b,c){var d;return d=this.create(0,0,a),void 0===b&&(d.kill(),b=c=0),d.anchor.set(.5),d.dx=.5+b,d.dy=.5+c,d.x=d.dx*this.size.width,d.y=d.dy*this.size.height,d}function setTexture(a,b){dataStorage.debug?a.loadTexture(b):a.frameName=b}function addSprite(a,b,c,d,e){var f;return e||(e=this),f=dataStorage.debug?e.create(0,0,a):e.create(0,0,d,a),e&&(f.noscale=!0),f.anchor.set(.5),void 0===b&&(f.kill(),b=c=0),f.dx=.5+b,f.dy=.5+c,f.x=Math.floor(f.dx*this.size.width),f.y=Math.floor(f.dy*this.size.height),f}function makeSprite(a,b,c,d){return dataStorage.debug?a.make.sprite(c,d,b):a.make.sprite(c,d,"atlas",b)}function lockInputbak(a){a||(a=500),this.inputLockTime=this.time.now+a}function handleInputWidgetbak(){if(!this.inputWidget){if(this.game.input.activePointer.targetObject){var a=this;this.inputWidgets.forEach(function(b){if(b.input())return void a.showInputWidget(b)})}return null!==this.inputWidget}return hideInputWidget(this),!0}function dimmOverlaybak(a){var b=window.dimmGraphics;if(b){if(b.width===window.innerWidth&&b.height===window.innerHeight)return}else b=window.dimmGraphics=a.make.graphics(0,0);return b.clear(),b.beginFill(0),b.drawRect(0,0,window.innerWidth,window.innerHeight),b.endFill(),b}function onResize(a,b){var c=b.width,d=b.height;this.width===c&&this.height,this.width=c,this.height=d;var e=c>=d,f=0,g=0;this.headerGroup&&(this.headerGroup.size=e?this.headerGroup.landSize:this.headerGroup.portSize,f+=this.headerGroup.size.width,g+=this.headerGroup.size.height),this.boardGroup&&(this.boardGroup.size=e?this.boardGroup.landSize:this.boardGroup.portSize,f+=this.boardGroup.size.width,g+=this.boardGroup.size.height),this.controlGroup&&(this.controlGroup.size=e?this.controlGroup.landSize:this.controlGroup.portSize,f+=this.controlGroup.size.width,g+=this.controlGroup.size.height),this.adGroup&&(this.adGroup.size=e?this.adGroup.landSize:this.adGroup.portSize);var h=c/f,i=d/g,j=Math.min(h,i);j>1&&(j=1);var k,l=0,m=0;if(k=this.bgGroup,k&&k.resize(j,l,m,c-l,d-m),k=this.headerGroup,k&&(k.resize(j,l,m,c-l,d-m),l+=k.size.width*k.scale.x,m+=k.size.height*k.scale.y),k=this.boardGroup){var n=0,o=0;this.controlGroup&&(n=this.controlGroup.size.width*j,o=this.controlGroup.size.height*j),k.resize(j,l,m,c-l-n,d-m-o),e?l+=k.size.width*k.scale.x:m+=k.size.height*k.scale.y}return k=this.controlGroup,k&&k.resize(j,l,m,c-l,d-m),k=this.adGroup,k&&k.resize(j,0,0,c,d),k=this.popupGroup,k&&k.resize(j,0,0,c,d),k=this.effectGroup,k&&k.resize(j,0,0,c,d),k=this.tutorialGroup,k&&k.resize(j,0,0,c,d),j}function fadeOutEffect(a,b,c){playService.hide();var d=!c,e=a.game.add.graphics(0,0);a.world.remove(e),e.beginFill(2,0,1),tweenColor(a.game,a.game.stage,a.game.stage.backgroundColor,b,750);var f=a.game.width,g=a.game.height,h=Math.max(f,g),i={step:d?h:0};e.drawCircle(f/2,g/2,i.step);var j=a.add.tween(i).to({step:d?0:h},750,Phaser.Easing.Quadratic.InOut,!0).onUpdateCallback(function(){e.clear(),e.beginFill(2,0,1),e.drawCircle(f/2,g/2,i.step)},this);return a.world.mask=e,j}function tweenColor(a,b,c,d,e){var f={step:0},g=a.add.tween(f).to({step:100},e,Phaser.Easing.Linear.None,!1);g.onUpdateCallback(function(){b.backgroundColor=Phaser.Color.interpolateColor(c,d,100,f.step)}),b.backgroundColor=c,g.start()}function addPointer(a,b,c){a.add.sprite(b,c,"atlas","sudokugarden-play.png").anchor.set(.5)}function formatTime(a){var b=Math.floor(a/60);return b+":"+("0"+(a-60*b)).substr(-2)}function renderBg(a){var b=this.game.width,c=this.game.height;this.cache.checkBitmapDataKey("bmd-bg")||(d=this.make.bitmapData(b,c),d.smoothed=!1,this.cache.addBitmapData("bmd-bg",d));var d=this.cache.getBitmapData("bmd-bg");d.width===b&&d.height===c||d.resize(b,c),d.clear();var e=d.ctx.createLinearGradient(0,0,0,d.height);e.addColorStop(0,"#f1e5e5"),e.addColorStop(.25,"#f1e5e5"),e.addColorStop(.5,"#2244ff"),e.addColorStop(.5,"#187d31"),e.addColorStop(1,"#8ba45d"),d.ctx.fillStyle=e,d.ctx.fillRect(0,0,b,c);var f=makeSprite(this.game,"bg-top.png",0,0);f.scale.set(a),f.width=b;var g=f.height;d.draw(f,0,0),f.destroy(),f=makeSprite(this.game,"bg-top-below.png",0,0),f.scale.set(a),d.draw(f,d.width-f.width>>1,g),f.destroy(),f=makeSprite(this.game,"bg-grass.png",0,0),f.scale.set(a),f.width=b,g=c-f.height,d.draw(f,0,c-f.height),f.destroy(),f=makeSprite(this.game,"bg-grass-above.png",0,0),f.scale.set(a),d.draw(f,d.width-f.width>>1,g-f.height),f.destroy(),this.bg||(this.bg=this.game.add.image(0,0,d),this.bg.sendToBack())}function createGame(){var a=window,b={width:a.innerWidth,height:a.innerHeight};new Phaser.Game(b.width,b.height,Phaser.CANVAS,"canvas").state.add("bootState",bootState,!0)}var leadManager=leadManager||{name:"leadManager.",preloaded:!1,increaseScore:function(a,b){console.log(this.name+"increaseScore "+a+" "+b)}},achManager=achManager||{name:"achManager.",preloaded:!1,unlockAchievement:function(a){console.log(this.name+"unlockAchievement "+a)}},constants=constants||{};constants.CLIENT_ID="206761680427-8g4a8o6t230b4f4rqqqdgomnnb1i1n6j.apps.googleusercontent.com",constants.LEAD_TOTAL_WINS="CgkIq7zTn4IGEAIQBQ";var leadTimeUnit=6e4,playService={score:864e5,loginComplete:!1,mainStarted:!1,name:"playService.",achievements:[],leadScores:[{id:"me",rank:5,avatar:"avatar-me.png",name:"You",wins:0,inRow:0,time:0,playerId:null}],getAchievement:function(a){for(var b=0;b<this.achievements.length;b++)if(this.achievements[b].id===a)return this.achievements[b]},getPlayer:function(a){for(var b=0;b<this.leadScores.length;b++)if(this.leadScores[b].id===a)return this.leadScores[b];return null},getAchievements:function(a,b,c){var d,e=[];for(d=0;d<this.achievements.length&&(this.achievements[d].state===a&&e.push({name:this.achievements[d].name,desc:this.achievements[d].desc,id:this.achievements[d].id,icon:this.achievements[d].icon}),!(b>0&&e.length>=b));d++);if(c)for(d=0;d<this.achievements.length&&(this.achievements[d].claim&&e.push({name:this.achievements[d].name,desc:this.achievements[d].desc,id:this.achievements[d].id}),!(b>0&&e.length>=b));d++);return e},getScores:function(){var a=[],b=playService.getPlayer("me");return a.push(b.wins),a},resize:function(a,b,c){var d=document.getElementById("login-buttons");d&&(d.style.left=Math.floor(a*c)+"px",d.style.top=Math.floor(b*c)+"px"),(d=document.getElementById("login-image"))&&(d.style.width=Math.floor(64*c)+"px",d.style.height=Math.floor(64*c)+"px")},showLogin:function(){if(!this.loggedIn&&this.mainStarted&&this.loginComplete){var a=document.getElementById("login-buttons");a&&(a.style.display="block")}},downloadedScore:function(a,b){var c=playService.getPlayer("me"),d=!1;return a===constants.LEAD_TOTAL_WINS&&(b>c.wins?(c.wins=b,d=!0):c.wins>b&&leadManager.increaseScore(a,c.wins)),d},downloadedAchievements:function(a){for(var b=!1,c=0;c<a.length;c++){var d=a[c],e=this.getAchievement(d.id);if(e)if("UNLOCKED"===d.achievementState){if(e&&"UNLOCKED"!==e.state){e.state="UNLOCKED";for(var f=0;f<this.achievements.length-1;f++)this.achievements[f]===e&&this.achievements[f+1].type===e.type&&(this.achievements[f+1].state="REVEALED");b=!0}}else e&&"UNLOCKED"===e.state&&achManager.unlockAchievement(d.id)}b&&(dataStorage.saveAchievements(),mainState.updateAchievements())},loadedScores:function(a){var b=playService.getPlayer("me"),c=!1;a[0]>b.wins&&(b.wins=parseInt(a[0]),c=!0),c&&(mainState.updateScores(),leadManager.increaseScore(constants.LEAD_TOTAL_WINS,b.wins))},loadedAchievements:function(a){var b,c=!1;for(b=0;b<a.length;b++){var d=this.getAchievement(a[b]);if("UNLOCKED"!==d.state)for(c=!0,d.state="UNLOCKED",achManager.unlockAchievement(a[b]),b=0;b<this.achievements.length-1;b++)this.achievements[b]===d&&this.achievements[b+1].type===d.type&&(this.achievements[b+1].state="REVEALED")}c&&mainState.updateAchievements()},showAchievements:function(a){for(var b=[],c=0;c<this.achievements.length&&(this.achievements[c].claim&&(this.achievements[c].claim=!1,b.push({name:this.achievements[c].name,desc:this.achievements[c].desc})),!(a>0&&b.length>=a));c++);return b},setScore:function(a){var b,c;for(playerData=playService.getPlayer("me"),playerData.wins=a,b=0;b<this.achievements.length;b++)if(c=this.achievements[b],1===c.type&&"REVEALED"===c.state&&playerData.wins>=c.data){this.unlockAchievement(c.id,!0);break}return leadManager.increaseScore(constants.LEAD_TOTAL_WINS,playerData.wins),dataStorage.saveScores(),!1},unlockAchievement:function(a,b){var c=this.getAchievement(a);if("UNLOCKED"!==c.state&&(c.state="UNLOCKED",c.claim=!0,achManager.unlockAchievement(a),dataStorage.saveAchievements(),!0))for(var d=0;d<this.achievements.length-1;d++)this.achievements[d]===c&&this.achievements[d+1].type===c.type&&(this.achievements[d+1].state="REVEALED")},hide:function(){var a=document.getElementById("login-buttons");a&&(a.style.display="none")},signedIn:function(a){this.loginComplete=!0,a?(this.loggedIn=!0,this.hide()):this.showLogin()},claimAchievements:function(){for(var a=0;a<this.achievements.length;a++)this.achievements[a].claim&&(achManager.unlockAchievement(this.achievements[a].id),this.achievements[a].claim=!1)},addPlayer:function(a,b,c,d){var e=playService.getPlayer("me");c&&(e.name=c),d&&!e.iconLoaded&&(e.iconLoaded=!0,e.icon=d,mainState.updatePlayerIcon(e)),this.downloadedScore(a,b)&&(dataStorage.saveScores(),mainState.updateScores())},sync:function(){console.log("sync");var a=playService.getPlayer("me");leadManager.increaseScore(constants.LEAD_TOTAL_WINS,a.wins),mainState.updateScores()}};leadManager.preloaded=!1,leadManager.leaderboards={},leadManager.preloadData=function(){leadManager.showLeaderboard(constants.LEAD_TOTAL_WINS)},leadManager.getScore=function(){gapi.client.games.scores.get({playerId:"me",timeSpan:"ALL_TIME",leaderboardId:"ALL"}).execute(function(a){if(!a.error){var b=[];if(a.items&&a.items.length>0)for(var c=0;c<a.items.length;c++)b.push({id:a.items[c].leaderboard_id,value:a.items[c].scoreValue});playService.downloadedScore(b)}}),leadManager.preloaded=!0},leadManager.increaseScore=function(a,b){if(leadManager.preloaded){gapi.client.games.scores.submit({leaderboardId:a,score:b}).execute(function(a){if(a.hasOwnProperty("beatenScoreTimeSpans"))for(var b=0;b<a.beatenScoreTimeSpans.length;b++)"ALL_TIME"===a.beatenScoreTimeSpans[b]&&!0})}},leadManager.showLeaderboard=function(a){gapi.client.games.scores.list({collection:"SOCIAL",leaderboardId:a,timeSpan:"ALL_TIME"}).execute(function(b){if(b.message,b.hasOwnProperty("items")){if(b.playerScore){var c=b.playerScore,d=c.player,e=d.displayName;(!e||e>15)&&d.name&&d.name.givenName&&(e=d.name.givenName);var f=d.avatarImageUrl;f&&(f+="?sz=74"),playService.addPlayer(a,c.scoreValue,e,f)}}else leadManager.preloaded=!0,playService.sync()})},achManager.achievements={},achManager.preloaded=!1,achManager.preloadData=function(){gapi.client.games.achievementDefinitions.list().execute(function(a){if("games#achievementDefinitionsListResponse"===a.kind&&a.hasOwnProperty("items")){for(var b=0;b<a.items.length;b++)achManager.achievements[a.items[b].id]=a.items[b],achManager.achievements[a.items[b].id].achievementState=a.items[b].initialState;achManager.loadAchievementsEarnedByPlayer()}})},achManager.loadAchievementsEarnedByPlayer=function(){gapi.client.games.achievements.list({playerId:"me"}).execute(function(a){if("games#playerAchievementListResponse"===a.kind&&a.hasOwnProperty("items")){for(var b=[],c=0;c<a.items.length;c++){var d=a.items[c];achManager.achievements[d.id].achievementState=d.achievementState,d.hasOwnProperty("formattedCurrentStepsString")&&(achManager.achievements[d.id].formattedCurrentStepsString=d.formattedCurrentStepsString),b.push(achManager.achievements[d.id])}playService.downloadedAchievements(b),achManager.preloaded=!0}else console.log("**Unexpected response **",a)})},achManager.unlockAchievement=function(a){if(achManager.preloaded){gapi.client.games.achievements.unlock({achievementId:a}).execute(function(a){a.newlyUnlocked})}},achManager.reset=function(a){};var login=login||{};login.loadClient=function(){gapi.client.load("games","v1",function(){leadManager.preloadData(),achManager.preloadData()})},login.handleAuthResult=function(a){a&&!a.error?(login.loadClient(),playService.signedIn(!0)):playService.signedIn(!1)},login.showLoginDialog=function(){gapi.auth.signIn()},login.logout=function(){gapi.auth.signOut()};var googleLoginCallback=function(a){login.handleAuthResult(a)};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var dimOverlay=null,dataStorage={URL:"http://minimindgames.com/",title:"Xmas Dash!",name:"xmas-dash-",fontContent:"Source Serif Pro",fontHeader:"Source Code Pro",debug:!1,isAudio:!0,upgrades:[],init:function(){if("undefined"!=typeof Storage)try{var a=localStorage.getItem("audio");null!==a&&"null"!==a&&(this.isAudio="on"===a),a=localStorage.getItem(this.name+"upgrades"),null!==a&&"null"!==a&&(upgrades=a.trim().split(" "),upgradeSpeed=upgrades[0],upgradeLives=upgrades[1],upgradeAgility=upgrades[2],upgradeTurning=upgrades[3]);for(var b=0;b<playGrid.levels.length;b++){var c=playGrid.levels[b];a=localStorage.getItem(this.name+"progress-"+c.id),null!==a&&"null"!==a&&(c.progress=parseInt(a))}a=localStorage.getItem(this.name+"score"),a="1",null!==a&&"null"!==a&&playService.loadedScores(a.trim().split(" "),this),a=localStorage.getItem(this.name+"achievements"),null!==a&&"null"!==a&&playService.loadedAchievements(a.trim().split(" "),this)}catch(d){alert("datastorage err")}},setProgress:function(a,b){if("undefined"!=typeof Storage)try{localStorage.setItem(this.name+"progress-"+a,b)}catch(c){}},setAudio:function(a){if(this.isAudio=a,!a&&this.musicPlaying&&this.musicPlaying.fadeOut(),"undefined"!=typeof Storage)try{localStorage.setItem("audio",a?"on":"off")}catch(b){}},reset:function(){if(console.log("reset dataStorage"),"undefined"!=typeof Storage)try{localStorage.removeItem(this.name+"score"),localStorage.removeItem(this.name+"upgrades"),localStorage.removeItem(this.name+"achievements")}catch(a){}},saveUpgrades:function(a){if("undefined"!=typeof Storage)try{var b=a,c="";b.forEach(function(a){c+=a+" "}),localStorage.setItem(this.name+"upgrades",c),console.log("saveUpgrades "+c)}catch(d){}},saveScores:function(){if("undefined"!=typeof Storage)try{var a=playService.getScores(),b="";a.forEach(function(a){b+=a+" "}),localStorage.setItem(this.name+"score",b),console.log("saveScores "+b)}catch(c){}},saveAchievements:function(){if("undefined"!=typeof Storage)try{var a=playService.getAchievements("UNLOCKED"),b="";a.forEach(function(a){b+=a.id+" "}),localStorage.setItem(this.name+"achievements",b),console.log("saveAchievements "+b)}catch(c){}}};EffectGroup=function(a,b,c){Phaser.Group.call(this,a),this.landSize=b,this.portSize=c,this.size=a.width>a.height?this.landSize:this.portSize,this.textGroup=this.game.add.group(),this.spriteAtlas="atlas"},EffectGroup.prototype=Object.create(Phaser.Group.prototype),EffectGroup.prototype.constructor=EffectGroup,EffectGroup.prototype.addText=function(a,b,c,d,e,f){return addText.call(this,a,b,c,d,e,f)},EffectGroup.prototype.addSpriteFromFile=function(a,b,c){return addSpriteFromFile.call(this,a,b,c)},EffectGroup.prototype.addSprite=function(a,b,c){return addSprite.call(this,a,b,c,this.spriteAtlas)},EffectGroup.prototype.setTexture=function(a,b){dataStorage.debug?a.loadTexture(b):a.frameName=b},EffectGroup.prototype.resize=function(a,b,c,d,e){if(this.scale.set(a),this.explode1){a*=2;var f=200*a;this.explode1.minParticleScale=.1*a,this.explode1.maxParticleScale=.5*a,this.explode1.minParticleSpeed.setTo(-f,-f),this.explode1.maxParticleSpeed.setTo(f,f),f/=2,this.explode2.minParticleScale=.1*a,this.explode2.maxParticleScale=.5*a,this.explode2.minParticleSpeed.setTo(-f,-f),this.explode2.maxParticleSpeed.setTo(f,f),this.spriteScale=a}},EffectGroup.prototype.move=function(a,b,c){a.dx=.5+b,a.dy=.5+c,a.x=Math.floor(a.dx*this.size.width),a.y=Math.floor(a.dy*this.size.height)},EffectGroup.prototype.moveTo=function(a,b){a.dx=b.dx,a.dy=b.dy,a.x=Math.floor(a.dx*this.size.width),a.y=Math.floor(a.dy*this.size.height)},EffectGroup.prototype.enable=function(a){if("sparkle"===a){var b=this.sparkle=this.game.add.emitter(0,0,15);b.makeParticles(["atlas"],["effect-star.png"]),b.setRotation(0,0),b.gravity=0,b.minRotation=-90,b.maxRotation=90,b.setAlpha(1,0,1750,Phaser.Easing.Quadratic.InOut),this.add(b)}if("leaf"===a){var b=this.leaf=this.game.add.emitter(this.game.world.centerX,this.game.world.centerY,10);b.makeParticles(["atlas"],["effect-leaf.png"]),this.add(b)}if("snowflake.png"===a){var b=this.leaf=this.game.add.emitter(this.game.world.centerX,this.game.world.centerY,10);b.makeParticles(["atlas"],["effect-snowflake.png"]),this.add(b)}if("snowing"===a){var b=this.snowing=this.game.add.emitter(this.game.width/2,-32,150);b.makeParticles(["atlas"],["effect-snowflake-1.png","effect-snowflake-2.png","effect-snowflake-3.png"]),this.add(b)}if("explosion"===a){var b=this.explode1=this.game.add.emitter(0,0,50);b.makeParticles(["atlas"],["explode3.png"]),b.width=0,b.height=0,b.gravity=0,b.minRotation=0,b.maxRotation=0,b.setAlpha(1,0,950,Phaser.Easing.Quadratic.InOut),this.add(b),b=this.explode2=this.game.add.emitter(0,0,25),b.makeParticles(["atlas"],["explode4.png"]),b.width=0,b.height=0,b.gravity=0,b.minRotation=0,b.maxRotation=0,b.setAlpha(1,0,950,Phaser.Easing.Quadratic.InOut),this.add(b);var c=this.explodeSprite=this.addSprite("explode1.png",0,0);c.visible=!1,c.anchor.set(.5),c.scale.set(0),c.angle=360*Math.random()}},EffectGroup.prototype.start=function(a,b,c,d){if(this.snowing){var e=150,f=this.scale.x;c<720&&(f=(720-c)/720,e=150*f),this.snowing.maxParticleScale=1*f,this.snowing.minParticleScale=.5*f,this.snowing.setYSpeed(50*f,100*f),this.snowing.setXSpeed(-50*f,50*f),this.snowing.gravity=0,this.snowing.width=c,this.snowing.height=d,this.snowing.minRotation=-70,this.snowing.maxRotation=70,this.snowing.start(!0,2e4,0,e)}else if(this.leaf){var g=this.leaf;g.x=a/this.scale.x,g.width=c,g.height=d,g.y=b/this.scale.y,g.start(!1,5e3,1450,0)}else if(this.explode1){var f=this.scale.x;this.explode1.x=a/f,this.explode1.y=b/f,this.explode2.x=a/f,this.explode2.y=b/f,this.explodeSprite.visible=!0,this.explodeSprite.x=a/f,this.explodeSprite.y=b/f,this.explode1.start(!0,900,50,20),this.explode2.start(!0,900,50,10),this.spriteScale=1,this.explodeSprite.revive(),this.explodeSprite.scale.set(.25),this.game.add.tween(this.explodeSprite.scale).to({x:this.spriteScale,y:this.spriteScale},75,Phaser.Easing.Linear.None,!0).onComplete.add(function(){this.game.add.tween(this.explodeSprite.scale).to({x:.25,y:.25},25,Phaser.Easing.Linear.None,!0).onComplete.add(function(){this.explodeSprite.kill()},this)},this)}else{var g=this.sparkle;g.width=c,g.height=d,g.x=a/this.scale.x,g.y=b/this.scale.y,g.flow(1750,40,1,10)}},PopupGroup=function(a,b){this.size=b,Phaser.Group.call(this,a),this.textGroup=this.game.add.group(),this.visible=!1,this.textGroup.visible=!1,this.fixedToCamera=!0,this.textGroup.fixedToCamera=!0},PopupGroup.prototype=Object.create(Phaser.Group.prototype),PopupGroup.prototype.constructor=PopupGroup,PopupGroup.prototype.addText=function(a,b,c,d,e){return addText.call(this,a,b,c,d,e)},PopupGroup.prototype.addSpriteFromFile=function(a,b,c){return addSpriteFromFile.call(this,a,b,c)},PopupGroup.prototype.addSprite=function(a,b,c){return addSprite.call(this,a,b,c,"atlas")},PopupGroup.prototype.resize=function(a,b,c,d,e){if(this.width=d,this.height=e,this.scale.set(a),this.dim.width=d,this.dim.height=e,this.banner){this.banner.x=d/2/a,this.banner.y=e/2/a,this.bannerBg.x=this.banner.x,this.bannerBg.y=this.banner.y,this.bannerBg.width=d/a;var f=2*d/3/a,g=e/2/a-.9*this.banner.height;this.quackSad&&(this.quackSad.x=f,this.quackSad.y=g),this.quack&&(this.quack.x=f,this.quack.y=g),this.bannerText.x=d/2,this.bannerText.y=e/2,this.bannerText.fontSize=32*a,this.bannerText.wordWrapWidth=500*a}this.dialogBg&&(this.dialogBg.x=d/2/this.scale.x,this.dialogBg.y=e/2/this.scale.y,this.dialogTitle.x=d/2,this.dialogTitle.y=this.game.height/2-250*this.scale.y,this.dialogTitle.fontSize=this.dialogTitle.baseFontSize*a,this.dialogText.x=d/2,this.dialogText.y=this.game.height/2-150*this.scale.y,this.dialogText.fontSize=32*a,this.dialogText.wordWrapWidth=500*a,this.dialogTip.x=this.dialogText.x,this.dialogTip.y=this.dialogText.y+370*this.scale.y,this.dialogTip.fontSize=28*a,this.dialogTip.wordWrapWidth=500*a),this.info&&(this.info.wordWrapWidth=500*a,this.info.x=d/2,this.info.y=e/2,this.info.fontSize=48*a,this.info.wordWrapWidth=500*a),this.infoAction&&(this.dimRight.width=this.dimLeft.width=this.game.width,this.dimRight.height=this.dimLeft.height=this.game.height,this.infoSprite&&(this.infoSprite.x=this.game.width/2/a,this.infoSprite.y=this.game.height/2/a),this.infoTitle2.x=this.infoTitle.x=this.game.width/2,this.infoTitle2.y=this.infoTitle.y=this.game.height/2-192*a,this.infoTitle.fontSize=this.infoTitle.baseFontSize*a,this.infoTitle.wordWrapWidth=720*a,this.infoTitle2.fontSize=this.infoTitle2.baseFontSize*a,this.infoTitle2.wordWrapWidth=720*a,this.infoText2.x=this.infoText.x=this.game.width/2,this.infoText2.y=this.infoText.y=this.infoTitle.y+288*a,this.infoText.fontSize=this.infoText.baseFontSize*a,this.infoText.wordWrapWidth=600*a,this.infoText2.fontSize=this.infoText2.baseFontSize*a,this.infoText2.wordWrapWidth=600*a,this.infoAction.x=this.game.width/2,this.infoAction.y=this.infoText2.y+this.infoText2.height+this.infoAction.height,this.infoAction.fontSize=this.infoAction.baseFontSize*a,this.infoAction.wordWrapWidth=720*a)},PopupGroup.prototype.enable=function(a){if(this.dim||(this.dim=makeSprite(this.game,"popup-dim.png"),this.game.world.add(this.dim),this.dim.alpha=.5,this.dim.kill()),this.dimLeft||(this.dimLeft=makeSprite(this.game,"popup-dim.png"),this.game.world.add(this.dimLeft),this.dimLeft.alpha=1,this.dimLeft.kill()),this.dimRight||(this.dimRight=makeSprite(this.game,"popup-dim.png"),this.game.world.add(this.dimRight),this.dimRight.alpha=1,this.dimRight.kill()),"popup-kid.png"===a){var b;b=this.banner=this.addSprite("popup-banner.png"),b.scale.set(.5);var c={fill:"#000000",align:"center",fontWeight:"normal",font:dataStorage.fontContent},d=this.bannerText=this.game.add.text(0,0,"",c);d.kill(),d.anchor.set(.5),d.wordWrap=!0,this.textGroup.add(d)}if("popup-banner.png"===a||"popup-gauge.png"===a){var b;b=this.bannerBg=this.addSprite("popup-banner-bg.png"),b=this.banner=this.addSprite("popup-banner.png"),b=this.quack=this.addSpriteFromFile("quack.png"),b.scale.set(.375),this.quackSad=b;var c={fill:"#000000",align:"center",fontWeight:"normal",font:dataStorage.fontContent},d=this.bannerText=this.game.add.text(0,0,"",c);if(d.kill(),d.anchor.set(.5),d.wordWrap=!0,this.textGroup.add(d),"popup-gauge.png"===a){var e=this.gaugeBg=makeSprite(this.game,"popup-gauge.png",0,16);e.anchor.set(.5),this.banner.addChild(e);var f,g=2*dataStorage.scoreMax,h=this.game.make.bitmapData(5*g,32);h.smoothed=!1,h.clear();var i=h.ctx.createLinearGradient(0,0,h.width,h.height);i.addColorStop(0,"#00ff00"),i.addColorStop(.5,"#ffff00"),i.addColorStop(1,"#ff0000"),h.ctx.fillStyle=i,h.ctx.fillRect(0,0,5*g,32),this.game.cache.removeBitmapData("bmd-gauge"),this.game.cache.addBitmapData("bmd-gauge",h);var f=this.gauge=this.game.make.sprite(0,0,this.game.cache.getBitmapData("bmd-gauge"));f.anchor.set(.5),f.loadTexture(this.game.cache.getBitmapData("bmd-gauge")),this.gaugeBg.addChild(f);var j=5*-g/2;dataStorage.score<15?j+=7.5*dataStorage.score:dataStorage.score<30?(j+=112.5,j+=5*(dataStorage.score-15)):(j+=112.5,j+=75,j+=2.5*(dataStorage.score-30));var k=this.gaugePointer=this.game.make.sprite(j,0,"atlas","popup-gauge-pointer.png");k.anchor.set(.5),f.addChild(k),e.kill()}}if("popup-dialog.png"===a||"popup-dialog-quit.png"===a||"popup-dialog-upgrade.png"===a){var b;b=this.dialogBg=this.addSprite("popup-dialog-bg.png"),b.inputEnabled=!0,b.input.useHandCursor=!1;var c={fill:"#333",align:"left",fontWeight:"bold",font:dataStorage.fontHeader},d=this.dialogTitle=this.game.add.text(0,0,dataStorage.title,c);d.baseFontSize=34,d.kill(),d.anchor.set(.6,0),d.wordWrap=!1,this.textGroup.add(d),c={fill:"#666",align:"left",fontWeight:"normal",font:dataStorage.fontContent},d=this.dialogText=this.game.add.text(0,0,"",c),d.kill(),d.anchor.set(.5,.1),d.wordWrap=!0,this.textGroup.add(d),d=this.dialogTip=this.game.add.text(0,0,"",c),d.kill(),d.anchor.set(.5),d.wordWrap=!0,this.textGroup.add(d),this.play=makeSprite(this.game,"popup-dialog-play.png"),this.play.inputEnabled=!0,this.play.input.useHandCursor=!0,this.play.input.priorityID=1,this.play.anchor.set(.5),b.addChild(this.play),"popup-dialog-quit.png"===a&&(this.quit=makeSprite(this.game,"popup-dialog-quit.png"),this.quit.inputEnabled=!0,this.quit.input.useHandCursor=!0,this.quit.anchor.set(.5),this.quit.input.priorityID=1,this.quit.y=200,b.addChild(this.quit),this.play.kill()),this.close=makeSprite(this.game,"popup-dialog-close.png"),this.close.inputEnabled=!0,this.close.input.useHandCursor=!0,this.close.input.priorityID=1,this.close.x=200,this.close.y=-250,"popup-dialog-upgrade.png"===a&&this.close.kill(),b.addChild(this.close),"popup-dialog-upgrade.png"===a&&(this.upgradesSteps=[],this.upgradesSteps[0]=[],this.upgradeTurning=this.addUpgrade(0,upgradeTurning,b,"Agility"),this.upgradesSteps[1]=[],this.upgradeSpeed=this.addUpgrade(1,upgradeSpeed,b,"Speed"),this.upgradesSteps[2]=[],this.upgradeAgility=this.addUpgrade(2,upgradeAgility,b,"Wiggle"),this.upgradesSteps[3]=[],this.upgradeLives=this.addUpgrade(3,upgradeLives,b,"Bite"))}if("info"===a){var c={fill:"#ffffff",align:"center",fontWeight:"bold",font:dataStorage.fontHeader},d=this.infoTitle=this.game.add.text(0,0,"",c);d.kill(),d.fontSize=d.baseFontSize=64,d.anchor.set(.5,0),d.wordWrap=!1,this.textGroup.add(d),d=this.infoTitle2=this.game.add.text(0,0,"",c),d.kill(),d.fontSize=d.baseFontSize=64,d.anchor.set(.5,0),d.wordWrap=!1,this.textGroup.add(d),c={fill:"#ffffff",align:"center",fontWeight:"normal",font:dataStorage.fontHeader},d=this.infoText=this.game.add.text(0,0,"",c),d.kill(),d.fontSize=d.baseFontSize=40,d.anchor.set(.5,0),d.wordWrap=!0,this.textGroup.add(d),d=this.infoText2=this.game.add.text(0,0,"",c),d.kill(),d.fontSize=d.baseFontSize=40,d.anchor.set(.5,0),d.wordWrap=!0,this.textGroup.add(d),c={fill:"#ffffff",align:"center",fontWeight:"normal",font:dataStorage.fontHeader},d=this.infoAction=this.game.add.text(0,0,"",c),d.kill(),d.fontSize=d.baseFontSize=24,d.anchor.set(.5,0),d.wordWrap=!1,this.textGroup.add(d),this.infoSprite=makeSprite(this.game,"quack-dance-1.png"),this.infoSprite.anchor.set(.5),this.add(this.infoSprite)}},PopupGroup.prototype.addUpgrade=function(a,b,c,d){var e,f={fill:"#666",align:"left",fontWeight:"normal",font:dataStorage.fontContent},g=this.game.make.text(0,123*a-173,d,f);for(g.anchor.set(.5,.5),g.wordWrap=!1,g.fontSize=32,c.addChild(g),e=0;e<7;e++){var h=makeSprite(this.game,"main-upgrade-step.png");h.anchor.set(.5),h.x=(e-3.5)*h.width,h.y=123*a-125,e<b&&(h.tint=e<=1?16776960:e<=3?16744448:16711680),this.upgradesSteps[a][e]=h,c.addChild(h)}this.upgradesSteps[a][e]=g;var i=makeSprite(this.game,"main-upgrade-plus.png");return i.anchor.set(.5),b<7?(i.inputEnabled=!0,i.input.useHandCursor=!0,i.input.priorityID=1):i.alpha=.5,i.x=(e-3)*h.width,i.y=123*a-125,c.addChild(i),this.upgradesSteps[a][e+1]=i,i},PopupGroup.prototype.enableGauge=function(a,b,c){this.gaugeEnabled=a},PopupGroup.prototype.gaugeX=function(){var a=dataStorage.score,b=dataStorage.scoreMax;a=45,a++;var c=5*b*2,d=Math.log(1)/Math.log(10),e=Math.log(b)/Math.log(10),f=e-d,g=(Math.log(a)/Math.log(10)-d)/f*c;return g-=5*b,alert(g),g},PopupGroup.prototype.showBanner=function(a,b,c,d){if(this.hideTimeout)return void this.hide();this.visible=!0,this.textGroup.visible=!0,this.shade&&this.shade.revive(),this.dim.revive(),this.bannerText.revive();var e;this.quack.kill(),this.quackSad.kill(),e=d?this.quackSad:this.quack,this.bannerBg.revive(),this.banner.revive(),this.game.world.bringToTop(this),this.game.world.bringToTop(this.textGroup),this.hideCallback=c,this.bannerText.text=a,e.y=-this.banner.height/2-.9*this.banner.height,this.bannerBg.y=this.banner.y=-this.banner.height/2,this.gaugeBg&&(this.gaugeEnabled?this.gaugeBg.revive():this.gaugeBg.kill()),this.bannerText.y=this.banner.y*this.scale.y;var f=this.game.height,g=f/2/this.scale.y-.9*this.banner.height,h=f/2/this.scale.y,i=f/2,j=500;this.game.add.tween(e).to({y:g},j,Phaser.Easing.Back.Out,!0,500),this.game.add.tween(this.banner).to({y:h},j,Phaser.Easing.Back.Out,!0,500),this.game.add.tween(this.bannerBg).to({y:h},j,Phaser.Easing.Back.Out,!0,500),this.game.add.tween(this.bannerText).to({y:i},j,Phaser.Easing.Back.Out,!0,500),b&&(this.hideTimeout=this.game.time.events.add(b,function(){this.hideBanner()},this)),this.game.physics&&this.game.physics.arcade},PopupGroup.prototype.hideBanner=function(){this.hideTimeout&&this.game.time.events.remove(this.hideTimeout),this.hideTimeout=null;var a,b=this.game.height,c=250;a=this.quack.visible?this.quack:this.quackSad;var d=Phaser.Easing.Quadratic.In,e=b/this.scale.y+this.banner.height,f=b/this.scale.y+this.banner.height+a.height/2;this.game.add.tween(a).to({y:e},c,d,!0),this.game.add.tween(this.banner).to({y:f},c,d,!0),this.game.add.tween(this.bannerBg).to({y:f},c,d,!0).onComplete.addOnce(function(){this.visible=!1,this.textGroup.visible=!1,this.shade&&this.shade.kill(),this.dim.kill(),this.bannerText.kill(),this.banner.kill(),this.bannerBg.kill(),this.hideCallback&&this.hideCallback.popupHidden.call(this.hideCallback)},this);var g=f*this.scale.y;this.game.add.tween(this.bannerText).to({y:g},c,d,!0),this.game.physics&&this.game.physics.arcade},PopupGroup.prototype.showDialog=function(a,b,c,d,e,f,g){if(this.visible||this.hideTimeout)return void this.hide();if(this.visible=!0,this.textGroup.visible=!0,this.claim&&this.claim.kill(),f?(this.dialogTitle.text=f,this.achievementIcon&&this.achievementIcon.revive(),g&&(this.claim&&this.claim.revive(),this.play.kill())):(this.dialogTitle.text=dataStorage.title,this.achievementIcon&&this.achievementIcon.kill()),this.upgradesSteps)for(var h=0;h<this.upgradesSteps.length;h++)for(var i=0;i<this.upgradesSteps[h].length;i++)f?this.upgradesSteps[h][i].revive():this.upgradesSteps[h][i].kill();this.dim.revive(),this.game.world.bringToTop(this),this.game.world.bringToTop(this.textGroup),this.quit&&(e?this.quit.revive():this.quit.kill()),this.dialogBg.revive(),this.dialogText.text=a,this.dialogText.revive(),this.dialogTitle.revive(),b&&(this.dialogTip.text=b,this.dialogTip.revive()),this.hideCallback=c;var j=this.game.width/this.scale.x,k=this.game.height/this.scale.y,l=-this.dialogBg.width/2;this.dialogBg.x=l,this.dialogBg.y=k/2,this.play.y="ACHIEVEMENT"!==b?200:0,this.dialogTitle.x=l*this.scale.x,this.dialogTitle.y=this.game.height/2-250*this.scale.y,this.dialogText.x=l*this.scale.x,this.dialogText.y=this.game.height/2-150*this.scale.y,this.dialogText.wordWrapWidth=500*this.scale.y,this.dialogTip.x=this.dialogText.x,this.dialogTip.y=this.dialogText.y+370*this.scale.y,this.dialogTip.wordWrapWidth=500*this.scale.y;var m=600;d||(m=1);var n=j/2;this.game.add.tween(this.dialogBg).to({x:n},m,Phaser.Easing.Back.Out,!0),this.game.add.tween(this.dialogTitle).to({x:n*this.scale.x},m,Phaser.Easing.Back.Out,!0),this.game.add.tween(this.dialogText).to({x:n*this.scale.x
},m,Phaser.Easing.Back.Out,!0),this.game.add.tween(this.dialogTip).to({x:n*this.scale.x},m,Phaser.Easing.Back.Out,!0),this.game.physics&&this.game.physics.arcade&&(this.game.physics.arcade.isPaused=!0,this.pausedTime=this.game.time.time)},PopupGroup.prototype.hideDialog=function(){this.hideTimeout&&this.game.time.events.remove(this.hideTimeout),this.hideTimeout=null;var a=500,b=-this.dialogBg.width/2;this.game.add.tween(this.dialogTitle).to({x:b*this.scale.x},a,Phaser.Easing.Back.In,!0),this.game.add.tween(this.dialogText).to({x:b*this.scale.x},a,Phaser.Easing.Back.In,!0),this.game.add.tween(this.dialogTip).to({x:b*this.scale.x},a,Phaser.Easing.Back.In,!0),this.game.add.tween(this.dialogBg).to({x:b},a,Phaser.Easing.Back.In,!0).onComplete.addOnce(function(){this.visible=!1,this.textGroup.visible=!1,this.dim.kill(),this.dialogBg.kill(),this.dialogTitle.kill(),this.dialogText.kill(),this.dialogTip.kill(),this.achievementIcon&&this.achievementIcon.kill()},this),this.hideCallback&&this.hideCallback.popupHidden.call(this.hideCallback),this.game.physics&&this.game.physics.arcade},PopupGroup.prototype.hide=function(){this.banner&&this.banner.visible?this.hideBanner():this.dialogBg&&this.dialogBg.visible&&this.hideDialog(),this.infoTitle&&this.infoTitle.visible&&this.hideInfo()},PopupGroup.prototype.showInfo=function(a,b,c,d,e,f,g,h){if(this.visible||this.hideTimeout)return void this.hide();this.visible=!0,this.textGroup.visible=!0,this.hideState=e,this.hideCallback=f,this.infoTitle.text=a,this.infoTitle2.text=a,this.infoText.text=b,this.infoText2.text=b,this.infoAction.text=c,this.dimLeft.width=this.game.width,this.dimLeft.height=this.game.height,this.dimLeft.x=0,this.dimLeft.y=0,this.dimLeft.revive(),this.dimRight.width=this.game.width,this.dimRight.height=this.game.height,this.dimRight.x=0,this.dimRight.y=0,this.dimRight.revive(),this.game.world.bringToTop(this),this.game.world.bringToTop(this.textGroup),this.infoEnter=g;var i=200,j=this.scale.x;h||(h="snakebite.png"),setTexture(this.infoSprite,h),"snakebite.png"===h&&(this.infoSprite.angle=90),this.infoSprite.x=this.game.width/2/j,this.infoSprite.y=this.game.height/2/j,this.infoSprite.kill(),this.game.time.events.add(250,function(){this.infoSprite.revive()},this),g?(this.infoTitle2.alpha=this.infoTitle.alpha=.5,this.infoText.alpha=this.infoText2.alpha=.5,this.dimLeft.x=-this.dimLeft.width,this.dimRight.x=this.game.width,this.infoTitle2.x=3*this.game.width/2,this.infoTitle.x=-this.game.width/2,this.infoTitle2.y=this.infoTitle.y=this.game.height/2-192*j,this.infoTitle2.y=this.infoTitle.y=this.game.height/2-2*this.infoTitle.height,this.infoText2.x=3*this.game.width/2,this.infoText.x=-this.game.width/2,this.infoText2.y=this.infoText.y=this.infoTitle.y+288*j,this.infoAction.x=this.game.width/2,this.infoAction.y=this.infoText2.y+this.infoText2.height+this.infoAction.height,this.infoTitle.revive(),this.infoTitle2.revive(),this.infoText.revive(),this.infoText2.revive(),this.game.add.tween(this.dimLeft).to({x:0},i,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.dimRight).to({x:0},i,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoTitle).to({x:this.game.width/2},i,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoTitle2).to({x:this.game.width/2},i,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoText).to({x:this.game.width/2},i,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoText2).to({x:this.game.width/2},i,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.infoTitle.alpha=1,this.infoTitle2.alpha=1,this.infoText.alpha=1,this.infoText2.alpha=1},this)):(this.infoTitle2.x=this.infoTitle.x=this.game.width/2,this.infoTitle2.y=this.infoTitle.y=this.game.height/2-192*j,this.infoText2.x=this.infoText.x=this.game.width/2,this.infoText2.y=this.infoText.y=this.infoTitle.y+288*j,this.infoAction.x=this.game.width/2,this.infoAction.y=this.infoText2.y+this.infoText2.height+this.infoAction.height,this.infoTitle.alpha=0,this.infoTitle.revive(),this.game.add.tween(this.infoTitle).to({alpha:1},i,Phaser.Easing.Linear.None,!0),this.infoText.alpha=0,this.infoText.revive(),this.game.add.tween(this.infoText).to({alpha:1},i,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.infoTitle2.revive(),this.infoText2.revive()},this)),this.infoAction.alpha=0,this.infoAction.revive(),this.game.add.tween(this.infoAction).to({alpha:1},i,Phaser.Easing.Linear.None,!0,750),d&&(this.hideTimeout=this.game.time.events.add(d,function(){this.hideInfo()},this)),this.game.physics&&this.game.physics.arcade},PopupGroup.prototype.hideInfo=function(){this.hideTimeout&&this.game.time.events.remove(this.hideTimeout),this.hideTimeout=null,this.infoTitle2.alpha=this.infoTitle.alpha=.5,this.infoText.alpha=this.infoText2.alpha=.5,this.infoAction.alpha=.5;var a=750;if(this.infoEnter)return void this.hideCallback.call(this.hideState);this.game.add.tween(this.dimLeft).to({x:-this.dimLeft.width},a,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.dimRight).to({x:this.game.width},a,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoTitle).to({x:-this.game.width/2},a,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoTitle2).to({x:3*this.game.width/2},a,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoText).to({x:-this.game.width/2},a,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoText2).to({x:3*this.game.width/2},a,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.visible=!1,this.textGroup.visible=!1,this.dimLeft.kill(),this.dimRight.kill(),this.infoTitle.kill(),this.infoTitle2.kill(),this.infoText.kill(),this.infoText2.kill()},this),this.infoAction.kill(),this.infoSprite.kill(),this.hideCallback&&this.hideCallback.call(this.hideState),this.game.physics&&this.game.physics.arcade},PopupGroup.prototype.getCenterX=function(a){return this.x+a.dx*this.size.width*this.scale.x},PopupGroup.prototype.getCenterY=function(a){return this.y+a.dy*this.size.height*this.scale.y},TutorialGroup=function(a,b){this.size=b,Phaser.Group.call(this,a),this.textGroup=this.game.add.group(),this.visible=!1,this.textGroup.visible=!1},TutorialGroup.prototype=Object.create(Phaser.Group.prototype),TutorialGroup.prototype.constructor=TutorialGroup,TutorialGroup.prototype.addText=function(a,b,c,d,e){return addText.call(this,a,b,c,d,e)},TutorialGroup.prototype.addSpriteFromFile=function(a,b,c){return addSpriteFromFile.call(this,a,b,c)},TutorialGroup.prototype.addSprite=function(a,b,c){return addSprite.call(this,a,b,c,"atlas")},TutorialGroup.prototype.resize=function(a,b,c,d,e){this.width=d,this.height=e,this.scale.set(a),this.dim&&(this.dim.width=d,this.dim.height=e/4),this.targetSprite&&this.handPosition(),this.handText&&(this.handText.fontSize=28*this.scale.x,this.handText.wordWrapWidth=720*this.scale.x)},TutorialGroup.prototype.enable=function(a){this.dim||(this.dim=makeSprite(this.game,"popup-dim.png"),this.game.world.add(this.dim),this.dim.alpha=.75,this.dim.kill());this.hand=this.addSprite("popup-hand.png",0,0);var b={fill:"#ffffff",align:"center",font:dataStorage.fontContent},c=this.handText=this.game.add.text(0,0,"",b);c.anchor.set(.5),c.y=this.handText.height/2,c.wordWrap=!0,this.textGroup.add(c)},TutorialGroup.prototype.handPosition=function(){this.game.world.bringToTop(this),this.handText.x=this.game.width/2,this.handText.y=this.handText.height/2,this.handText.fontSize=28*this.scale.x,this.handText.wordWrapWidth=720*this.scale.x;var a=this.targetSprite,b=this.targetGroup;this.hand.x=b.getCenterX(a)-this.hand.width/2*this.scale.x,this.hand.y=b.getCenterY(a),this.hand.x/=this.scale.x,this.hand.y/=this.scale.y},TutorialGroup.prototype.pointHand=function(a,b,c){this.visible=!0,this.hand.revive(),this.targetSprite=a,this.targetGroup=b,this.handPosition(),this.game.time.events.add(c,function(){this.hide()},this)},TutorialGroup.prototype.showHand=function(a,b,c){this.visible=!0,this.textGroup.visible=!0,this.step=1,this.dim.revive(),this.hand.revive(),this.targetSprite=b,this.targetGroup=c,this.handPosition(),this.handText.text=a,this.handText.wordWrapWidth=720*this.scale.x,this.handText.y=this.handText.height/2,this.game.world.bringToTop(this.textGroup),this.handText.bringToTop(),this.game.physics&&this.game.physics.arcade&&(this.game.physics.arcade.isPaused=!0)},TutorialGroup.prototype.hideHand=function(){this.hideTimeout&&this.game.time.events.remove(this.hideTimeout),this.visible=!1,this.textGroup.visible=!1,this.dim.kill(),this.game.physics&&this.game.physics.arcade&&(this.game.physics.arcade.isPaused=!1)},TutorialGroup.prototype.hide=function(){this.hideHand()},TutorialGroup.prototype.nextStep=function(a,b,c){if(this.step++,this.handText.text=a,void 0!==b){var d,e;d=c.getCenterX(b)-this.hand.width/2*this.scale.x,e=c.getCenterY(b),d/=this.scale.x,e/=this.scale.y,this.targetSprite=b,this.targetGroup=c,this.game.add.tween(this.hand).to({x:d,y:e},750,Phaser.Easing.Back.InOut,!0).onComplete.add(function(){},this)}},TutorialGroup.prototype.handTarget=function(){return this.targetSprite},AdGroup=function(a,b,c,d){Phaser.Group.call(this,a),this.landSize=b,this.portSize=c,this.main=d,this.size=a.width>a.height?this.landSize:this.portSize,this.textGroup=this.game.add.group(),this.spriteAtlas="atlas"},AdGroup.prototype=Object.create(Phaser.Group.prototype),AdGroup.prototype.constructor=AdGroup,AdGroup.prototype.addText=function(a,b,c,d,e){return addText.call(this,a,b,c,d,e)},AdGroup.prototype.addSpriteFromFile=function(a,b,c){return addSpriteFromFile.call(this,a,b,c)},AdGroup.prototype.addSprite=function(a,b,c){return addSprite.call(this,a,b,c,"atlas")},AdGroup.prototype.resize=function(a,b,c,d,e){a<.5&&(a=.5),this.scale.set(a),this.size===this.landSize?(this.exit.x=d/a-(this.exit.width+25)*a,this.exit.y=e/2/a):(this.exit.x=d/2/a,this.exit.y=e/a-this.exit.height)},AdGroup.prototype.enable=function(a){this.exit=this.addSprite(a,0,0),this.exit.inputEnabled=!0,this.exit.input.useHandCursor=!0},BgGroup=function(a){Phaser.Group.call(this,a),this.textGroup=this.game.add.group(),this.spriteAtlas="atlas",this.size={width:a.width,height:a.height}},BgGroup.prototype=Object.create(Phaser.Group.prototype),BgGroup.prototype.constructor=BgGroup,BgGroup.prototype.addText=function(a,b,c,d,e,f){return addText.call(this,a,b,c,d,e,f)},BgGroup.prototype.addSpriteFromFile=function(a,b,c){return addSpriteFromFile.call(this,a,b,c)},BgGroup.prototype.addSprite=function(a,b,c){return addSprite.call(this,a,b,c,this.spriteAtlas)},BgGroup.prototype.setTexture=function(a,b){dataStorage.debug?a.loadTexture(b):a.frameName=b},BgGroup.prototype.resize=function(a,b,c,d,e){this.scale.set(a),this.size.width=d,this.size.height=e;var f=d,g=e;this.children.forEach(function(b){"cache/atlas/bg-top.png"===b.frameName?(b.x=d/2/a,b.y=b.height/2,b.width=Math.floor(d/a),this.topY=b.height):"cache/atlas/bg-top-below.png"===b.frameName?(b.x=d/2/a,b.y=this.topY+b.height/2):"cache/atlas/bg-grass.png"===b.frameName?(b.x=d/2/a,b.y=g*a-b.height,b.width=Math.floor(d/a),this.bottomY=b.height):"cache/atlas/bg-bottom-above.png"===b.frameName?(b.x=d/2/a,b.y=g/a-this.bottomY-b.height/2):(1===b.dx?b.x=f*b.dx/a-b.width/2:b.x=f/2/a,1!==b.dy?b.y=g*b.dy/a:b.y=g/a-b.height/2)},this)},BoardGroup=function(a,b,c,d){Phaser.Group.call(this,a),this.landSize=b,this.portSize=c,this.size=a.width>a.height?this.landSize:this.portSize,this.textGroup=this.game.add.group(),this.spriteAtlas="atlas",d&&(this.scrollX=!0),this.platformGroup=this.game.add.group(),this.foeGroup=this.game.add.group()},BoardGroup.prototype=Object.create(Phaser.Group.prototype),BoardGroup.prototype.constructor=BoardGroup,BoardGroup.prototype.addText=function(a,b,c,d,e,f){return addText.call(this,a,b,c,d,e,f)},BoardGroup.prototype.addSpriteFromFile=function(a,b,c){return addSpriteFromFile.call(this,a,b,c)},BoardGroup.prototype.addSprite=function(a,b,c,d){var e=this;return d&&(e=this.textGroup),addSprite.call(this,a,b,c,this.spriteAtlas,e)},BoardGroup.prototype.addSpriteNextTo=function(a,b){var c=this,d=addSprite.call(this,a,0,0,this.spriteAtlas,c);return d.x=b.x+b.width,d.y=b.y,d},BoardGroup.prototype.addFoe=function(a,b,c){return addSprite.call(this,a,b,c,this.spriteAtlas,this.foeGroup)},BoardGroup.prototype.addPlatform=function(a,b,c){return addSprite.call(this,a,b,c,this.spriteAtlas,this.platformGroup)},BoardGroup.prototype.addBitmap=function(a,b,c){var d;return d=this.create(0,0,a),void 0===b&&(d.kill(),b=c=0),d.anchor.set(.5),d.dx=.5+b,d.dy=.5+c,d.x=d.dx*this.size.width,d.y=d.dy*this.size.height,d},BoardGroup.prototype.setTexture=function(a,b){dataStorage.debug?a.loadTexture(b):a.frameName=b},BoardGroup.prototype.resize=function(a,b,c,d,e){this.scale.set(a),this.foeGroup.scale.set(a),this.platformGroup.scale.set(a),this.offsetX=b,this.offsetY=c;var f=this.size.width,g=this.size.height;if(this.textGroup.x=this.x=this.foeGroup.x=this.platformGroup.x=(d-f*a)/2+b,this.textGroup.y=this.y=this.foeGroup.y=this.platformGroup.y=(e-g*a)/2+c,this.children.forEach(function(a){a.x=a.dx*f,a.y=a.dy*g},this),this.foeGroup.children.forEach(function(a){a.x=a.dx*f,a.y=a.dy*g},this),this.textGroup.forEach(function(b){var c=a;b.x=b.dx*f*c,b.y=b.dy*g*c,b.fontSize=Math.floor(b.size*c)+"px"},this),this.scrollX){var h=this.scrollSprites=[],i=this.game.width/a;i+=450*playState.level.length;var j=Math.floor(i/(this.size.width/10))+1,k=0,l=1,m=this.addPlatform("play-block-"+l+".png",0,.2);l=1===l?5:1,this.game.physics.arcade.enable(m),m.body.immovable=!0,m.body.allowGravity=!1,m.x=-this.x/a;for(var n=m.width;k<j;k++){var o=this.addPlatform("play-block-"+l+".png",0,.2);l=1===l?5:1,o.x=m.x+n,m=o,this.game.physics.arcade.enable(m),m.body.immovable=!0,m.body.allowGravity=!1,h.push(m)}}this.worldX=this.x+this.size.width/2*a,this.worldY=this.y+this.size.height/2*a},BoardGroup.prototype.getCenterX=function(a){return this.x+a.x*this.scale.x},BoardGroup.prototype.getCenterY=function(a){return this.y+a.y*this.scale.y},BoardGroup.prototype.move=function(a,b,c){a.dx=.5+b,a.dy=.5+c,a.x=a.dx*this.size.width,a.y=a.dy*this.size.height},BoardGroup.prototype.moveTo=function(a,b){a.dx=b.dx,a.dy=b.dy,a.x=a.dx*this.size.width,a.y=a.dy*this.size.height},BoardGroup.prototype.xy=function(a,b){return{x:a*this.size.width,y:b*this.size.height}},ControlGroup=function(a,b,c,d){Phaser.Group.call(this,a),this.landSize=b,this.portSize=c,this.smallScreen=d,this.size=a.width>a.height?this.landSize:this.portSize,this.textGroup=this.game.add.group(),this.spriteAtlas="atlas"},ControlGroup.prototype=Object.create(Phaser.Group.prototype),ControlGroup.prototype.constructor=ControlGroup,ControlGroup.prototype.addText=function(a,b,c,d,e,f){return addText.call(this,a,b,c,d,e,f)},ControlGroup.prototype.addSpriteFromFile=function(a,b,c){return addSpriteFromFile.call(this,a,b,c)},ControlGroup.prototype.addSprite=function(a,b,c,d,e){var f=addSprite.call(this,a,b,c,this.spriteAtlas);return f.portx=d,f.porty=e,f},ControlGroup.prototype.setTexture=function(a,b){dataStorage.debug?a.loadTexture(b):a.frameName=b},ControlGroup.prototype.resize=function(a,b,c,d,e){if(this.scale.set(a),this.size===this.landSize){this.exit&&this.exit.kill();var f=this.size.width,g=e;this.children.forEach(function(a){a.x=a.dx*f,a.y=a.dy*g},this)}else{this.exit&&this.exit.revive();var f=d,g=this.size.height;this.children.forEach(function(a){a.x=a.portx*f,a.y=a.porty*g},this)}this.textGroup.x=this.x=(d-f*a)/2+b,this.textGroup.y=this.y=(e-g*a)/2+c,this.textGroup.forEach(function(b){b.x=b.dx*f*a,b.y=b.dy*g*a,b.fontSize=Math.floor(b.size*a)+"px"},this)},ControlGroup.prototype.move=function(a,b,c){a.dx=.5+b,a.dy=.5+c,a.x=a.dx*this.size.width,a.y=a.dy*this.size.height},ControlGroup.prototype.getCenterX=function(a){return this.x+a.x*this.scale.x},ControlGroup.prototype.getCenterY=function(a){return this.y+a.y*this.scale.y},HeaderGroup=function(a,b,c,d){Phaser.Group.call(this,a),this.landSize=b,this.portSize=c,this.state=d,this.size=a.width>a.height?this.landSize:this.portSize,this.textGroup=this.game.add.group(),this.fixedToCamera=!0,this.textGroup.fixedToCamera=!0},HeaderGroup.prototype=Object.create(Phaser.Group.prototype),HeaderGroup.prototype.constructor=HeaderGroup,HeaderGroup.prototype.addText=function(a,b,c,d,e){return addText.call(this,a,b,c,d,e)},HeaderGroup.prototype.addSprite=function(a,b,c){return addSprite.call(this,a,b,c,"atlas")},HeaderGroup.prototype.setTexture=function(a,b){dataStorage.debug?a.loadTexture(b):a.frameName=b},HeaderGroup.prototype.resize=function(a,b,c,d,e){a<.5&&(a=.5),this.scale.set(a);var f,g,h=10*a;if(this.option&&(f=this.option.width,g=this.option.height,this.size===this.landSize?(this.optionBg.x=this.option.x=f/2+h,this.optionBg.y=this.option.y=e/a-g/2-h,this.optionSound.x=120,this.optionSound.y=-100,this.optionFullscreen.x=50,this.optionFullscreen.y=-150,this.optionReset.x=170,this.optionReset.y=-0,playService.resize(h,h,a),this.info&&(this.info.x=this.option.x,this.info.y=this.option.y-g-2*h)):(this.optionBg.x=this.option.x=d/a-f/2-h,this.optionBg.y=this.option.y=g/2+h,this.optionSound.x=-120,this.optionSound.y=100,this.optionFullscreen.x=-155,this.optionFullscreen.y=25,this.optionReset.x=0,this.optionReset.y=165,playService.resize(h,h,a),this.info&&(this.info.x=this.option.x-f-2*h,this.info.y=this.option.y))),this.exit&&(this.size===this.landSize?(this.exit.revive(),f=this.exit.width,g=this.exit.height,this.exit.x=f/2+h,this.exit.y=g/2+h):(f=this.exit.width,g=this.exit.height,this.exit.x=f/2+h,this.exit.y=g/2+h)),this.score&&(f=190,g=32,this.size===this.landSize?("header-score-port.png"!==this.score.frameName&&this.setTexture(this.score,"header-score-port.png"),this.score.x=(d+128)/2/a,this.score.y=(g+h)/a,this.scoreLabel.x=0,this.scoreLabel.y=5,this.scoreTime&&(this.scoreTime.frameName!=="header-"+this.scoreType+"-land.png"&&this.setTexture(this.scoreTime,"header-"+this.scoreType+"-land.png"),this.scoreTime.x=this.score.width/2+15*a,this.scoreTime.y=e/2/a+2*g*a,this.scoreTimeLabel.x=this.scoreTime.x*a,this.scoreTimeLabel.y=(this.scoreTime.y+27)*a)):("header-score-port.png"!==this.score.frameName&&this.setTexture(this.score,"header-score-port.png"),this.score.x=(d+128)/2/a,this.score.y=(g+h)/a,this.scoreLabel.x=0,this.scoreLabel.y=5,this.scoreTime&&(this.scoreTime.frameName!=="header-"+this.scoreType+"-port.png"&&this.setTexture(this.scoreTime,"header-"+this.scoreType+"-port.png"),this.scoreTime.x=d/2/a+f*a,this.scoreTime.y=g/2+h,this.scoreTimeLabel.x=(this.scoreTime.x+25)*a,this.scoreTimeLabel.y=(this.scoreTime.y+6)*a)),this.scoreLabel.fontSize=Math.floor(38),this.scoreTimeLabel&&(this.scoreTimeLabel.fontSize=Math.floor(38*a))),this.health&&this.health.length)if(f=this.health[0].width,g=this.health[0].height/2,this.size===this.landSize)for(var i=0;i<this.health.length;i++)this.health[i].x=128/a-f+i*f*5/4,this.health[i].y=(g+h)/a;else for(var i=0;i<this.health.length;i++)this.health[i].x=128-f+i*f*5/4,this.health[i].y=(g+h)/a},HeaderGroup.prototype.enable=function(a){if("header-option.png"===a)this.optionBg=this.addSprite("header-option-bg.png",0,0),this.optionBg.kill(),this.optionSound=this.addSprite("header-option-sound.png",0,0),this.optionSound.inputEnabled=!0,this.optionSound.input.useHandCursor=!0,this.optionBg.addChild(this.optionSound),this.optionFullscreen=this.addSprite("header-option-fullscreen.png",0,0),this.optionFullscreen.inputEnabled=!0,this.optionFullscreen.input.useHandCursor=!0,this.optionFullscreen.events.onInputDown.add(this.onFullscreen,this),this.optionBg.addChild(this.optionFullscreen),this.optionReset=this.addSprite("header-option-reset.png",0,0),this.optionReset.inputEnabled=!0,this.optionReset.input.useHandCursor=!0,this.optionBg.addChild(this.optionReset),this.optionReset.kill(),this.option=this.addSprite(a,0,0),this.option.inputEnabled=!0,this.option.input.useHandCursor=!0;else if("header-health.png"===a){this.health=[];for(var b=0;b<3;b++)this.health[b]=this.addSprite("header-health.png",0,0),this.health[b].inputEnabled=!0,this.health[b].alpha=1,this.health[b].input.useHandCursor=!0}else if("header-score.png"===a||"header-time.png"===a||"header-bug.png"===a){this.scoreType="header-bug.png"===a?"bug":"header-time.png"===a?"time":"score",this.score=this.addSprite("header-"+this.scoreType+"-land.png",0,0),this.score.inputEnabled=!0,this.score.input.useHandCursor=!0;var c={fill:"#ffffff",font:dataStorage.fontHeader},d=this.scoreLabel=this.game.add.text(0,0,"",c);this.score.addChild(d),d.setShadow(3,3,"rgba(0,0,0,0.5)",5),d.anchor.set(.5,.5)}else if("header-time-score.png"===a||"header-health-score.png"===a){this.scoreType="header-time-score.png"===a?"time":"health",this.scoreTime=this.addSprite("header-"+this.scoreType+"-land.png",0,0),this.scoreTime.inputEnabled=!0,this.scoreTime.input.useHandCursor=!0;var c={fill:"#ffffff",font:dataStorage.fontHeader},d=this.scoreTimeLabel=this.game.add.text(0,0,"",c);d.anchor.set(.5,.5),this.score=this.addSprite("header-score-land.png",0,0),this.score.inputEnabled=!0,this.score.input.useHandCursor=!0;var c={fill:"#ffffff",font:dataStorage.fontHeader},d=this.scoreLabel=this.game.add.text(0,0,"",c);d.anchor.set(.5,.5)}else if("header-exit.png"===a)this.exit=this.addSprite(a,0,0),this.exit.inputEnabled=!0,this.exit.input.useHandCursor=!0;else if("header-quack.png"===a)this.exit=this.addSprite(a,0,0),this.exit.inputEnabled=!0,this.exit.input.useHandCursor=!0;else if("header-ad.png"===a);else if("header-info.png"===a){var e=this.info=this.addSprite("header-info.png",0,0);e.inputEnabled=!0,e.input.useHandCursor=!0}},HeaderGroup.prototype.onFullscreen=function(){this.game.scale.isFullScreen?(this.optionFullscreen.frame=this.optionFullscreen.spritesheetStart,this.game.scale.stopFullScreen()):(this.optionFullscreen.frame=this.optionFullscreen.spritesheetStart+1,this.game.scale.startFullScreen(!1)),this.state.popupGroup.dim.kill()},HeaderGroup.prototype.showOption=function(){this.game.world.bringToTop(this),this.scoreLabel&&this.scoreLabel.bringToTop(),this.game.scale.isFullScreen?this.setTexture(this.optionFullscreen,"header-option-fullscreen-active.png"):this.setTexture(this.optionFullscreen,"header-option-fullscreen.png"),dataStorage.isAudio?this.setTexture(this.optionSound,"header-option-sound-active.png"):this.setTexture(this.optionSound,"header-option-sound.png"),this.optionBg.scale.set(0),this.optionBg.revive(),this.game.add.tween(this.optionBg.scale).to({x:1,y:1},500,Phaser.Easing.Back.InOut,!0),this.game.physics&&this.game.physics.arcade&&(this.game.physics.arcade.isPaused=!0)},HeaderGroup.prototype.hideOption=function(){this.game.add.tween(this.optionBg.scale).to({x:0,y:0},500,Phaser.Easing.Back.InOut,!0).onComplete.addOnce(function(){this.optionBg.kill()},this),this.game.physics&&this.game.physics.arcade&&(this.game.physics.arcade.isPaused=!1)},HeaderGroup.prototype.select=function(a){a===this.optionSound&&(dataStorage.setAudio(!dataStorage.isAudio),dataStorage.isAudio?this.setTexture(this.optionSound,"header-option-sound-active.png"):this.setTexture(this.optionSound,"header-option-sound.png"))},HeaderGroup.prototype.setScore=function(a){this.scoreLabel&&(this.scoreLabel.text=a)},HeaderGroup.prototype.setTime=function(a){this.scoreTimeLabel&&(this.scoreTimeLabel.text=a)},playLogic={},playGrid={levels:[{id:0,title:"Colorful Xmas",effect:"none",health:0,image:"quack-fly-1.png",desc:"Hit to jump over the spikes.",name:"Colorful Xmas",levels:25,length:10.1,bpm:99.79,music:"POL-a-colorful-christmas-short",progress:0,blocks:[{no:2,x:4.5,y:.1},{no:2,x:8.5,y:.1},{no:2,x:12.5,y:.1},{no:3,x:14.5,y:.1}]},{id:1,title:"Christmas Spirit",effect:"none",health:0,image:"quack-fly-1.png",desc:"Hit to jump over the spikes.",name:"Christmas Spirit",levels:25,length:19.286,bpm:105.19,music:"POL-christmas-spirit-short",progress:0,blocks:[{no:3,x:2.5,y:.1},{no:2,x:4.5,y:.1},{no:3,x:6.5,y:.1},{no:2,x:8.5,y:.1},{no:3,x:10.5,y:.1},{no:2,x:12.5,y:.1},{no:3,x:14.5,y:.1},{no:2,x:16.5,y:.1},{no:3,x:18.5,y:.1},{no:2,x:20.5,y:.1},{no:3,x:21.5,y:.1},{no:3,x:22.5,y:.1},{no:3,x:23.5,y:.1},{no:2,x:24.5,y:.1},{no:3,x:26.5,y:.1},{no:2,x:28.5,y:.1},{no:3,x:30.5,y:.1}]},{id:2,title:"Joy to the World",effect:"none",health:0,image:"quack-fly-1.png",desc:"Hit to jump in Clave.",name:"Joy to the World",levels:25,length:17.941,bpm:85,music:"POL-joy-to-the-world-short",progress:0,blocks:[{no:3,x:1.5,y:.1},{no:3,x:2.5,y:.1},{no:2,x:4.5,y:.1},{no:3,x:5.5,y:.1},{no:3,x:6.5,y:.1},{no:3,x:7.5,y:.1},{no:2,x:8.5,y:.1},{no:3,x:9.5,y:.1},{no:3,x:10.5,y:.1},{no:2,x:12.5,y:.1},{no:3,x:13.5,y:.1},{no:3,x:14.5,y:.1},{no:2,x:16.5,y:.1},{no:3,x:17.5,y:.1},{no:3,x:18.5,y:.1},{no:3,x:19.5,y:.1},{no:2,x:20.5,y:.1},{no:3,x:22.5,y:.1},{no:3,x:23.5,y:.1}]}]};var playState={spriteAtlas:"atlas",level:0,feedbackNo:0,feedback:["Superb!","Perfect!","Excellent!","Brilliant!","Amazing!","Wonderful!","Fantastic!","Outstanding!"],upgrade:!1,swapLandscapeToPortrait:!1,hasArcadePhysics:!0,hasMusicLoop:!0,hasButton:!0,scoreTip:"How many meters to run.",timeTip:"Time to run this level.",arcadeSpeed:450,bpm:0,resize:function(){var a=this.game.width>this.game.height?1:2;this.orientation!==a&&(this.backToMenu(),this.orientation=3);var b=onResize.call(this,this.scale,{width:this.game.width,height:this.game.height});if(this.resizeSprites(b),this.helpText&&(this.helpText.fontSize=b*this.helpTextSize),this.worldBounds){var c=this.player,d=this.boardGroup.x+c.width*b/2,e=this.boardGroup.y+c.height*b/2,f=this.boardGroup.size.width*b-c.width*b,g=this.boardGroup.size.height*b-c.height*b;1===a?this.game.physics.arcade.setBounds(d,e,f,g):this.game.physics.arcade.setBounds(d,e,g,f)}this.renderBg(b)},resizeSprites:function(a){if(this.player){var b=this.player.sprite,c=b.width*a/2,d=b.height*a,e=(b.width-c)/2,f=(b.height-d)/2;b.body.setSize(c,d,e,f)}this.boardGroup.foeGroup.children.forEach(function(a){if(a.body){var b=a.width*this.boardGroup.scale.x/2,c=a.height*this.boardGroup.scale.y/2,d=(a.width-b)/2,e=(a.height-c)/2;a.body.setSize(b,c,d,e)}},this),this.boardGroup.platformGroup.children.forEach(function(a){if(a.body){var b=a.width*this.boardGroup.scale.x/2,c=a.height*this.boardGroup.scale.y,d=(a.width-b)/2,e=(a.height-c)/2;a.body.setSize(b,c,d,e)}},this)},init:function(){this.tutorial=mainState.score>0?0:1,this.orientation=this.game.width>this.game.height?1:2,this.level=playGrid.levels[mainState.level],this.bpm=this.level.bpm,this.playerLives=3,this.bestScore=0},preload:function(){if(dataStorage.debug&&this.spriteAtlas)for(var a=this.game.cache.getFrameData(this.spriteAtlas).getFrames(),b=0;b<a.length;b++){var c=a[b].name;this.cache.checkImageKey(c)||this.load.image(c,"cache/"+this.spriteAtlas+"/"+c)}this.load.audio(this.level.music,["cache/"+this.level.music])},create:function(){this.cache.checkSoundKey("sound-effects")?(this.soundEffects=this.add.audioSprite("sound-effects"),Object.keys&&Object.keys(this.soundEffects.sounds).forEach(function(a,b){this.soundEffects.sounds[a].allowMultiple=!0},this)):dataStorage.isAudio=!1,this.hasButton&&(this.game.input.onDown.add(function(){isDown=!0}),this.game.input.onUp.add(function(){isDown=!1}),this.game.input.keyboard.onDownCallback=function(a){isDown=!0},this.game.input.keyboard.onUpCallback=function(a){isDown=!1}),this.hasArcadePhysics&&(this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.physics.arcade.isPaused=!0),this.createBoard(),this.createHeader(),this.createTutorial(),this.createPopup(),this.world.mask&&this.world.mask.destroy(),this.world.mask=null,this.helpTextSize=64;var a={font:this.helpTextSize+"px",fill:"#0000ff",wordWrap:!1,fontWeight:"bold",align:"center",backgroundColor:"rgba(255,255,255,0.5)"};this.helpText=this.add.text(0,0,"",a),this.helpText.setShadow(1,1,"rgba(0,0,0,1)",1),this.helpText.anchor.set(.5),this.helpText.kill(),this.hasArcadePhysics&&(this.countSprite=this.boardGroup.addSprite("number-3.png",0,-.2).kill(),this.startedCoundDown=!1,this.start()),this.effectGroup=new EffectGroup(this.game,{width:720,height:720},{width:720,height:720}),this.effectGroup.enable("explosion"),this.game.scale.setResizeCallback(this.onResize,this),this.player=player,this.player.init(this),this.resize(),this.tutorial?this.showTutorial():this.popupGroup.showInfo(this.level.title,this.level.desc,"HIT TO START",0,this,this.startCountdown,!1,this.level.image),this.inputLockTime=this.time.time+500},start:function(){this.hasButton&&(this.spaceKey=this.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.input.keyboard.addKeyCapture([Phaser.Keyboard.SPACEBAR])),this.isGameOver=!1,this.playerAlive=!1,this.stage.backgroundColor="#00001b",this.hasArcadePhysics&&(this.countdown=0),this.game.onPause.add(this.onPaused,this),this.game.onResume.add(this.onResumed,this)},onPaused:function(){this.orientation=4,this.backToMenu()},onResumed:function(){},stopCountdown:function(){if(this.countdown){if(1===--this.countdown)return;switch(this.countSprite.alpha=1,this.countdown){case 4:this.countSprite.revive(),this.boardGroup.setTexture(this.countSprite,"number-3.png");break;case 3:this.boardGroup.setTexture(this.countSprite,"number-2.png");break;case 2:this.boardGroup.setTexture(this.countSprite,"number-1.png")}this.add.tween(this.countSprite).to({alpha:0},500,Phaser.Easing.Linear.None,!0)}else this.countdown=5,dataStorage.isAudio&&this.soundEffects.play("countdown");this.countdown>1&&this.time.events.add(750,function(){this.stopCountdown()},this)},startCountdown:function(){if(this.countdown){switch(this.countdown--,this.countSprite.alpha=1,this.countdown){case 4:this.countSprite.revive(),this.boardGroup.setTexture(this.countSprite,"number-3.png");break;case 3:this.boardGroup.setTexture(this.countSprite,"number-2.png");break;case 2:this.boardGroup.setTexture(this.countSprite,"number-1.png");break;case 1:return dataStorage.isAudio&&(this.music=this.game.add.audio(this.level.music),this.hasMusicLoop?this.music.loopFull(.25):this.music.play()),void(this.hasArcadePhysics&&(this.player.start(0),this.playerAlive=!0,this.gameOver=!1,this.hasArcadePhysics&&(this.game.physics.arcade.isPaused=!1),this.startTime=this.time.time))}this.add.tween(this.countSprite).to({alpha:0},500,Phaser.Easing.Linear.None,!0)}else this.countdown=5,this.player.enter();this.time.events.add(500,function(){this.startCountdown()},this)},resume:function(){this.popupGroup.pausedTime&&(this.pausedTime=this.time.time-this.popupGroup.pausedTime,this.startTime+=this.pausedTime),this.hasArcadePhysics&&(this.game.physics.arcade.isPaused=!1)},createPopup:function(){this.popupGroup=new PopupGroup(this.game,{width:this.game.width,height:this.game.height}),this.popupGroup.enable("info"),this.popupGroup.enable("popup-banner.png"),this.popupGroup.enable("popup-dialog-quit.png")},createTutorial:function(){this.tutorialGroup=new TutorialGroup(this.game,{width:this.game.width,height:this.game.height}),this.tutorialGroup.enable("popup-hand.png")},checkVictory:function(){var a=this.level.length*this.arcadeSpeed,b=100-Math.floor(100*(a-this.player.sprite.x)/a);return b>100&&(b=100),b>this.bestScore&&(this.bestScore=b),this.headerGroup.setScore(b),this.player.sprite.x>=a},update:function(){if(!this.game.physics.arcade.isPaused&&this.checkVictory())return this.game.physics.arcade.isPaused=!0,this.inputLockTime=this.time.time+1e3,void this.time.events.add(150,function(){this.gameWin()},this);if(this.player&&this.player.update(),this.hasArcadePhysics&&!this.game.physics.arcade.isPaused&&this.playerAlive){if(this.game.physics.arcade.overlap(player.sprite,this.boardGroup.foeGroup,this.overlap,null,this))return;this.game.physics.arcade.collide(player.sprite,this.boardGroup.platformGroup,this.collide,null,this)}if(!(this.inputLockTime>=this.time.time||this.world.mask)&&(this.hasButton&&(playState.game.physics.arcade.isPaused||this.game.input.activePointer.isDown&&this.game.input.activePointer.withinGame&&player.fly()),this.game.input.activePointer.isDown&&this.game.input.activePointer.withinGame)){var a=this.game.input.activePointer;if(a.targetObject){var b=a.targetObject.sprite
;this.popupGroup.visible?b===this.popupGroup.quit?(this.inputLockTime=this.time.time+1e3,this.backToMenu()):b!==this.popupGroup.dialogBg&&(this.inputLockTime=this.time.time+1e3,this.popupGroup.hide()):b===this.headerGroup.exit?(this.inputLockTime=this.time.time+750,this.popupGroup.showDialog("Are you sure to quit this game?",null,this,!0,!0)):b===this.headerGroup.score?(this.inputLockTime=this.time.time+750,this.popupGroup.showBanner(this.scoreTip)):b===this.headerGroup.scoreTime&&(this.inputLockTime=this.time.time+750,this.popupGroup.showBanner(this.timeTip))}else this.tutorialGroup.visible&&this.showTutorial(),this.popupGroup.visible&&(this.inputLockTime=this.time.time+750,this.popupGroup.hide())}},backToMenu:function(){this.texture=this.textureSprite=this.textureBg=this.textureBgSprite=null,this.boardTexture=null;for(var a in PIXI.BaseTextureCache)delete PIXI.BaseTextureCache[a];for(var a in PIXI.TextureCache)delete PIXI.TextureCache[a];this.time.events.add(.1*Phaser.Timer.SECOND,function(){mainState.stage.backgroundColor="#000000",this.state.start("mainState")},this)},popupHidden:function(){this.isGameOver?this.time.events.add(750,function(){this.backToMenu()},this):(this.popupGroup.pausedTime&&(this.pausedTime=this.time.time-this.popupGroup.pausedTime,this.startTime+=this.pausedTime),this.game.physics.arcade.isPaused=!1)},createHeader:function(){this.headerGroup=new HeaderGroup(this.game,{width:175,height:0},{width:0,height:75},this),this.headerGroup.enable("header-score.png"),this.headerGroup.enable("header-health.png"),this.headerGroup.setScore("")},createBoard:function(){this.boardGroup=new BoardGroup(this.game,{width:720,height:720},{width:720,height:720},1),this.level.blocks.forEach(function(a){var b,c;!this.swapLandscapeToPortrait||this.game.width>=this.game.height?(b=a.x,c=a.y):(b=a.y,c=a.x),b=this.arcadeSpeed*(60/this.bpm)/this.boardGroup.size.width*b;var d;2===a.no?(c+=.01,d=this.boardGroup.addPlatform("play-block-"+a.no+".png",b,c)):3===a.no&&(c+=.01,d=this.boardGroup.addFoe("play-block-"+a.no+".png",b,c)),this.game.physics.enable(d,Phaser.Physics.ARCADE),d.body.immovable=!0,d.body.moves=!1,d.isBlock=!0,d.type=a.no},this);var a=this.level.length*this.arcadeSpeed,b=a/this.boardGroup.size.width;this.goalFlag=this.boardGroup.addSprite("play-goal-1.png",b-.5,.1),this.goalFlag.animations.add("goal-flag",["play-goal-1.png","play-goal-3.png","play-goal-2.png","play-goal-3.png"]),this.goalFlag.animations.play("goal-flag",10,!0)},shutdown:function(){this.bg=this.boardBg=null,this.music&&this.music.stop()},gameLose:function(a){this.gameOver||(this.gameOver=!0,--this.playerLives>0?(this.showText(null,a),this.music&&(this.music.stop(),this.music=null),dataStorage.isAudio&&this.soundEffects.play("end",.33),this.inputLockTime=this.time.time+500,this.oneMoreTime()):(this.inputLockTime=this.time.time+1500,this.isGameOver=!0,this.endGame(a)))},gameWin:function(){if(!this.gameOver){this.gameOver=!0;var a=playService.getPlayer("me");playService.setScore(a.wins+1);var b;if(0===mainState.score)b=this.level.desc;else{++this.feedbackNo>=this.feedback.length-1&&(this.feedbackNo=0);var b=this.feedback[this.feedbackNo]}this.endGame(b),this.inputLockTime=this.time.time+1500}},endGame:function(a){this.music&&(this.music.stop(),this.music=null),dataStorage.isAudio&&this.soundEffects.play("end",.33),this.inputLockTime=this.time.time+1500,this.game.camera.reset(),this.bestScore>=100||(a=this.bestScore>=this.level.progress?this.bestScore===this.level.progress?"Your score "+this.bestScore+" %!":"Your new highscore "+this.bestScore+" %!":"Your score "+this.bestScore+" %!"),this.bestScore>this.level.progress&&(this.level.progress=this.bestScore,dataStorage.setProgress(this.level.id,this.level.progress)),this.popupGroup.showInfo(this.level.title,a,"HIT TO CONTINUE",0,this,this.backToMenu,!0,"quack-dance-1.png")},showText:function(a,b){this.helpText.text=b,this.helpText.x=this.game.width/2,this.helpText.y=this.game.height/4,this.helpText.alpha=1,this.helpText.bringToTop(),this.helpText.revive(),this.add.tween(this.helpText).to({alpha:0},1500,Phaser.Easing.Quadratic.InOut,!0,0).onComplete.add(function(){this.helpText.kill()},this),this.countdown=0},showTutorial:function(){return this.game.physics.arcade.isPaused=!1,this.music=this.game.add.audio(this.level.music),void(this.hasMusicLoop?this.music.loopFull(.25):this.music.play())},startup:function(){this.startTime=this.time.time,this.resume()},overlap:function(a){this.inputLockTime=this.time.time+1e3,this.game.physics.arcade.isPaused=!0,this.playerAlive=!1,a.animations.play("player-die",30,!1),a.animations.currentAnim.onComplete.add(function(){this.time.events.add(250,function(){this.gameLose("Don't run to\nICE SPIKES!")},this)},this)},collide:function(a){a.body&&a.body.touching.right&&(this.playerAlive=!1,this.music&&this.music.stop(),this.inputLockTime=this.time.time+1e3,this.game.physics.arcade.isPaused=!0,a.loadTexture("atlas","quack-freeze-1.png"),this.time.events.add(250,function(){this.gameLose("Don't run to\nICE BLOCKS!")},this))},oneMoreTime:function(){this.headerGroup.health[this.playerLives].alpha=.25,this.boardGroup.move(this.player.sprite,0,0),this.countdown=0,this.startCountdown()},renderBg:function(a){var b=this.game.width;this.game.height;this.bgGroup&&this.bgGroup.destroy(),this.backgroundGroup=this.game.add.group(),this.backgroundGroup.fixedToCamera=!0;var c=this.boardGroup.y+.7*this.boardGroup.size.height*a,d=this.game.add.bitmapData(b,c);d.smoothed=!1,d.clear();var e=d.ctx.createLinearGradient(0,0,0,d.height);e.addColorStop(0,"#dcf8ff"),e.addColorStop(.85,"#8fbce5"),e.addColorStop(1,"#39519e"),d.ctx.fillStyle=e,d.ctx.fillRect(0,0,b,d.height);var f=this.game.add.sprite(0,0,d);this.backgroundGroup.add(f),this.game.world.sendToBack(this.backgroundGroup)}},mainState={name:"mainState",spriteAtlas:"atlas",goal:"Music by PlayOnLoop.com\n\nSounds by InspectorJ of Freesound.org\n\n",chapters:[{name:"Latin Clave",levels:3}],score:0,scoreMax:25,resize:function(){var a=onResize.call(this,this.scale,{width:this.game.width,height:this.game.height});this.effectGroup&&this.effectGroup.snowing&&(this.effectGroup.snowing.x=this.game.width/2,this.effectGroup.snowing.y=-this.game.height,this.effectGroup.snowing.width=this.game.width,this.effectGroup.snowing.height=2*this.game.height),this.helpText&&(this.helpText.fontSize=64*a)},init:function(){for(var a=0,b=0;a<this.chapters.length;a++)if(b+=this.chapters[a].levels,this.score<b){this.chapterNo=a,this.chapterLevel=this.score-b-this.chapters[a].levels;break}var c=playService.getPlayer("me");this.score=c.wins,this.chapter=this.chapters[0],this.level=0,this.score>2&&(this.score=2),0===this.score&&this.state.add("playState",playState,!0)},preload:function(){if(dataStorage.debug&&this.spriteAtlas)for(var a=this.game.cache.getFrameData(this.spriteAtlas).getFrames(),b=0;b<a.length;b++){var c=a[b].name;this.cache.checkImageKey(c)||this.game.load.image(c,"cache/"+this.spriteAtlas+"/"+c)}},create:function(){this.cache.checkSoundKey("sound-effects")?(this.soundEffects=this.add.audioSprite("sound-effects"),Object.keys&&Object.keys(this.soundEffects.sounds).forEach(function(a,b){this.soundEffects.sounds[a].allowMultiple=!0},this)):dataStorage.isAudio=!1,this.controlGroup=new ControlGroup(this.game,{width:260,height:0},{width:0,height:280}),this.createBoard(),this.createHeader(),this.createPopup(),this.adGroup=new AdGroup(this.game,{width:0,height:0},{width:0,height:0}),this.adGroup.enable("main-more-games.png");var a={font:"128px",fill:"#000000",wordWrap:!1,fontWeight:"bold",align:"center",backgroundColor:"#ffff00"};this.helpText=this.add.text(0,0,"",a),this.helpText.anchor.set(.5),this.helpText.kill(),this.game.scale.setResizeCallback(this.onResize,this),this.resize(),this.start(),dataStorage.isAudio&&this.time.events.add(100,function(){var a="POL-christmas-together-short";this.load.audio("main-music",["cache/"+a+".ogg","cache/"+a+".mp3"]);for(var b=0;b<=2;b++){var c=playGrid.levels[b];this.load.audio(c.music,["cache/"+c.music+".ogg","cache/"+c.music+".mp3"])}this.load.start(),this.load.onLoadComplete.addOnce(this.loadComplete,this)},this)},createHeader:function(){this.headerGroup=new HeaderGroup(this.game,{width:260,height:0},{width:0,height:90},this),this.headerGroup.enable("header-option.png"),this.headerGroup.enable("header-ad.png"),this.headerGroup.enable("header-info.png")},createPopup:function(){this.popupGroup=new PopupGroup(this.game,{width:this.game.width,height:this.game.height}),this.popupGroup.enable("popup-banner.png"),this.popupGroup.enable("popup-dialog.png")},createBoard:function(){this.boardGroup=new BoardGroup(this.game,{width:720,height:720},{width:720,height:720}),this.boardGroup.addSprite("main-board-bg.png",0,-.1);var a;this.score<this.scoreMax||(a="Congratulations!"),this.chapterLabels=[],this.chapterProgress=[],this.chapterButtons=[];for(var b=0;b<this.chapter.levels;b++){var c=playGrid.levels[b];a=c.name;var d=c.progress;this.chapterButtons[b]=this.boardGroup.addSprite("main-board-chapter-button.png",0,.19*b-.27),this.chapterButtons[b].inputEnabled=!0,this.chapterButtons[b].input.useHandCursor=!0,this.chapterLabels[b]=this.boardGroup.addText(a,-.1,.19*b-.27,"333333",48),this.chapterProgress[b]=this.boardGroup.addText(d+" %",.27,.19*b-.27,"333333",42)}},update:function(){if(!(this.inputLockTime>=this.time.now||this.world.mask))if(playState.upgrade){if(this.game.input.activePointer.isDown&&this.game.input.activePointer.withinGame){var a=this.game.input.activePointer;if(a.targetObject){var b=null,c=a.targetObject.sprite;if(c===this.popupGroup.upgradeSpeed?(b="Speed",upgradeSpeed++):c===this.popupGroup.upgradeLives?(b="Bite",upgradeLives++):c===this.popupGroup.upgradeAgility?(b="Wiggle",upgradeAgility++):c===this.popupGroup.upgradeTurning?(b="Agility",upgradeTurning++):b=!1,b){this.showText(null,"Snake\n"+b+"\nUpgraded!"),this.inputLockTime=this.time.now+500,playState.upgrade=!1;var d=[upgradeSpeed,upgradeLives,upgradeAgility,upgradeTurning];dataStorage.saveUpgrades(d),this.popupGroup.hide()}}}}else if(this.game.input.activePointer.isDown&&this.game.input.activePointer.withinGame){var e,a=this.game.input.activePointer;if(a.targetObject){var c=a.targetObject.sprite;if(this.popupGroup.visible)c===this.popupGroup.close||c===this.popupGroup.claim||3===playState.orientation||4===playState.orientation?(playState.orientation=0,this.inputLockTime=this.time.now+1e3,this.popupGroup.hide()):c===this.popupGroup.play&&(this.inputLockTime=this.time.now+1e3,this.popupHidden());else if(this.headerGroup.optionBg.visible)this.inputLockTime=this.time.now+250,c===this.headerGroup.optionSound?(this.headerGroup.select(this.headerGroup.optionSound),dataStorage.isAudio?this.soundEffects.play("collide"):this.music&&this.music.stop()):c===this.headerGroup.optionReset?(dataStorage.reset(),this.headerGroup.hideOption(),this.popupGroup.dim.kill()):(this.headerGroup.hideOption(),this.popupGroup.dim.kill());else{if(c===this.adGroup.exit)return this.inputLockTime=this.time.now+750,void(window.location.href=dataStorage.URL);if(c===this.headerGroup.option)return this.inputLockTime=this.time.now+500,this.headerGroup.showOption(this),void this.popupGroup.dim.revive();if(c===this.headerGroup.info)return this.inputLockTime=this.time.now+500,void this.popupGroup.showDialog(this.goal,null,this,!0);if(c===this.play)e=fadeOutEffect(this,0),e.onComplete.addOnce(function(){this.state.add("playState",playState,!0)},this);else for(var f=0;f<this.chapterButtons.length;f++)if(c===this.chapterButtons[f]){this.level=0+f,e=fadeOutEffect(this,0),e.onComplete.addOnce(function(){this.state.add("playState",playState,!0)},this);break}}}else this.headerGroup.optionBg.visible?(this.headerGroup.hideOption(),this.popupGroup.dim.kill()):this.popupGroup.visible&&(this.inputLockTime=this.time.now+1e3,this.popupGroup.hide())}},start:function(){if(this.game.physics&&(this.game.physics.arcade.isPaused=!1),this.world.mask&&this.world.mask.destroy(),this.effectGroup=new EffectGroup(this.game,{width:720,height:720},{width:720,height:720}),this.effectGroup.enable("snowing"),this.time.events.add(0,function(){this.effectGroup.start(this.game.width/2,-this.game.height,this.game.width,2*this.game.height)},this),this.world.mask=null,16251901===this.stage.backgroundColor)playService.mainStarted=!0,playService.showLogin(),this.started=!0;else{fadeOutEffect(this,16251901,!0).onComplete.addOnce(function(){playService.mainStarted=!0,playService.showLogin(),this.started=!0,this.world.mask.destroy(),this.world.mask=null},this)}if(this.score>=this.scoreMax)return playState.upgrade=!1,this.popupGroup.showBanner("Congratulations!\nMerry & Healthy Xmas"),void this.popupGroup.play.kill();3===playState.orientation?this.popupGroup.showBanner("Game orientation changed."):4===playState.orientation?playState.upgrade?this.showAchievement(!0):this.popupGroup.showBanner("Game resumed."):playState.upgrade&&this.showAchievement(!0)},popupHidden:function(){this.game.physics.arcade.isPaused=!1},shutdown:function(){this.bg=null,this.effectGroup=null,this.music&&this.music.stop()},loadImage:function(a){this.load.crossOrigin="Anonymous",this.load.image(a),this.load.onFileComplete.add(this.onLoadImage,this),this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.load.start()},loadComplete:function(){dataStorage.isAudio&&"mainState"===this.game.state.current&&(this.music=this.game.add.audio("main-music"),this.music.loopFull(.25))},updateScores:function(){},updateAchievements:function(){this.currentButton&&this.updateLeaderScore(this.currentButton)},iconComplete:function(a,b,c,d,e){console.log("Loading "+a+" %"),console.log(c+" "+b),c&&b&&this.boardGroup.addSpriteFromFile(b,.1,.1)},printCache:function(a){var b=this.cache.getKeys(a),c="";for(var d in b)c+=d+" ";b.length>0&&console.log(a+":"+c),this.cacheItems+=b.length},showPhaserCache:function(){this.printCache(Phaser.Cache.CANVAS),this.printCache(Phaser.Cache.IMAGE),this.printCache(Phaser.Cache.TEXTURE),this.printCache(Phaser.Cache.SOUND),this.printCache(Phaser.Cache.TEXT),this.printCache(Phaser.Cache.PHYSICS),this.printCache(Phaser.Cache.TILEMAP),this.printCache(Phaser.Cache.BINARY),this.printCache(Phaser.Cache.BITMAPDATA),this.printCache(Phaser.Cache.BITMAPFONT),this.printCache(Phaser.Cache.JSON),this.printCache(Phaser.Cache.XML)},showPixiCache:function(){var a="";for(var b in PIXI.BaseTextureCache)a+=b+" ",this.cacheItems++;for(var b in PIXI.TextureCache)a+=b+" ",this.cacheItems++;console.log("PIXI Base/TextureCache: "+a)},showCache:function(a){this.cacheItems=0,console.log(a),this.showPhaserCache(),this.showPixiCache(),console.log("world length: "+this.world.children.length),console.log("cache length: "+this.cacheItems)},showAchievement:function(a){this.popupGroup.showDialog("",null,this,!0,!1,"Upgrade Snake",a)},showText:function(a,b){this.helpText.text=b,this.helpText.x=this.game.width/2,this.helpText.y=this.game.height/2,this.helpText.alpha=1,this.helpText.bringToTop(),this.helpText.revive(),this.add.tween(this.helpText).to({alpha:0},1500,Phaser.Easing.Quadratic.InOut,!0,0).onComplete.add(function(){this.helpText.kill()},this)}},player={init:function(a){this.state=a;var b,c=this.state.game;b=c.add.sprite(100,100,"atlas","quack-run-1.png"),b.anchor.set(.5),this.state.boardGroup.add(b),this.state.boardGroup.move(b,0,0),b.animations.add("quack-run",["quack-run-1.png","quack-run-2.png","quack-run-3.png","quack-run-4.png","quack-run-5.png","quack-run-6.png"]),b.animations.add("quack-fly",["quack-fly-1.png","quack-fly-2.png","quack-fly-3.png","quack-fly-4.png"]),b.animations.add("player-die",["quack-die-1.png","quack-die-2.png","quack-die-3.png","quack-die-4.png","quack-die-5.png","quack-die-6.png"]),this.frameRate=15,this.sprite=b,c.physics.arcade.enable(b),b.body.checkCollision.up=!1,b.body.checkCollision.right=!0,b.body.checkCollision.left=!1,b.body.gravity.y=3e3;var d=c.width/this.state.boardGroup.scale.x,e=this.state.arcadeSpeed;d+=mainState.chapter.length*e,c.world.setBounds(0,0,d,c.height)},enter:function(){this.sprite.animations.play("quack-fly",this.frameRate,!0)},start:function(a){var b=this.sprite;b.body.velocity.y=0,b.body.velocity.x=this.state.arcadeSpeed,this.state.game.camera.follow(b),this.state.time.events.add(a,function(){b.animations.play("quack-run",this.frameRate,!0)},this)},fly:function(){var a=this.sprite;a.body.touching.down&&(dataStorage.isAudio&&this.state.soundEffects.play("collide"),a.body.velocity.y-=800,a.animations.play("quack-fly",this.frameRate,!0),this.state.time.events.add(500,function(){playState.playerAlive&&a.animations.play("quack-run",this.frameRate,!0)},this)),this.state.inputLockTime=this.state.time.time+50},update:function(){this.blink++}},bootState={name:"bootState",spriteAtlas:"atlas",resize:function(){onResize.call(this,this.scale,{width:this.game.width,height:this.game.height})},init:function(){-1===window.location.href.indexOf("localhost:8383")&&(this.load.path="/christmasgame/"),this.dataLoaded||(this.dataLoaded=!0,dataStorage.init()),Phaser.Plugin.Debug},preload:function(){this.game.forceSingleUpdate=!0,this.game.renderer.renderSession.roundPixels=!1,this.stage.smoothed=!0,this.game.renderer.clearBeforeRender=!0,this.stage.backgroundColor="#f7fbfd",this.scale.scaleMode=Phaser.ScaleManager.RESIZE,this.scale.fullScreenScaleMode=Phaser.ScaleManager.RESIZE,this.scale.setShowAll(),this.scale.refresh()},loadComplete:function(){if(dataStorage.debug&&this.spriteAtlas)for(var a=this.game.cache.getFrameData(this.spriteAtlas).getFrames(),b=0;b<a.length;b++){var c=a[b].name;this.cache.checkImageKey(c)||this.game.load.image(c,"cache/"+this.spriteAtlas+"/"+c)}this.state.add("mainState",mainState,!0)},create:function(){this.input.maxPointers=1,this.boardGroup=new BoardGroup(this.game,{width:640,height:720},{width:640,height:720}),this.boardGroup.addText(dataStorage.title,0,.2,"c98dd0",60),this.boardGroup.addText("minimindgames.com",0,.3,"98a1c1",48),this.loadText=this.boardGroup.addText("Loading ...",0,.4,"666666",32),this.load.image("quack.png","cache/quack.png");var a={spritemap:{countdown:{start:0,end:2.3,loop:!1},crunch:{start:3,end:3.2,loop:!1},collide:{start:4,end:4.1,loop:!1},end:{start:5,end:5.9,loop:!1},bulp1:{start:6,end:6.1,loop:!1},bulp2:{start:6.2,end:6.3,loop:!1},bulp3:{start:6.4,end:6.5,loop:!1}}};this.load.audiosprite("sound-effects",["cache/sound-effects.ogg","cache/sound-effects.mp3"],null,a),this.time.events.add(10,function(){this.load.atlasXML("atlas","cache/atlas/sprites.png","cache/atlas/sprites.xml"),this.load.onFileComplete.add(this.fileComplete,this),this.load.onLoadComplete.addOnce(this.loadComplete,this),this.load.start()},this),this.game.scale.setResizeCallback(this.onResize,this),this.resize()},fileComplete:function(a,b,c,d,e){this.loadText.setText("Loading "+a+" %"),c&&"quack.png"===b&&this.boardGroup.addSpriteFromFile(b,0,-.2)},shutdown:function(){}};
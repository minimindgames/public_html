var urlBase="//minimindgames.com/puzzle-pieces/",Server={getImgPath:function(t){return 0===t.image.indexOf("https://")||0===t.image.indexOf("http://")?t.image:"//minimindgames.com/content/"+t.id},readJSON:function(t){var e=null;try{void 0!==window.JSON&&JSON.parse&&(e=JSON.parse(t))}catch(t){return null}return e},onError:function(){alert("Error")},get:function(t,e,i,s){var a=urlBase+t+".php";s||(s=this.onError),$.ajax({url:a+"?"+e,type:"GET",cache:!1,contentType:!1,processData:!1,crossDomain:!0,xhrFields:{withCredentials:!0},success:function(t){var e=Server.readJSON(t);if(e&&e.data){var s=e.data;s?(s.error&&alert(s.error),i(s)):alert("No data.")}else e&&e.error&&alert(e.error)},error:function(t){console.log(t),s()}})},clickLink:function(t){var e="//minimindgames.com/make-photos-puzzles/click.php?d="+t;window.location.href=e},openLink:function(t){window.open(t)},clickCollection:function(t,e,i){i||(i=0),Server.ajax("collection","d="+i+"&c="+t+"&a=2&g="+e)},likeCollection:function(t,e,i){i||(i=0),Server.ajax("collection","d="+i+"&c="+t+"&a=3&g="+e)},dislikeCollection:function(t,e,i){i||(i=0),Server.ajax("collection","d="+i+"&c="+t+"&a=4&g="+e)},removedCollection:function(t,e,i){i||(i=0),Server.ajax("collection","d="+i+"&c="+t+"&a=5&g="+e)},addCollection:function(t,e){Server.ajax("collection","d=0&c="+t+"&g="+e+"&a=1")},ajax:function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&200===i.status&&i.responseText};var s=urlBase+t+".php?"+e;i.open("GET",s),i.send()}},leadManager=leadManager||{name:"leadManager.",preloaded:!1,increaseScore:function(t,e){console.log(this.name+"increaseScore "+t+" "+e)}},achManager=achManager||{name:"achManager.",preloaded:!1,unlockAchievement:function(t){console.log(this.name+"unlockAchievement "+t)}},constants=constants||{};constants.CLIENT_ID="206761680427-8g4a8o6t230b4f4rqqqdgomnnb1i1n6j.apps.googleusercontent.com",constants.LEAD_TOTAL_WINS="CgkIq7zTn4IGEAIQBQ";var leadTimeUnit=6e4,playService={score:864e5,loginComplete:!1,mainStarted:!1,name:"playService.",achievements:[],leadScores:[{id:"me",rank:5,avatar:"avatar-me.png",name:"You",wins:0,inRow:0,time:0,playerId:null}],scores:[],levels:[{id:484541,score:0}],init:function(t){},getAchievement:function(t){for(var e=0;e<this.achievements.length;e++)if(this.achievements[e].id===t)return this.achievements[e]},getPlayer:function(t){for(var e=0;e<this.leadScores.length;e++)if(this.leadScores[e].id===t)return this.leadScores[e];return null},getAchievements:function(t,e,i){var s,a=[];for(s=0;s<this.achievements.length&&(this.achievements[s].state===t&&a.push({name:this.achievements[s].name,desc:this.achievements[s].desc,id:this.achievements[s].id,icon:this.achievements[s].icon}),!(e>0&&a.length>=e));s++);if(i)for(s=0;s<this.achievements.length&&(this.achievements[s].claim&&a.push({name:this.achievements[s].name,desc:this.achievements[s].desc,id:this.achievements[s].id}),!(e>0&&a.length>=e));s++);return a},getScores:function(){var t=[],e=playService.getPlayer("me");return t.push(e.wins),t},resize:function(t,e,i){var s=document.getElementById("login-buttons");s&&(s.style.left=Math.floor(t*i)+"px",s.style.top=Math.floor(e*i)+"px"),(s=document.getElementById("login-image"))&&(s.style.width=Math.floor(64*i)+"px",s.style.height=Math.floor(64*i)+"px")},showLogin:function(){if(!this.loggedIn&&this.mainStarted&&this.loginComplete){var t=document.getElementById("login-buttons");t&&(t.style.display="block")}},downloadedScore:function(t,e){var i=playService.getPlayer("me"),s=!1;return t===constants.LEAD_TOTAL_WINS&&(e>i.wins?(i.wins=e,s=!0):i.wins>e&&leadManager.increaseScore(t,i.wins)),s},downloadedAchievements:function(t){for(var e=!1,i=0;i<t.length;i++){var s=t[i],a=this.getAchievement(s.id);if(a)if("UNLOCKED"===s.achievementState){if(a&&"UNLOCKED"!==a.state){a.state="UNLOCKED";for(var o=0;o<this.achievements.length-1;o++)this.achievements[o]===a&&this.achievements[o+1].type===a.type&&(this.achievements[o+1].state="REVEALED");e=!0}}else a&&"UNLOCKED"===a.state&&achManager.unlockAchievement(s.id)}e&&(dataStorage.saveAchievements(),mainState.updateAchievements())},loadedScores:function(t,e){for(var i=0;i<t.length;i++)e.addChapter(t[i])},loadedAchievements:function(t){var e,i=!1;for(e=0;e<t.length;e++){var s=this.getAchievement(t[e]);if("UNLOCKED"!==s.state)for(i=!0,s.state="UNLOCKED",achManager.unlockAchievement(t[e]),e=0;e<this.achievements.length-1;e++)this.achievements[e]===s&&this.achievements[e+1].type===s.type&&(this.achievements[e+1].state="REVEALED")}i&&mainState.updateAchievements()},showAchievements:function(t){for(var e=[],i=0;i<this.achievements.length&&(this.achievements[i].claim&&(this.achievements[i].claim=!1,e.push({name:this.achievements[i].name,desc:this.achievements[i].desc})),!(t>0&&e.length>=t));i++);return e},setScore:function(t){var e,i;for(playerData=playService.getPlayer("me"),playerData.wins=t,e=0;e<this.achievements.length;e++)if(1===(i=this.achievements[e]).type&&"REVEALED"===i.state&&playerData.wins>=i.data){this.unlockAchievement(i.id,!0);break}return dataStorage.saveScores(),!1},unlockAchievement:function(t,e){var i=this.getAchievement(t);if("UNLOCKED"!==i.state){i.state="UNLOCKED",i.claim=!0,achManager.unlockAchievement(t),dataStorage.saveAchievements(),!0;for(var s=0;s<this.achievements.length-1;s++)this.achievements[s]===i&&this.achievements[s+1].type===i.type&&(this.achievements[s+1].state="REVEALED")}},hide:function(){var t=document.getElementById("login-buttons");t&&(t.style.display="none")},signedIn:function(t){this.loginComplete=!0,t?(this.loggedIn=!0,this.hide()):this.showLogin()},claimAchievements:function(){for(var t=0;t<this.achievements.length;t++)this.achievements[t].claim&&(achManager.unlockAchievement(this.achievements[t].id),this.achievements[t].claim=!1)},addPlayer:function(t,e,i,s){var a=playService.getPlayer("me");i&&(a.name=i),s&&!a.iconLoaded&&(a.iconLoaded=!0,a.icon=s,mainState.updatePlayerIcon(a)),this.downloadedScore(t,e)&&(dataStorage.saveScores(),mainState.updateScores())},sync:function(){console.log("sync");playService.getPlayer("me");mainState.updateScores()}};function getProfilePic(t){}function loadUpFriends(){gapi.client.plus.people.list({collection:"visible",orderBy:"alphabetical",userId:"me",maxResults:20}).execute(function(t){if(t.hasOwnProperty("items"))for(var e=0;e<t.items.length;e++);})}leadManager.preloaded=!1,leadManager.leaderboards={},leadManager.preloadData=function(){leadManager.showLeaderboard(constants.LEAD_TOTAL_WINS)},leadManager.getScore=function(){gapi.client.games.scores.get({playerId:"me",timeSpan:"ALL_TIME",leaderboardId:"ALL"}).execute(function(t){if(!t.error){var e=[];if(t.items&&t.items.length>0)for(var i=0;i<t.items.length;i++)e.push({id:t.items[i].leaderboard_id,value:t.items[i].scoreValue});playService.downloadedScore(e)}}),leadManager.preloaded=!0},leadManager.increaseScore=function(t,e){leadManager.preloaded&&gapi.client.games.scores.submit({leaderboardId:t,score:e}).execute(function(t){if(t.hasOwnProperty("beatenScoreTimeSpans"))for(var e=0;e<t.beatenScoreTimeSpans.length;e++)"ALL_TIME"===t.beatenScoreTimeSpans[e]&&!0})},leadManager.showLeaderboard=function(t){gapi.client.games.scores.list({collection:"SOCIAL",leaderboardId:t,timeSpan:"ALL_TIME"}).execute(function(e){if(e.message,e.hasOwnProperty("items")){if(e.playerScore){var i=e.playerScore,s=i.player,a=s.displayName;(!a||a>15)&&s.name&&s.name.givenName&&(a=s.name.givenName);var o=s.avatarImageUrl;o&&(o+="?sz=74"),playService.addPlayer(t,i.scoreValue,a,o)}}else leadManager.preloaded=!0,playService.sync()})},achManager.achievements={},achManager.preloaded=!1,achManager.preloadData=function(){gapi.client.games.achievementDefinitions.list().execute(function(t){if("games#achievementDefinitionsListResponse"===t.kind&&t.hasOwnProperty("items")){for(var e=0;e<t.items.length;e++)achManager.achievements[t.items[e].id]=t.items[e],achManager.achievements[t.items[e].id].achievementState=t.items[e].initialState;achManager.loadAchievementsEarnedByPlayer()}})},achManager.loadAchievementsEarnedByPlayer=function(){gapi.client.games.achievements.list({playerId:"me"}).execute(function(t){if("games#playerAchievementListResponse"===t.kind&&t.hasOwnProperty("items")){for(var e=[],i=0;i<t.items.length;i++){var s=t.items[i];achManager.achievements[s.id].achievementState=s.achievementState,s.hasOwnProperty("formattedCurrentStepsString")&&(achManager.achievements[s.id].formattedCurrentStepsString=s.formattedCurrentStepsString),e.push(achManager.achievements[s.id])}playService.downloadedAchievements(e),achManager.preloaded=!0}else console.log("**Unexpected response **",t)})},achManager.unlockAchievement=function(t){achManager.preloaded&&gapi.client.games.achievements.unlock({achievementId:t}).execute(function(t){t.newlyUnlocked})},achManager.reset=function(t){};var login=login||{};login.loadClient=function(){gapi.client.load("games","v1",function(){leadManager.preloadData(),achManager.preloadData()})},login.handleAuthResult=function(t){t&&!t.error?(login.loadClient(),playService.signedIn(!0)):playService.signedIn(!1)},login.showLoginDialog=function(){gapi.auth.signIn()},login.logout=function(){gapi.auth.signOut()};var googleLoginCallback=function(t){login.handleAuthResult(t)},Color={black:"181712",gray:"757575",blue:"6ABED8",white:"F0F0F0",lightGray:"B0ABA0",int:function(t){return parseInt("0x"+t)}},red="F09CCC",yellow="E36CAF",gray="999999",salmon="D74899",lila="8c0031";function copy(t){var e,i,s;for(s in e=Array.isArray(t)?[]:{},t)i=t[s],e[s]="object"==typeof i?copy(i):i;return e}function addText(t,e,i,s,a,o){var h=this.game.add.text(0,0,t,{fill:"#"+s,fontWeight:"normal",font:dataStorage.fontContent},this.textGroup);return h.anchor.set(.5),h.setShadow(1,1,"rgba(255,255,255,1)",2),h.dx=.5+e,h.dy=.5+i,h.size=h.size=Math.floor(a),h.x=h.dx*this.size.width,h.y=h.dy*this.size.height,o&&h.kill(),h}function addSpriteFromFile(t,e,i){var s;return s=this.create(0,0,t),void 0===e&&(s.kill(),e=i=0),s.anchor.set(.5),s.dx=.5+e,s.dy=.5+i,s.x=s.dx*this.size.width,s.y=s.dy*this.size.height,s}function setTexture(t,e){dataStorage.debug?t.loadTexture(e):t.frameName=e}function addSprite(t,e,i,s,a){var o;return a||(a=this),o=dataStorage.debug?a.create(0,0,t):a.create(0,0,s,t),a&&(o.noscale=!0),o.anchor.set(.5),void 0===e&&(o.kill(),e=i=0),o.dx=.5+e,o.dy=.5+i,o.x=Math.floor(o.dx*this.size.width),o.y=Math.floor(o.dy*this.size.height),o}function makeSprite(t,e,i,s){return dataStorage.debug?t.make.sprite(i,s,e):t.make.sprite(i,s,"atlas",e)}function lockInputbak(t){t||(t=500),this.inputLockTime=this.time.now+t}function handleInputWidgetbak(){if(!this.inputWidget){if(this.game.input.activePointer.targetObject){var t=this;this.inputWidgets.forEach(function(e){e.input()&&t.showInputWidget(e)})}return null!==this.inputWidget}return hideInputWidget(this),!0}function dimmOverlaybak(t){var e=window.dimmGraphics;if(e){if(e.width===window.innerWidth&&e.height===window.innerHeight)return}else e=window.dimmGraphics=t.make.graphics(0,0);return e.clear(),e.beginFill(0),e.drawRect(0,0,window.innerWidth,window.innerHeight),e.endFill(),e}function onResize(t,e){var i=e.width,s=e.height;this.width===i&&this.height,this.width=i,this.height=s;var a=i>=s,o=0,h=0;this.headerGroup&&(this.headerGroup.size=a?this.headerGroup.landSize:this.headerGroup.portSize,o+=this.headerGroup.size.width,h+=this.headerGroup.size.height),this.boardGroup&&(this.boardGroup.size=a?this.boardGroup.landSize:this.boardGroup.portSize,o+=this.boardGroup.size.width,h+=this.boardGroup.size.height),this.controlGroup&&(this.controlGroup.size=a?this.controlGroup.landSize:this.controlGroup.portSize,o+=this.controlGroup.size.width,h+=this.controlGroup.size.height),this.adGroup&&(this.adGroup.size=a?this.adGroup.landSize:this.adGroup.portSize);var r=i/o,n=s/h,l=Math.min(r,n);l>1&&(l=1);var d,p=0,c=0;if((d=this.bgGroup)&&d.resize(l,p,c,i-p,s-c),(d=this.headerGroup)&&(d.resize(l,p,c,i-p,s-c),p+=d.size.width*d.scale.x,c+=d.size.height*d.scale.y),d=this.boardGroup){var u=0,g=0;this.controlGroup&&(u=this.controlGroup.size.width*l,g=this.controlGroup.size.height*l),d.resize(l,p,c,i-p-u,s-c-g),a?p+=d.size.width*d.scale.x:c+=d.size.height*d.scale.y}return(d=this.controlGroup)&&d.resize(l,p,c,i-p,s-c),(d=this.adGroup)&&d.resize(l,0,0,i,s),(d=this.popupGroup)&&d.resize(l,0,0,i,s),(d=this.effectGroup)&&d.resize(l,0,0,i,s),(d=this.tutorialGroup)&&d.resize(l,0,0,i,s),l}String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var dimOverlay=null;function fadeOutEffect(t,e,i){playService.hide();var s=!i,a=t.game.add.graphics(0,0);t.world.remove(a),a.beginFill(2,0,1),tweenColor(t.game,t.game.stage,10066329,e,500);var o=t.game.width,h=t.game.height,r=Math.max(o,h),n={step:s?r:0};a.drawCircle(o/2,h/2,n.step);var l=t.add.tween(n).to({step:s?0:r},500,Phaser.Easing.Quadratic.InOut,!0).onUpdateCallback(function(){a.clear(),a.beginFill(2,0,1),a.drawCircle(o/2,h/2,n.step)},this);return t.world.mask=a,l}function tweenColor(t,e,i,s,a){var o={step:0},h=t.add.tween(o).to({step:100},a,Phaser.Easing.Linear.None,!1);h.onUpdateCallback(function(){e.backgroundColor=Phaser.Color.interpolateColor(i,s,100,o.step)}),e.backgroundColor=i,h.start()}function addPointer(t,e,i){t.add.sprite(e,i,"atlas","sudokugarden-play.png").anchor.set(.5)}function formatTime(t){var e=Math.floor(t/60);return e+":"+("0"+(t-60*e)).substr(-2)}function renderBg(t){var e=this.game.width,i=this.game.height;this.cache.checkBitmapDataKey("bmd-bg")||((s=this.make.bitmapData(e,i)).smoothed=!1,this.cache.addBitmapData("bmd-bg",s));var s=this.cache.getBitmapData("bmd-bg");s.width===e&&s.height===i||s.resize(e,i),s.clear();var a=s.ctx.createLinearGradient(0,0,0,s.height);a.addColorStop(0,"#f1e5e5"),a.addColorStop(.25,"#f1e5e5"),a.addColorStop(.5,"#2244ff"),a.addColorStop(.5,"#187d31"),a.addColorStop(1,"#8ba45d"),s.ctx.fillStyle=a,s.ctx.fillRect(0,0,e,i);var o=makeSprite(this.game,"bg-top.png",0,0);o.scale.set(t),o.width=e;var h=o.height;s.draw(o,0,0),o.destroy(),(o=makeSprite(this.game,"bg-top-below.png",0,0)).scale.set(t),s.draw(o,s.width-o.width>>1,h),o.destroy(),(o=makeSprite(this.game,"bg-grass.png",0,0)).scale.set(t),o.width=e,h=i-o.height,s.draw(o,0,i-o.height),o.destroy(),(o=makeSprite(this.game,"bg-grass-above.png",0,0)).scale.set(t),s.draw(o,s.width-o.width>>1,h-o.height),o.destroy(),this.bg||(this.bg=this.game.add.image(0,0,s),this.bg.sendToBack())}var Text={YouSolvedAll:"You solved all Sudoku techniques at level",YouCanNowPlay1:"You can now play ",YouCanNowPlay2:" puzzles or keep learning new techniques.",tip:"TIP",ExtraTip:"Level Bonus!\nTIP",ExtraLife:"Level Bonus!\nLIFE",ExtraNone:"Great Progress!",Level:"Level",All_complete:"All complete.",All_complete_Select_next:"Select next.",Clear_Temple_First:"Solve Temple Sudokus first.",Music_by:"Music by",Solve:"Solve",first:"first",Sounds_by:"Sounds by",MoreCredits:"See details in Learn Sudoku",SudokuTips:"Learn Sudoku FAST!",SudokuTech:"Techniques",progressLevel:"",progressGame:"",SolveSudoku:"Solve the sudoku puzzle.",FindNext:"Solve the next digit.",FindNexts:"Solve the next digit.",move:"move",moves:"moves",Tutorial:"Tutorial",SudokuGuide:"Fill the board so that each column, row and box has once number 1 - 9.",TooManyMistakes:"Too many mistakes.",LevelFailed:"Level failed.",PressToContinue:" Press anywhere to continue ",PressToStart:" Press anywhere to continue ",HowManyDigitToFind:"How many digits to find.",YouLoseLifeOnMistake:"You lose a life on mistake.",SudokuTechniqueYouNeedToApply:"Sudoku technique,\nYou need to apply.",NoMoreTips:"No more tips for this puzzle.",TipConsumesLife:"Not enough life for tip.",SelectCellFirst:"Select a cell first.",DigitNotPossible:"Digit not possible!",All:"All",AlreadyInPlace:"Piece already in place.",YouCanAskForTip:"\nYou can ask\nfor a TIP.",YouCanAlsoSelectCellFirst:"\nYou can also\nselect cell first.",YouCanReadMore:"\nYou can read\nabout technique.",MarkingMode:"\nSet candidate\nmarking on/off.",EasyPass:"You are ready to solve EASY Sudoku puzzles!",MediumPass:"You are ready to solve MEDIUM Sudoku puzzles!",HardPass:"You are ready to solve HARD Sudoku puzzles!",ExpertPass:"You are ready to solve TRICKY Sudoku puzzles!",ExtremePass:"You are ready to solve EXTREME Sudoku puzzles!",IncorrectLoseLife:"That's incorrect!",OutOfLives:"You are out of lives.\n\nQuit to try again?",PuzzleSolved:"PUZZLE SOLVED",Loading:"Loading...",FAST:"FAST",Singles:"Singles",Subsets:"Subsets",Fishing:"Fishing",Confident:"Confident",Proficient:"Proficient",Expert:"Tricky",Extreme:"Extreme",Wings:"Wings",CanYouClimb:"Can you climb up\nto the Sudoku\nTemple",CanYouSolve:"Can you solve\nthe Sudoku problems?",ProblemContains:"To succeed:\nYou need to know",Temple:"Temple",ToSucceed:"To succeed,\nYou need to know",Technique:"Technique",Techniques:"Techniques",FullHouse:"Full House",NakedSingle:"Naked Single",HiddenSingle:"Hidden Single",FindSingles:"Single Digit",Intersection:"Point. Digits",Intersection2:"Locked Digits",NakedPair:"Naked Pair",HiddenPair:"Hidden Pair",Xwing:"X-wing",Ywing:"Y-wing",FinnedXwing:"Finned X-Wing",SashimiXWing:"Sash. X-Wing",XYZwing:"XYZ Wing",NakedTriplet:"Naked Triplet",HiddenTriplet:"Hidden Triplet",Swordfish:"Sword Fish",NakedQuad:"Naked Quad",HiddenQuad:"Hidden Quad",Jellyfish:"Jelly Fish",NextTechnique:"Learn Technique",NextProblem:"Problems",AreYouSureToQuit:"Do you want to quit this game?",HowToPlay:"\nHow to play:\nSelect an\nempty cell.",SelectMissingCell:"\nThen select the\nmissing number.",OneMoreToGo:"\nGREAT!\nOne more to go.",TipCostsLife:"Tip takes one life.",WorldCompletedWaitNew:"Congratulations! You reached Temple and opened new levels (we are working on).",MoreLevels:"More levels coming soon.",ReadAbout:"Read about",finmoregames:"Find more games",WorldCompletedOpenNext:"Congratulations!\n\nYou solved all the puzzles.",ProblemCompleted:"Congratulations!\n\nYou really know these techniques!",SudokuProblems:"Problems",SudokuProblem:"Sudoku Problem",SudokuPuzzle:"Sudoku Puzzle",SudokuPuzzles:"Puzzles",SudokuTricks:"Sudoku Tricks",Fun:"funs",SudokuFun:"Just for Fun",SudokuPictures:"Sudoku Seasons",SudokuTechniques:"Learn Sudoku",Solved:"SOLVED",Easy:"Easy",Fair:"Medium",Advanced:"Advanced",Hard:"Hard",Evil:"Evil",NewTechnique:"Technique",Superb:"SUPERB",Brilliant:"BRILLIANT",Perfect:"PERFECT",Excellent:"EXCELLENT",Amazing:"AMAZING",Wonderful:"WONDERFUL",Fantastic:"FANTASTIC",Outstanding:"OUTSTANDING",Congratulations:"CONGRATS!",TECH:"info",PROB:"new",PUZZ:"find",title:"Picture Puzzle",find:"Find",outOfLives:"Too many guesses.\n\nQuit to try again?",pickOnlyRotated:"Pick only rotated tiles.",TileAlreadyInPlace:"Not correct placement.",slidetutor:"\nThat's better!\nCan you slide the next?",tutorOneMore:"\nThat's GREAT!\nOne more to go.",colorHelp1:"\nSelect main color\nfor this photo.",colorHelp2:"\nPick the best swatch\nfor this photo.",colorHelp3:"\nDrag colors to\nrainbow like order.",sorryWrong:"Sorry... but\nI must disagree.",tileNotInPlace:"Not correct move.",mainColor:"Select photo's main color",bestSwatch:"Pick the best palette",rainbowlike:"Drag in rainbowlike order",gameTitle:"",fi:function(){Text.gameTitle="",Text.rainbowlike="Järjestä kuten sateenkaaressa",Text.bestSwatch="Valitse sopivin paletti",Text.mainColor="Valitse kuvan pääväri",Text.tileNotInPlace="Väärä arvaus.",Text.sorryWrong="Valitan... mutta\nolen eri mieltä.",Text.colorHelp1="\nValitse tämän\nkuvan pääväri.",Text.colorHelp2="\nValitse parhaiten\nsopiva paletti.",Text.colorHelp3="\nJärjestä värit\nkuten sateenkaaressa.",Text.tutorOneMore="\nHIENOA!\nLöydätkö vielä yhden.",Text.slidetutor="\nHIENOA!\nLöydätkö seuraavan?",Text.outOfLives="Liian monta arvausta.\n\nYritä uudelleen?",Text.pickOnlyRotated="Poimi vain kiertyneet palat.",Text.TileAlreadyInPlace="Ei oikea paikka.",Text.TECH="info",Text.PROB="ongl",Text.PUZZ="etsi",Text.Congratulations="ONNITTELUT!",Text.NewTechnique="Tekniikka",Text.tip="VIHJE",Text.Level="Taso",Text.All_complete="Kaikki ratkaistu.",Text.All_complete_Select_next="Kaikki ratkaistu. Valitse seuraava.",Text.Music_by="Musiikit ",Text.Sounds_by="Äänet ",Text.SudokuTips="Ratkaise Sudoku!",Text.SudokuTech="Tekniikat",Text.SolveSudoku="Ratkaise Sudoku.",Text.FindNext="Täytä yksi numero.",Text.FindNexts="Täytä yksi numero.",Text.move="siirto",Text.moves="siirtoa",Text.SudokuGuide="Täytä numerot 1-9 ruudukon\njokaiseen sarakkeeseen, riviin\nja 3x3 laatikkoon.",Text.TooManyMistakes="Liian monta virhettä.",Text.LevelFailed="Taso epäonnistui.",Text.PressToContinue=" Jatka näpäyttämällä ruutua. ",Text.PressToStart=" Jatka näpäyttämällä ruutua. ",Text.HowManyDigitToFind="Kuinka monta numeroa jäljellä.",Text.YouLoseLifeOnMistake="Menetät elämän virheestä.",Text.SudokuTechniqueYouNeedToApply="Sudoku tekniikka,\njonka tarvitset.",Text.NoMoreTips="Ei enää vinkkejä tähän pulmaan.",Text.TipConsumesLife="Ei tarpeeksi elämiä.",Text.SelectCellFirst="Valitse ensin solu.",Text.DigitNotPossible="Numero ei mahdollinen!",Text.All="Kaikki",Text.AlreadyInPlace="Pala on jo oikein.",Text.YouCanAskForTip="\nVoit kysyä\nvihjettä.",Text.YouCanAlsoSelectCellFirst="\nVoit valita\nsolun ensin.",Text.MarkingMode="\nMerkintätila\npäälle/pois.",Text.IncorrectLoseLife="Väärä siirto!\nMenetit elämän.",Text.OutOfLives="Elämät loppuivat.\n\nYritä uudestaan?",Text.PuzzleSolved="PULMA RATKAISTU",Text.Loading="Ladataan...",Text.Singles="Orvot",Text.Subsets="Joukot",Text.Fishing="Kalat",Text.Wings="Siivet",Text.CanYouClimb="Pääsetkö\nSudoku\nTemppeliin",Text.CanYouSolve="Osaatko ratkaista\nSudoku ongelmat?",Text.ProblemContains="Onnistut jos osaat",Text.Temple="Temppeliin",Text.ToSucceed="Onnistuaksesi sinun\npitää osata Sudokun",Text.Techniques="Tekniikka",Text.FullHouse="Täysi talo",Text.NakedSingle="Paljas orpo",Text.HiddenSingle="Piilo orpo",Text.FindSingles="Orpo nro",Text.Intersection="Lukit. nrot",Text.Intersection2="Osoit. nrot",Text.NakedPair="Paljas pari",Text.HiddenPair="Piilo pari",Text.Xwing="X siipi",Text.Ywing="Y siipi",Text.FinnedXwing="X evällä",Text.SashimiXWing="Sash. X-siipi",Text.XYZwing="XYZ siipi",Text.NakedTriplet="Paljas kolme",Text.HiddenTriplet="Piilo kolme",Text.Swordfish="Miekka kala",Text.NakedQuad="Paljas neljä",Text.HiddenQuad="Piilo neljä",Text.Jellyfish="Medusa",Text.NextTechnique="Ratkaise Sudoku",Text.NextProblem="Ongelmat",Text.AreYouSureToQuit="Haluatko poistua tästä pelistä?",Text.HowToPlay="\nKuinka pelaat:\nValitse ensin\ntyhjä solu.",Text.SelectMissingCell="\nValitse sitten\npuuttuva numero.",Text.OneMoreToGo="\nHIENOA!\nVielä yksi numero.",Text.TipCostsLife="Vihje vie yhden elämän.",Text.WorldCompletedWaitNew="Onneksi olkoon!\n\nSinä todella osaat nämä tekniikat!",Text.MoreLevels="Uusia tasoja tulossa pian.",Text.ReadAbout="Lue lisää",Text.finmoregames="Lisää pelejä:",Text.WorldCompletedOpenNext="Onneksi olkoon!\n\nRatkaisit kaikki tehtävät.",Text.ExtraTip="Sait lisä vinkin!",Text.ExtraLife="Sait lisä elämän!",Text.ExtraNone="Hyvin tehty!",Text.ProblemCompleted="Onneksi olkoon!\n\nSinä todella osaat nämä tekniikat!",Text.Clear_Temple_First="Ratkaise Temppeli Sudokut ensin.",Text.Confident="Edistynyt",Text.Proficient="Taitava",Text.Expert="Kinkkinen",Text.Technique="Sudoku Tekniikat",Text.SudokuProblems="Ongelmat",Text.SudokuPuzzles="Pulmat",Text.SudokuTricks="Sudoku Haasteet",Text.SudokuPictures="Sudoku Kevät",Text.SudokuTechniques="Sudoku\nTekniikat",Text.Easy="Helppo",Text.Fair="Keskitaso",Text.Advanced="Haastava",Text.Hard="Vaikea",Text.Evil="Ilkeä",Text.SudokuProblem="Sudoku Pulma",Text.SudokuPuzzle="Sudoku",Text.Solved="Osaat tekniikan: ",Text.Tutorial="Tutoriaali",Text.EasyPass="Osaat nyt ratkaista HELPOT Sudoku pulmat!",Text.MediumPass="Osaat nyt ratkaista KESKITASON Sudoku pulmat!",Text.HardPass="Osaat nyt ratkaista VAIKEAT Sudoku pulmat!",Text.ExpertPass="Osaat nyt ratkaista KINKKISET Sudoku pulmat!",Text.ExtremePass="Osaat nyt ratkaista ÄLYTTÖMÄT Sudoku pulmat!",Text.Extreme="Mahdoton",Text.Superb="HUIPPUA",Text.Brilliant="NEROKASTA",Text.Perfect="TÄYDELLISTÄ",Text.Excellent="ERINOMAISTA",Text.Amazing="HÄMMÄSTYTTÄVÄÄ",Text.Wonderful="MAHTAVAA",Text.Fantastic="FANTASTISTA",Text.Outstanding="YLIVERTAISTA",Text.YouCanReadMore="\nVoit lukea\ntekniikasta.",Text.YouSolvedAll="Ratkaisit kaikki sudoku tekniikat tasolla",Text.YouCanNowPlay1="Voit nyt pelata tason ",Text.YouCanNowPlay2=" pulmia tai jatkaa uusiin tekniikoihin.",Text.MoreCredits="Lisätiedot kohdasta Sudoku",Text.progressLevel="",Text.progressGame="",Text.FAST="HETI",Text.Solve="Ratkaise",Text.first="ensin",Text.Fun="hupi",Text.SudokuFun="Huvit",Text.title="Kuvapelit",Text.find="Find",Text.JigsawPuzzle="Palapeli",Text.ColorPuzzle="Väripulma",Text.RollingPuzzle="Pyörivät palat",Text.SlidingPuzzle="Liukupalapeli",Text.PLAY="Pelaa",Text.misplaced="Montako palaa väärin.",Text.loseLives="Ratkaise minimiliikuilla.",Text.trytosolvewithoutguessing="Yritä ratkaista pulma ilman arvauksia.",Text.slideMisplaced="\nTämä pala on väärin.\nLiu'uta se napauttamalla.",Text.rotateMisplaced="\nTämä pala on väärin.\nPyöritä se napauttamalla.",Text.misplacedDrag="\nTämä pala on väärin.\nSiirrä se vetämällä.",Text.swapTiles="\nVedä pala tähän.",Text.fixRest="\nHIENOA!\nOsaatko ratkaista loput?",Text.correct="Oikein!",Text.collection="Kokoelma ",Text.photoBy="Kuva ",Text.more="Lisää"},correct:"Correct!",fixRest:"\nThat's GREAT!\nCan you fix the rest?",swapTiles:"\nDrag here\nto swap the tiles.",misplacedDrag:"This tile is misplaced.\nSelect to drag it.",rotateMisplaced:"\nThis tile is misplaced.\nSelect it to rotate.",slideMisplaced:"\nThis tile is misplaced.\nSelect it to slide.",JigsawPuzzle:"Jigsaw Puzzle",ColorPuzzle:"Color Puzzle",RollingPuzzle:"Rolling Puzzle",SlidingPuzzle:"Sliding Puzzle",PLAY:"PLAY",misplaced:"How many misplaced tiles.",loseLives:"Try to use minimum moves.",trytosolvewithoutguessing:"Try to solve puzzle without guessing.",collection:"Collection ",photoBy:"by ",more:"More"};function setLang(){-1!==window.location.href.indexOf("fi/")&&Text.fi()}setLang();var dataStorage={appID:"2f6ba9d78f17a5363d1294679d139948a835e405b4bcf9a447021c9aae6eb027",URL:"https://minimindgames.com/make-photos-puzzles/",minimindgamesCom:"https://minimindgames.com/",title:Text.title,name:"puzzlepieces-3",fontContent:"Source Serif Pro",fontHeader:"Source Code Pro",debug:!1,isAudio:!1,isMusic:!1,upgrades:[],loadConfig:function(){if(bootState.app){var t=window.localStorage.getItem("option-sound");return t||(t="1",window.localStorage.setItem("option-sound",t)),void(bootState.sound="1"===t)}var e=localStorage.getItem("audio");null!==e&&"null"!==e&&(this.isAudio="on"===e),null!==(e=localStorage.getItem("music"))&&"null"!==e&&(this.isMusic="on"===e),this.isAudio||(this.isMusic=this.isAudio)},loadGameScore:function(t,e){var i=localStorage.getItem(this.name+t+"score");this.debugScore&&(i=this.debugScore);var s,a=[];if(null!==i&&"null"!==i&&""!==i){var o=i.trim().split(" ");for(s=0;s<o.length;s+=5){if(parseInt(o[s+0])<=0)throw"Err";a.push({chapter:parseInt(o[s+0]),level:parseInt(o[s+1]),progress:parseInt(o[s+2]),health:parseInt(o[s+3]),tips:parseInt(o[s+4])})}}if(a.length>0){var h=document.getElementsByClassName("playlink");for(s=0;s<h.length;s++)h[s].style.display="block"}playService.loadedScores(a,e)},loadScore:function(){this.loadGameScore("jigsaw",playGridJigsaw),this.loadGameScore("slide",playGridSliding),this.loadGameScore("roll",playGridRolling),this.loadGameScore("color",playGridColor)},init:function(){if("undefined"!=typeof Storage)try{this.loadConfig(),this.loadScore()}catch(t){alert("datastorage err"),dataStorage.reset()}},setProgress:function(t,e){if("undefined"!=typeof Storage)try{localStorage.setItem(this.name+"progress-"+t,e)}catch(t){}},setAudio:function(t){if(!bootState.app&&(this.isAudio=t,!t&&this.musicPlaying&&this.musicPlaying.fadeOut(),"undefined"!=typeof Storage))try{localStorage.setItem("audio",t?"on":"off")}catch(t){}},setMusic:function(t){if(this.isMusic=t,!t&&this.musicPlaying&&this.musicPlaying.fadeOut(),"undefined"!=typeof Storage)try{localStorage.setItem("music",t?"on":"off")}catch(t){}},reset:function(){if("undefined"!=typeof Storage)try{localStorage.removeItem(this.name+"jigsawscore"),localStorage.removeItem(this.name+"slidescore"),localStorage.removeItem(this.name+"rollscore"),localStorage.removeItem(this.name+"colorscore"),localStorage.removeItem(this.name+"upgrades"),localStorage.removeItem(this.name+"achievements");for(var t=0;t<100;t++)localStorage.removeItem(this.name+"progress-"+t)}catch(t){}},saveUpgrades:function(t){if("undefined"!=typeof Storage)try{var e="";t.forEach(function(t){e+=t+" "}),localStorage.setItem(this.name+"upgrades",e)}catch(t){}},saveAchievements:function(){if("undefined"!=typeof Storage)try{var t=playService.getAchievements("UNLOCKED"),e="";t.forEach(function(t){e+=t.id+" "}),localStorage.setItem(this.name+"achievements",e)}catch(t){}},saveGameScore:function(t,e){for(var i=[],s=e.firstChapter();s;)i.push(s),s=e.nextScore(s.chapter);var a="";i.forEach(function(t){t.health=0,t.tips=0,a+=t.chapter+" "+t.level+" "+t.progress+" "+t.health+" "+t.tips+" "}),localStorage.setItem(this.name+t+"score",a)},saveScores:function(){if("undefined"!=typeof Storage)try{this.saveGameScore("jigsaw",playGridJigsaw),this.saveGameScore("slide",playGridSliding),this.saveGameScore("roll",playGridRolling),this.saveGameScore("color",playGridColor)}catch(t){dataStorage.reset()}}};EffectGroup=function(t,e,i){Phaser.Group.call(this,t),this.landSize=e,this.portSize=i,this.size=t.width>t.height?this.landSize:this.portSize,this.textGroup=this.game.add.group(),this.spriteAtlas="atlas"},EffectGroup.prototype=Object.create(Phaser.Group.prototype),EffectGroup.prototype.constructor=EffectGroup,EffectGroup.prototype.addText=function(t,e,i,s,a,o){return addText.call(this,t,e,i,s,a,o)},EffectGroup.prototype.addSpriteFromFile=function(t,e,i){return addSpriteFromFile.call(this,t,e,i)},EffectGroup.prototype.addSprite=function(t,e,i){return addSprite.call(this,t,e,i,this.spriteAtlas)},EffectGroup.prototype.setTexture=function(t,e){dataStorage.debug?t.loadTexture(e):t.frameName=e},EffectGroup.prototype.resize=function(t,e,i,s,a){if(this.scale.set(t),this.explode1){var o=200*(t*=2);this.explode1.minParticleScale=.1*t,this.explode1.maxParticleScale=.5*t,this.explode1.minParticleSpeed.setTo(-o,-o),this.explode1.maxParticleSpeed.setTo(o,o),o/=2,this.explode2.minParticleScale=.1*t,this.explode2.maxParticleScale=.5*t,this.explode2.minParticleSpeed.setTo(-o,-o),this.explode2.maxParticleSpeed.setTo(o,o),this.spriteScale=t}},EffectGroup.prototype.move=function(t,e,i){t.dx=.5+e,t.dy=.5+i,t.x=Math.floor(t.dx*this.size.width),t.y=Math.floor(t.dy*this.size.height)},EffectGroup.prototype.moveTo=function(t,e){t.dx=e.dx,t.dy=e.dy,t.x=Math.floor(t.dx*this.size.width),t.y=Math.floor(t.dy*this.size.height)},EffectGroup.prototype.enable=function(t){"stars"===t&&((e=this.stars=this.game.add.emitter(this.game.width/2,-32,150)).width=this.game.world.width,e.height=this.game.world.height,e.makeParticles(["atlas"],["effect-starrain.png"]),e.minParticleScale=.1,e.maxParticleScale=.5,e.setYSpeed(10,20),e.setXSpeed(0,0),e.minRotation=0,e.maxRotation=0,e.gravity=0,this.add(e));"sparkle"===t&&((e=this.sparkle=this.game.add.emitter(0,0,15)).makeParticles(["atlas"],["effect-star.png"]),e.setRotation(0,0),e.gravity=0,e.minRotation=-90,e.maxRotation=90,e.setAlpha(1,0,1750,Phaser.Easing.Quadratic.InOut),this.add(e));"leaf"===t&&((e=this.leaf=this.game.add.emitter(this.game.world.centerX,this.game.world.centerY,10)).makeParticles(["atlas"],["effect-leaf.png"]),this.add(e));"snowflake.png"===t&&((e=this.leaf=this.game.add.emitter(this.game.world.centerX,this.game.world.centerY,10)).makeParticles(["atlas"],["effect-snowflake.png"]),this.add(e));"snowing"===t&&((e=this.snowing=this.game.add.emitter(this.game.width/2,-32,150)).makeParticles(["atlas"],["effect-snowflake-1.png","effect-snowflake-2.png","effect-snowflake-3.png"]),this.add(e));if("explosion"===t){(e=this.explode1=this.game.add.emitter(0,0,50)).makeParticles(["atlas"],["explode3.png"]),e.width=0,e.height=0,e.gravity=0,e.minRotation=0,e.maxRotation=0,e.setAlpha(1,0,950,Phaser.Easing.Quadratic.InOut),this.add(e),(e=this.explode2=this.game.add.emitter(0,0,25)).makeParticles(["atlas"],["explode4.png"]),e.width=0,e.height=0,e.gravity=0,e.minRotation=0,e.maxRotation=0,e.setAlpha(1,0,950,Phaser.Easing.Quadratic.InOut),this.add(e);var e,i=this.explodeSprite=this.addSprite("explode1.png",0,0);i.visible=!1,i.anchor.set(.5),i.scale.set(0),i.angle=360*Math.random(),(e=this.emitterTeleport=this.game.add.emitter(0,0,60)).makeParticles(["atlas"],["teleport1.png"]),e.gravity=0,e.minRotation=0,e.maxRotation=0,e.setAlpha(1,0,1e3,Phaser.Easing.Quadratic.InOut),this.add(e),this.teleportSprite=this.addSprite("teleport2.png",0,0),this.teleportSprite.kill(),this.teleportSprite.anchor.set(.5)}},EffectGroup.prototype.start=function(t,e,i,s){if(this.snowing){var a=150,o=this.scale.x;i<720&&(a=150*(o=(720-i)/720)),this.snowing.maxParticleScale=1*o,this.snowing.minParticleScale=.5*o,this.snowing.setYSpeed(50*o,100*o),this.snowing.setXSpeed(-50*o,50*o),this.snowing.gravity=0,this.snowing.width=i,this.snowing.height=s,this.snowing.minRotation=-70,this.snowing.maxRotation=70,this.snowing.start(!0,2e4,0,a)}else if(this.leaf){(h=this.leaf).x=t/this.scale.x,h.width=i,h.height=s,h.y=e/this.scale.y,h.start(!1,5e3,1450,0)}else if(this.explode1){o=this.scale.x;this.explode1.x=t/o,this.explode1.y=e/o,this.explode2.x=t/o,this.explode2.y=e/o,this.explodeSprite.visible=!0,this.explodeSprite.x=t/o,this.explodeSprite.y=e/o,this.explode1.start(!0,900,50,20),this.explode2.start(!0,900,50,10),this.spriteScale=1,this.explodeSprite.revive(),this.explodeSprite.scale.set(.25),this.game.add.tween(this.explodeSprite.scale).to({x:this.spriteScale,y:this.spriteScale},75,Phaser.Easing.Linear.None,!0).onComplete.add(function(){this.game.add.tween(this.explodeSprite.scale).to({x:.25,y:.25},25,Phaser.Easing.Linear.None,!0).onComplete.add(function(){this.explodeSprite.kill()},this)},this)}else if(this.stars){a=150,o=this.scale.x;i<720&&(a=150*(o=(720-i)/720)),(h=this.stars).maxParticleScale=1*o,h.minParticleScale=.5*o,h.setYSpeed(50*o,100*o),h.setXSpeed(0,0),h.gravity=0,h.width=i,h.height=s,h.minRotation=-70,h.maxRotation=70,this.stars.start(!1,1e4,50,0)}else{var h;(h=this.sparkle).width=i,h.height=s,h.x=t/this.scale.x,h.y=e/this.scale.y,h.flow(750,40,1,10)}},EffectGroup.prototype.teleport=function(t,e){var i=this.emitterTeleport;t/=this.scale.x,e/=this.scale.y,i.width=15,i.height=15,i.x=t,i.y=e,i.flow(1500,20,5,20);var s=this.teleportSprite;s.x=t,s.y=e,s.scale.x=s.scale.y=0,s.alpha=1,s.revive(),this.game.add.tween(s.scale).to({x:1,y:1},750,Phaser.Easing.Linear.None,!0,0,0,!1),this.game.add.tween(s).to({alpha:0},750,Phaser.Easing.Quadratic.InOut,!0,0,0,!1).onComplete.add(function(t){t.kill()})},PopupGroup=function(t,e){this.size=e,Phaser.Group.call(this,t),this.textGroup=this.game.add.group(),this.visible=!1,this.textGroup.visible=!1,this.fixedToCamera=!0,this.textGroup.fixedToCamera=!0},PopupGroup.prototype=Object.create(Phaser.Group.prototype),PopupGroup.prototype.constructor=PopupGroup,PopupGroup.prototype.addText=function(t,e,i,s,a){return addText.call(this,t,e,i,s,a)},PopupGroup.prototype.addSpriteFromFile=function(t,e,i){return addSpriteFromFile.call(this,t,e,i)},PopupGroup.prototype.addSprite=function(t,e,i){return addSprite.call(this,t,e,i,"atlas")},PopupGroup.prototype.resize=function(t,e,i,s,a){if(this.width=s,this.height=a,this.scale.set(t),this.dim.width=s,this.dim.height=a,this.banner){this.banner.x=s/2/t,this.banner.y=a/2/t;var o=2*s/3/t,h=a/2/t-.9*this.banner.height;this.quackSad&&(this.quackSad.x=o,this.quackSad.y=h),this.quack&&(this.quack.x=o,this.quack.y=h)}this.dialogBg&&(this.dialogBg.x=s/2/this.scale.x,this.dialogBg.y=a/2/this.scale.y),this.info&&(this.info.wordWrapWidth=500*t,this.info.x=s/2,this.info.y=a/2,this.info.fontSize=48*t,this.info.wordWrapWidth=500*t),this.infoAction&&(this.dimRight.width=this.dimLeft.width=this.game.width,this.dimRight.height=this.dimLeft.height=this.game.height,this.infoSprite&&(this.infoSprite.x=this.game.width/2/t),this.infoTitle2.x=this.infoTitle.x=this.game.width/2,this.levelText2.x=this.levelText.x=this.game.width/2,this.levelText.wordWrapWidth=720*t,this.levelText2.wordWrapWidth=720*t,this.infoTitle.fontSize=this.infoTitle.baseFontSize*t,this.infoTitle.wordWrapWidth=720*t,this.infoTitle2.fontSize=this.infoTitle2.baseFontSize*t,this.infoTitle2.wordWrapWidth=720*t,this.levelText2.fontSize=this.levelText.fontSize=this.levelText.baseFontSize*t,this.infoText2.x=this.infoText.x=this.game.width/2,this.infoText.fontSize=this.infoText.baseFontSize*t,this.infoText.wordWrapWidth=600*t,this.infoText2.fontSize=this.infoText2.baseFontSize*t,this.infoText2.wordWrapWidth=600*t,this.infoAction.x=this.game.width/2,this.infoAction.fontSize=this.infoAction.baseFontSize*t,this.infoAction.wordWrapWidth=720*t,this.setTextY())},PopupGroup.prototype.enable=function(t){if(this.dim||(this.dim=makeSprite(this.game,"popup-dim.png"),this.game.world.add(this.dim),this.dim.alpha=.5,this.dim.kill()),this.dimLeft||(this.dimLeft=makeSprite(this.game,"popup-dim.png"),this.dimLeft.tint=1578770,this.game.world.add(this.dimLeft),this.dimLeft.alpha=1,this.dimLeft.kill()),this.dimRight||(this.dimRight=makeSprite(this.game,"popup-dim.png"),this.dimRight.tint=1578770,this.game.world.add(this.dimRight),this.dimRight.alpha=1,this.dimRight.kill()),"popup-kid.png"===t){(l=this.banner=this.addSprite("popup-banner.png")).scale.set(.5);var e={fill:"#000000",align:"center",fontWeight:"normal",font:dataStorage.fontContent};(d=this.bannerText=this.game.add.text(0,0,"",e)).kill(),d.anchor.set(.5),d.wordWrap=!0,d.wordWrapWidth=500,d.fontSize=32,this.banner.addChild(d)}if("popup-banner.png"===t||"popup-gauge.png"===t){l=this.banner=this.addSprite("popup-banner.png"),(l=this.quack=this.addSpriteFromFile("quack.png")).scale.set(.375),this.quackSad=l;e={fill:"#000000",align:"center",fontWeight:"normal",font:dataStorage.fontContent};if((d=this.bannerText=this.game.add.text(0,0,"",e)).kill(),d.anchor.set(.5),d.wordWrap=!0,d.wordWrapWidth=500,d.fontSize=32,this.banner.addChild(d),"popup-gauge.png"===t){var i=this.gaugeBg=makeSprite(this.game,"popup-gauge.png",0,16);i.anchor.set(.5),this.banner.addChild(i);var s=2*dataStorage.scoreMax,a=this.game.make.bitmapData(5*s,32);a.smoothed=!1,a.clear();var o,h=a.ctx.createLinearGradient(0,0,a.width,a.height);h.addColorStop(0,"#00ff00"),h.addColorStop(.5,"#ffff00"),h.addColorStop(1,"#ff0000"),a.ctx.fillStyle=h,a.ctx.fillRect(0,0,5*s,32),this.game.cache.removeBitmapData("bmd-gauge"),this.game.cache.addBitmapData("bmd-gauge",a),(o=this.gauge=this.game.make.sprite(0,0,this.game.cache.getBitmapData("bmd-gauge"))).anchor.set(.5),o.loadTexture(this.game.cache.getBitmapData("bmd-gauge")),this.gaugeBg.addChild(o);var r=5*-s/2;dataStorage.score<15?r+=7.5*dataStorage.score:dataStorage.score<30?(r+=112.5,r+=5*(dataStorage.score-15)):(r+=112.5,r+=75,r+=2.5*(dataStorage.score-30));var n=this.gaugePointer=this.game.make.sprite(r,0,"atlas","popup-gauge-pointer.png");n.anchor.set(.5),o.addChild(n),i.kill()}}if("popup-dialog.png"===t||"popup-dialog-quit.png"===t||"popup-dialog-upgrade.png"===t){var l;(l=this.dialogBg=this.addSprite("popup-dialog-bg.png")).inputEnabled=!0,l.input.useHandCursor=!1;e={fill:"#333",align:"left",fontWeight:"bold",font:dataStorage.fontHeader};(d=this.dialogTitle=this.game.add.text(0,-200,dataStorage.title,e)).baseFontSize=40,d.fontSize=40,bootState.app&&(d.baseFontSize=64,d.fontSize=64),d.kill(),d.anchor.set(.5,.5),d.wordWrap=!0,d.wordWrapWidth=720,this.dialogBg.addChild(d),e={fill:"#666",align:"left",fontWeight:"normal",font:dataStorage.fontContent},(d=this.dialogText=this.game.add.text(0,0,"",e)).kill(),d.fontSize=32,d.anchor.set(.5,.5),d.wordWrap=!0,d.wordWrapWidth=500,this.dialogBg.addChild(d),(d=this.dialogTip=this.game.add.text(0,0,"",e)).kill(),d.fontSize=32,d.anchor.set(.5),d.wordWrap=!0,d.wordWrapWidth=500,this.textGroup.add(d),this.play=makeSprite(this.game,"main-level1.png"),this.play.inputEnabled=!0,this.play.input.useHandCursor=!0,this.play.input.priorityID=1,this.play.anchor.set(.5),this.dialogBg.addChild(this.play),bootState.app&&(this.skip=makeSprite(this.game,"main-level1.png"),this.skip.inputEnabled=!0,this.skip.input.useHandCursor=!0,this.skip.input.priorityID=1,this.skip.anchor.set(.5),this.dialogBg.addChild(this.skip),this.skip.tint=10040217,e={fill:"#ffffff",align:"left",fontWeight:"normal",font:dataStorage.fontContent},(d=this.game.add.text(0,0,"Skip",e)).setShadow(3,3,"rgba(0,0,0,0.5)",5),d.fontSize=36,d.anchor.set(.5,.5),this.skip.addChild(d)),e={fill:"#ffffff",align:"left",fontWeight:"normal",font:dataStorage.fontContent},(d=this.playText=this.game.add.text(0,0,"",e)).setShadow(3,3,"rgba(0,0,0,0.5)",5),d.fontSize=36,d.anchor.set(.5,.5),this.play.addChild(d),"popup-dialog-quit.png"===t&&(this.quit=this.play),this.close=makeSprite(this.game,"popup-dialog-close.png"),this.close.inputEnabled=!0,this.close.input.useHandCursor=!0,this.close.input.priorityID=1,this.close.x=180,this.close.y=-250,"popup-dialog-upgrade.png"===t&&this.close.kill(),this.close.kill(),l.addChild(this.close),"popup-dialog-upgrade.png"===t&&(this.upgradesSteps=[],this.upgradesSteps[0]=[],this.upgradeTurning=this.addUpgrade(0,upgradeTurning,l,"Agility"),this.upgradesSteps[1]=[],this.upgradeSpeed=this.addUpgrade(1,upgradeSpeed,l,"Speed"),this.upgradesSteps[2]=[],this.upgradeAgility=this.addUpgrade(2,upgradeAgility,l,"Wiggle"),this.upgradesSteps[3]=[],this.upgradeLives=this.addUpgrade(3,upgradeLives,l,"Bite"))}if("info"===t){var d;e={fill:"#"+Color.blue,align:"center",font:dataStorage.fontHeader};(d=this.infoTitle=this.game.add.text(0,0,"",e)).kill(),d.fontSize=d.baseFontSize=24,d.anchor.set(.5,0),d.wordWrap=!0,d.wordWrapWidth=400,this.textGroup.add(d),(d=this.infoTitle2=this.game.add.text(0,0,"",e)).kill(),d.fontSize=d.baseFontSize=24,d.anchor.set(.5,0),d.wordWrap=!0,d.wordWrapWidth=400,this.textGroup.add(d),e={fill:"#"+Color.white,align:"center",font:dataStorage.fontHeader},(d=this.levelText=this.game.add.text(0,0,"",e)).kill(),d.fontSize=d.baseFontSize=24,d.anchor.set(.5,0),d.wordWrap=!0,this.textGroup.add(d),(d=this.levelText2=this.game.add.text(0,0,"",e)).kill(),d.fontSize=d.baseFontSize=24,d.anchor.set(.5,0),d.wordWrap=!0,this.textGroup.add(d),e={fill:"#"+Color.lightGray,align:"center",font:dataStorage.fontHeader},(d=this.infoText=this.game.add.text(0,0,"",e)).kill(),d.fontSize=d.baseFontSize=24,d.anchor.set(.5,0),d.wordWrap=!1,this.textGroup.add(d),(d=this.infoText2=this.game.add.text(0,0,"",e)).kill(),d.fontSize=d.baseFontSize=24,d.anchor.set(.5,0),d.wordWrap=!1,this.textGroup.add(d),e={fill:"#"+Color.lightGray,align:"center",fontWeight:"normal",font:dataStorage.fontHeader},(d=this.infoAction=this.game.add.text(0,0,"",e)).kill(),d.fontSize=d.baseFontSize=24,d.anchor.set(.5,0),d.wordWrap=!1,this.textGroup.add(d),this.infoSprite=this.addSpriteFromFile("quack.png",0,-.2),this.infoSprite.kill(),this.infoSprite.anchor.set(.5,0),this.add(this.infoSprite)}},PopupGroup.prototype.addUpgrade=function(t,e,i,s){var a,o={fill:"#666",align:"left",fontWeight:"normal",font:dataStorage.fontContent},h=this.game.make.text(0,123*t-173,s,o);for(h.anchor.set(.5,.5),h.wordWrap=!1,h.fontSize=32,i.addChild(h),a=0;a<7;a++){var r=makeSprite(this.game,"main-upgrade-step.png");r.anchor.set(.5),r.x=(a-3.5)*r.width,r.y=123*t-125,a<e&&(r.tint=a<=1?16776960:a<=3?16744448:16711680),this.upgradesSteps[t][a]=r,i.addChild(r)}this.upgradesSteps[t][a]=h;var n=makeSprite(this.game,"main-upgrade-plus.png");return n.anchor.set(.5),e<7?(n.inputEnabled=!0,n.input.useHandCursor=!0,n.input.priorityID=1):n.alpha=.5,n.x=(a-3)*r.width,n.y=123*t-125,i.addChild(n),this.upgradesSteps[t][a+1]=n,n},PopupGroup.prototype.enableGauge=function(t,e,i){this.gaugeEnabled=t},PopupGroup.prototype.gaugeX=function(){var t=dataStorage.score,e=dataStorage.scoreMax;t=45,t++;var i=5*e*2,s=Math.log(1)/Math.log(10),a=Math.log(e)/Math.log(10)-s,o=(Math.log(t)/Math.log(10)-s)/a*i;return o-=5*e,alert(o),o},PopupGroup.prototype.showBanner=function(t,e,i,s,a){if(this.hideTimeout)this.hide();else{var o;this.visible=!0,this.textGroup.visible=!0,this.shade&&this.shade.revive(),this.dim.tint=1578770,this.dim.revive(),this.bannerText.revive(),this.quack.kill(),this.quackSad.kill(),o=s?this.quackSad:this.quack,this.banner.revive(),this.game.world.bringToTop(this),this.game.world.bringToTop(this.textGroup),this.hideCallback=i,this.bannerText.text=t,o.y=-this.banner.height/2-.9*this.banner.height,this.gaugeBg&&(this.gaugeEnabled?this.gaugeBg.revive():this.gaugeBg.kill());var h=this.game.height,r=(this.scale.y,this.banner.height,h/2/this.scale.y);this.infoSprite&&this.infoSprite.kill(),this.banner.y=r,this.banner.scale.x=0,this.game.add.tween(this.banner.scale).to({x:1},250,Phaser.Easing.Back.Out,!0),e&&(this.hideTimeout=this.game.time.events.add(e,function(){this.hideBanner()},this)),this.game.physics&&this.game.physics.arcade}},PopupGroup.prototype.hideBanner=function(){this.hideTimeout&&this.game.time.events.remove(this.hideTimeout),this.hideTimeout=null;var t,e=this.game.height;t=this.quack.visible?this.quack:this.quackSad;Phaser.Easing.Quadratic.In,this.scale.y,this.banner.height;var i=e/this.scale.y+this.banner.height+t.height/2;this.game.add.tween(this.banner.scale).to({x:0},200,Phaser.Easing.Quadratic.In,!0).onComplete.addOnce(function(){this.visible=!1,this.textGroup.visible=!1,this.shade&&this.shade.kill(),this.dim.kill(),this.bannerText.kill(),this.banner.kill(),this.hideCallback&&this.hideCallback.popupHidden.call(this.hideCallback)},this);this.scale.y;this.game.physics&&this.game.physics.arcade},PopupGroup.prototype.showDialog=function(t,e,i,s,a,o,h,r){if(this.visible||this.hideTimeout)this.hide();else{if(this.dim.tint=1578770,this.visible=!0,this.textGroup.visible=!0,this.claim&&this.claim.kill(),o?(this.achievementIcon&&this.achievementIcon.revive(),h&&(this.claim&&this.claim.revive(),this.play.kill())):(bootState.app,this.dialogTitle.text=dataStorage.title,this.achievementIcon&&this.achievementIcon.kill()),this.upgradesSteps)for(var n=0;n<this.upgradesSteps.length;n++)for(var l=0;l<this.upgradesSteps[n].length;l++)o?this.upgradesSteps[n][l].revive():this.upgradesSteps[n][l].kill();this.dim.revive(),this.game.world.bringToTop(this),this.game.world.bringToTop(this.textGroup),this.quit&&(a?this.quit.revive():this.quit.kill()),r?(this.dialogTitle.text=dataStorage.title,this.playText.text=r):(this.dialogTitle.text=dataStorage.title,this.playText.text="Continue"),bootState.app&&(this.dialogTitle.text="Out of Guesses"),this.dialogBg.revive(),this.dialogText.text=t,this.dialogText.revive(),this.dialogTitle.revive(),e&&(this.dialogTip.text=e,this.dialogTip.revive()),this.hideCallback=i;var d=this.game.width/this.scale.x,p=this.game.height/this.scale.y,c=this.dialogBg.width,u=d/2;c=u,this.dialogBg.x=c,this.dialogBg.y=p/2,"ACHIEVEMENT"!==e?(this.play.y=200,this.skip&&(this.play.x=100,this.skip.x=-150,this.skip.y=200)):this.play.y=0;var g=600;s||(g=1),this.dialogBg.scale.x=1,this.dialogBg.scale.y=0,g=250,this.game.add.tween(this.dialogBg.scale).to({x:1,y:1},g,Phaser.Easing.Back.Out,!0),this.dialogBg.x=u,this.game.physics&&this.game.physics.arcade&&(this.game.physics.arcade.isPaused=!0,this.pausedTime=this.game.time.time),this.infoSprite&&this.infoSprite.kill(),this.infoAction&&this.infoAction.kill()}},PopupGroup.prototype.hideDialog=function(){this.hideTimeout&&this.game.time.events.remove(this.hideTimeout),this.hideTimeout=null;this.dialogBg.width;this.game.add.tween(this.dialogBg.scale).to({x:1,y:0},200,Phaser.Easing.Quadratic.In,!0).onComplete.addOnce(function(){this.visible=!1,this.textGroup.visible=!1,this.dim.kill(),this.dialogBg.kill(),this.dialogTitle.kill(),this.dialogText.kill(),this.dialogTip.kill(),this.achievementIcon&&this.achievementIcon.kill()},this),this.hideCallback&&this.hideCallback.popupHidden.call(this.hideCallback),this.game.physics&&this.game.physics.arcade},PopupGroup.prototype.hide=function(){this.banner&&this.banner.visible?this.hideBanner():this.dialogBg&&this.dialogBg.visible&&this.hideDialog(),this.infoTitle&&this.infoTitle.visible&&this.hideInfo()},PopupGroup.prototype.showInfo=function(t,e,i,s,a,o,h,r,n){if(this.visible||this.hideTimeout)this.hide();else{this.visible=!0,this.textGroup.visible=!0,this.dimRight.tint=0,this.dimLeft.tint=0,this.hideState=o,this.hideCallback=h,this.infoTitle.text=t,this.infoTitle2.text=t,this.levelText.text=e,this.levelText2.text=e,this.infoText.text=i,this.infoText2.text=i,this.infoAction.text=s,this.dimLeft.width=this.game.width,this.dimLeft.height=this.game.height,this.dimLeft.x=0,this.dimLeft.y=0,this.dimLeft.revive(),this.dimLeft.bringToTop(),this.dimRight.width=this.game.width,this.dimRight.height=this.game.height,this.dimRight.x=0,this.dimRight.y=0,this.dimRight.revive(),this.dimRight.bringToTop(),this.game.world.bringToTop(this),this.game.world.bringToTop(this.textGroup),this.infoEnter=r;this.scale.x;n?this.infoSprite.loadTexture(n):n="quack.png";this.game.width,this.game.height;var l,d=300/this.infoSprite.height,p=300/this.infoSprite.width;l=d>p?d:p,this.infoSprite.scale.set(l),"snakebite.png"===n&&(this.infoSprite.angle=90),this.setTextY(),r?(this.infoTitle2.alpha=this.infoTitle.alpha=.5,this.infoText.alpha=this.infoText2.alpha=.5,this.dimLeft.x=-this.dimLeft.width,this.dimRight.x=this.game.width,this.infoTitle2.x=3*this.game.width/2,this.infoTitle.x=-this.game.width/2,this.infoText2.x=3*this.game.width/2,this.infoText.x=-this.game.width/2,this.levelText2.x=3*this.game.width/2,this.levelText.x=-this.game.width/2,this.infoTitle.revive(),this.infoTitle2.revive(),this.infoText.revive(),this.infoText2.revive(),this.levelText.revive(),this.levelText2.revive(),this.game.add.tween(this.dimLeft).to({x:0},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.dimRight).to({x:0},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoTitle).to({x:this.game.width/2},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoTitle2).to({x:this.game.width/2},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.levelText).to({x:this.game.width/2},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.levelText2).to({x:this.game.width/2},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoText).to({x:this.game.width/2},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoText2).to({x:this.game.width/2},400,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.infoTitle.alpha=1,this.infoTitle2.alpha=1,this.infoText.alpha=1,this.infoText2.alpha=1},this)):(this.infoTitle.alpha=0,this.infoTitle.revive(),this.game.add.tween(this.infoTitle).to({alpha:1},400,Phaser.Easing.Linear.None,!0),this.infoText.alpha=0,this.infoText.revive(),this.levelText.revive(),this.game.add.tween(this.infoText).to({alpha:1},400,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.infoTitle2.revive(),this.infoText2.revive(),this.levelText2.revive()},this)),a&&(this.hideTimeout=this.game.time.events.add(a,function(){this.hideInfo()},this)),this.game.physics&&this.game.physics.arcade}},PopupGroup.prototype.hideInfo=function(){this.hideTimeout&&this.game.time.events.remove(this.hideTimeout),this.hideTimeout=null,this.infoTitle2.alpha=this.infoTitle.alpha=.5,this.infoText.alpha=this.infoText2.alpha=.5,this.levelText.alpha=this.levelText2.alpha=.5,this.infoAction.alpha=.5;this.infoEnter?this.hideCallback.call(this.hideState):(this.game.add.tween(this.dimLeft).to({x:-this.dimLeft.width},600,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.dimRight).to({x:this.game.width},600,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoTitle).to({x:-this.game.width/2},600,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoTitle2).to({x:3*this.game.width/2},600,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.levelText).to({x:-this.game.width/2},600,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.levelText2).to({x:3*this.game.width/2},600,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoText).to({x:-this.game.width/2},600,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoText2).to({x:3*this.game.width/2},600,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.visible=!1,this.textGroup.visible=!1,this.dimLeft.kill(),this.dimRight.kill(),this.infoTitle.kill(),this.infoTitle2.kill(),this.levelText.kill(),this.levelText2.kill(),this.infoText.kill(),this.infoText2.kill()},this),this.infoAction.kill(),this.infoSprite.kill(),this.hideCallback&&(dataStorage.isAudio,this.hideCallback.call(this.hideState)),this.game.physics&&this.game.physics.arcade)},PopupGroup.prototype.getCenterX=function(t){return this.x+t.dx*this.size.width*this.scale.x},PopupGroup.prototype.getCenterY=function(t){return this.y+t.dy*this.size.height*this.scale.y},PopupGroup.prototype.hideTech=function(){this.hideTimeout&&this.game.time.events.remove(this.hideTimeout),this.hideTimeout=null,this.infoTitle2.alpha=this.infoTitle.alpha=.5,this.infoText.alpha=this.infoText2.alpha=.5,this.levelText.alpha=this.levelText2.alpha=.5,this.infoAction.alpha=.5;this.infoEnter,this.game.add.tween(this.dimLeft).to({x:-this.dimLeft.width},500,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.dimRight).to({x:this.game.width},500,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoTitle).to({x:-this.game.width/2},500,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoTitle2).to({x:3*this.game.width/2},500,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.levelText).to({x:-this.game.width/2},500,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.levelText2).to({x:3*this.game.width/2},500,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoText).to({x:-this.game.width/2},500,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoText2).to({x:3*this.game.width/2},500,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.visible=!1,this.textGroup.visible=!1,this.dimLeft.kill(),this.dimRight.kill(),this.infoTitle.kill(),this.infoTitle2.kill(),this.levelText.kill(),this.levelText2.kill(),this.infoText.kill(),this.infoText2.kill()},this),this.infoAction.kill(),this.infoSprite.kill(),this.hideCallback&&dataStorage.isAudio,this.game.physics&&this.game.physics.arcade},PopupGroup.prototype.setTextY=function(t){var e,i=this.scale.y,s=this.infoSprite;s.y=64,s.x=this.game.width/2/i,this.infoSprite.kill(),e=t?400:0,this.game.time.events.add(e,function(){this.infoSprite.revive()},this),this.infoAction.alpha=0,this.infoAction.revive(),this.game.add.tween(this.infoAction).to({alpha:1},e,Phaser.Easing.Linear.None,!0,750),this.infoTitle2.y=this.infoTitle.y=(this.infoSprite.y+this.infoSprite.height+this.infoTitle.height)*i,this.levelText2.y=this.levelText.y=this.infoTitle.y+(this.infoTitle.height+32)*i,this.infoText2.y=this.infoText.y=this.levelText.y+(this.levelText.height+32)*i,this.infoAction.y=this.infoText.y+(this.infoText.height+32)*i},PopupGroup.prototype.showTech=function(t,e,i,s,a,o,h,r,n){if(this.visible||this.hideTimeout)this.hide();else{this.visible=!0,this.textGroup.visible=!0,this.hideState=o,this.hideCallback=h,this.infoTitle.text=t,this.infoTitle2.text=t,this.levelText.text=e,this.levelText2.text=e,this.infoText.text=i,this.infoText2.text=i,this.infoAction.text=s,this.dimLeft.width=this.game.width,this.dimLeft.height=this.game.height,this.dimLeft.x=0,this.dimLeft.y=0,this.dimLeft.revive(),this.dimLeft.bringToTop(),this.dimRight.width=this.game.width,this.dimRight.height=this.game.height,this.dimRight.x=0,this.dimRight.y=0,this.dimRight.revive(),this.dimRight.bringToTop(),this.game.world.bringToTop(this),this.game.world.bringToTop(this.textGroup),this.infoEnter=r;this.scale.x;n?(this.game.cache.checkImageKey(n)?(this.infoSprite.loadTexture(n),this.infoSprite.x=this.game.width/2/this.scale.x,this.infoSprite.kill(),this.game.time.events.add(350,function(){this.infoSprite.revive()},this)):(this.game.load.image(n,n),this.game.load.onFileComplete.add(this.onLoadImage,this),this.game.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.game.load.start()),this.infoSprite.kill()):(n="quack.png",this.infoSprite.revive()),this.setTextY(!0),r?(this.infoTitle2.alpha=this.infoTitle.alpha=.5,this.infoText.alpha=this.infoText2.alpha=.5,this.dimLeft.x=-this.dimLeft.width,this.dimRight.x=this.game.width,this.infoTitle2.x=3*this.game.width/2,this.infoTitle.x=-this.game.width/2,this.infoText2.x=3*this.game.width/2,this.infoText.x=-this.game.width/2,this.levelText2.x=3*this.game.width/2,this.levelText.x=-this.game.width/2,this.infoTitle.revive(),this.infoTitle2.revive(),this.infoText.revive(),this.infoText2.revive(),this.levelText.revive(),this.levelText2.revive(),this.game.add.tween(this.dimLeft).to({x:0},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.dimRight).to({x:0},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoTitle).to({x:this.game.width/2},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoTitle2).to({x:this.game.width/2},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.levelText).to({x:this.game.width/2},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.levelText2).to({x:this.game.width/2},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoText).to({x:this.game.width/2},400,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.infoText2).to({x:this.game.width/2},400,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.infoTitle.alpha=1,this.infoTitle2.alpha=1,this.infoText.alpha=1,this.infoText2.alpha=1},this)):(this.infoTitle.alpha=0,this.infoTitle.revive(),this.game.add.tween(this.infoTitle).to({alpha:1},400,Phaser.Easing.Linear.None,!0),this.infoText.alpha=0,this.infoText.revive(),this.levelText.revive(),this.game.add.tween(this.infoText).to({alpha:1},400,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.infoTitle2.revive(),this.infoText2.revive(),this.levelText2.revive()},this)),a&&(this.hideTimeout=this.game.time.events.add(a,function(){this.hideInfo()},this)),this.game.physics&&this.game.physics.arcade}},PopupGroup.prototype.onLoadImage=function(t,e,i,s,a){console.log("onLoadImage"),i&&(this.loadName=e)},PopupGroup.prototype.onLoadComplete=function(){console.log("onLoadComplete"),this.loadName&&(this.infoSprite.loadTexture(this.loadName),this.infoSprite.x=this.game.width/2/this.scale.x,this.infoSprite.kill(),this.game.time.events.add(350,function(){this.infoSprite.revive()},this))},TutorialGroup=function(t,e){this.size=e,Phaser.Group.call(this,t),this.textGroup=this.game.add.group(),this.visible=!1,this.textGroup.visible=!1},TutorialGroup.prototype=Object.create(Phaser.Group.prototype),TutorialGroup.prototype.constructor=TutorialGroup,TutorialGroup.prototype.addText=function(t,e,i,s,a){return addText.call(this,t,e,i,s,a)},TutorialGroup.prototype.addSpriteFromFile=function(t,e,i){return addSpriteFromFile.call(this,t,e,i)},TutorialGroup.prototype.addSprite=function(t,e,i){return addSprite.call(this,t,e,i,"atlas")},TutorialGroup.prototype.resize=function(t,e,i,s,a){this.width=s,this.height=a,this.scale.set(t),this.dim&&(this.dim.width=s,this.dim.height=a/4),this.targetSprite&&this.handPosition(),this.handText&&(this.handText.fontSize=24*this.scale.x,this.handText.wordWrapWidth=720*this.scale.x)},TutorialGroup.prototype.enable=function(t){this.dim||(this.dim=makeSprite(this.game,"popup-dim.png"),this.game.world.add(this.dim),this.dim.alpha=.75,this.dim.tint=0,this.dim.kill()),this.hand=this.addSprite("popup-hand.png",0,0);var e={fill:"#ffffff",align:"center",font:dataStorage.fontContent},i=this.handText=this.game.add.text(0,0,"",e);i.anchor.set(.5),i.y=this.handText.height/2,i.wordWrap=!0,this.textGroup.add(i)},TutorialGroup.prototype.handPosition=function(){this.game.world.bringToTop(this),this.handText.x=this.game.width/2,this.handText.y=this.handText.height/2,this.handText.fontSize=28*this.scale.x,this.handText.wordWrapWidth=720*this.scale.x;var t=this.targetSprite,e=this.targetGroup;this.hand.x=e.getCenterX(t)-this.hand.width/2*this.scale.x,this.hand.y=e.getCenterY(t),this.hand.x/=this.scale.x,this.hand.y/=this.scale.y},TutorialGroup.prototype.pointHand=function(t,e,i){this.visible=!0,this.hand.revive(),this.targetSprite=t,this.targetGroup=e,this.handPosition(),this.game.time.events.add(i,function(){this.hide()},this)},TutorialGroup.prototype.showHand=function(t,e,i){this.visible=!0,this.textGroup.visible=!0,this.step=1,this.dim.revive(),this.hand.revive(),this.targetSprite=e,this.targetGroup=i,this.handPosition(),this.handText.text=t,this.handText.wordWrapWidth=720*this.scale.x,this.handText.y=this.handText.height/2,this.game.world.bringToTop(this.textGroup),this.handText.bringToTop(),this.game.physics&&this.game.physics.arcade&&(this.game.physics.arcade.isPaused=!0)},TutorialGroup.prototype.hideHand=function(){this.hideTimeout&&this.game.time.events.remove(this.hideTimeout),this.visible=!1,this.textGroup.visible=!1,this.dim.kill(),this.game.physics&&this.game.physics.arcade&&(this.game.physics.arcade.isPaused=!1)},TutorialGroup.prototype.hide=function(){this.hideHand()},TutorialGroup.prototype.nextStep=function(t,e,i){var s,a;(this.step++,this.handText.text=t,void 0!==e)&&(s=i.getCenterX(e)-this.hand.width/2*this.scale.x,a=i.getCenterY(e),s/=this.scale.x,a/=this.scale.y,this.targetSprite=e,this.targetGroup=i,this.game.add.tween(this.hand).to({x:s,y:a},750,Phaser.Easing.Back.InOut,!0).onComplete.add(function(){},this))},TutorialGroup.prototype.handTarget=function(){return this.targetSprite},AdGroup=function(t,e,i,s){Phaser.Group.call(this,t),this.landSize=e,this.portSize=i,this.main=s,this.size=t.width>t.height?this.landSize:this.portSize,this.textGroup=this.game.add.group(),this.spriteAtlas="atlas"},AdGroup.prototype=Object.create(Phaser.Group.prototype),AdGroup.prototype.constructor=AdGroup,AdGroup.prototype.addText=function(t,e,i,s,a){return addText.call(this,t,e,i,s,a)},AdGroup.prototype.addSpriteFromFile=function(t,e,i){return addSpriteFromFile.call(this,t,e,i)},AdGroup.prototype.addSprite=function(t,e,i){return addSprite.call(this,t,e,i,"atlas")},AdGroup.prototype.resize=function(t,e,i,s,a){t<.5&&(t=.5),this.scale.set(t);var o=this.exit.width,h=this.exit.height,r=10*t;this.exit.x=o/2+r,this.exit.y=h/2+r,this.optionBg.x=this.exit.x,this.optionBg.y=this.exit.y},AdGroup.prototype.enable=function(t){this.exit=this.addSprite("ad-quack.png",0,0),this.exit.inputEnabled=!0,this.exit.input.useHandCursor=!0,this.optionBg=this.addSprite("header-option-bg.png",0,0),this.optionBg.kill(),this.optionQuack=this.addSprite("main-check.png",0,0),this.optionQuack.inputEnabled=!0,this.optionQuack.input.useHandCursor=!0,this.optionQuack.x=42,this.optionQuack.y=150,this.optionBg.addChild(this.optionQuack);var e={fill:"#000000",font:dataStorage.fontHeader};(i=this.scoreLabel=this.game.add.text(0,0,dataStorage.title,e)).anchor.set(0,.5),i.x=50,i.setShadow(3,3,"rgba(255,255,255,1)",5),i.fontSize=24,this.exit.addChild(i),this.optionWebGames=this.addSprite("main-check.png",0,0),this.optionWebGames.inputEnabled=!0,this.optionWebGames.input.useHandCursor=!0,this.optionWebGames.x=150,this.optionWebGames.y=40,this.optionBg.addChild(this.optionWebGames);var i;e={fill:"#000000",font:dataStorage.fontHeader};(i=this.scoreLabel=this.game.add.text(0,0,dataStorage.title,e)).anchor.set(0,.5),i.x=70,i.setShadow(3,3,"rgba(255,255,255,1)",5),i.fontSize=48,this.optionWebGames.addChild(i)},AdGroup.prototype.showOption=function(){this.game.world.bringToTop(this),this.optionBg.scale.set(0),this.optionBg.revive();this.game.add.tween(this.optionBg.scale).to({x:1,y:1},500,Phaser.Easing.Back.InOut,!0),this.game.physics&&this.game.physics.arcade&&(this.game.physics.arcade.isPaused=!0)},AdGroup.prototype.hideOption=function(){this.game.add.tween(this.optionBg.scale).to({x:0,y:0},500,Phaser.Easing.Back.InOut,!0).onComplete.addOnce(function(){this.optionBg.kill()},this)},BgGroup=function(t){Phaser.Group.call(this,t),this.textGroup=this.game.add.group(),this.spriteAtlas="atlas",this.size={width:t.width,height:t.height}},BgGroup.prototype=Object.create(Phaser.Group.prototype),BgGroup.prototype.constructor=BgGroup,BgGroup.prototype.addText=function(t,e,i,s,a,o){return addText.call(this,t,e,i,s,a,o)},BgGroup.prototype.addSpriteFromFile=function(t,e,i){return addSpriteFromFile.call(this,t,e,i)},BgGroup.prototype.addSprite=function(t,e,i){return addSprite.call(this,t,e,i,this.spriteAtlas)},BgGroup.prototype.setTexture=function(t,e){dataStorage.debug?t.loadTexture(e):t.frameName=e},BgGroup.prototype.resize=function(t,e,i,s,a){this.scale.set(t),this.size.width=s,this.size.height=a;var o=s,h=a;this.children.forEach(function(e){"cache/atlas/bg-top.png"===e.frameName?(e.x=s/2/t,e.y=e.height/2,e.width=Math.floor(s/t),this.topY=e.height):"cache/atlas/bg-top-below.png"===e.frameName?(e.x=s/2/t,e.y=this.topY+e.height/2):"cache/atlas/bg-grass.png"===e.frameName?(e.x=s/2/t,e.y=h*t-e.height,e.width=Math.floor(s/t),this.bottomY=e.height):"cache/atlas/bg-bottom-above.png"===e.frameName?(e.x=s/2/t,e.y=h/t-this.bottomY-e.height/2):(1===e.dx?e.x=o*e.dx/t-e.width/2:e.x=o/2/t,1!==e.dy?e.y=h*e.dy/t:e.y=h/t-e.height/2)},this)},BoardGroup=function(t,e,i,s){Phaser.Group.call(this,t),this.landSize=e,this.portSize=i,this.size=t.width>t.height?this.landSize:this.portSize,this.textGroup=this.game.add.group(),this.spriteAtlas="atlas",s&&(this.scrollX=!0),this.platformGroup=this.game.add.group(),this.foeGroup=this.game.add.group()},BoardGroup.prototype=Object.create(Phaser.Group.prototype),BoardGroup.prototype.constructor=BoardGroup,BoardGroup.prototype.addText=function(t,e,i,s,a,o){return addText.call(this,t,e,i,s,a,o)},BoardGroup.prototype.addSpriteFromFile=function(t,e,i){return addSpriteFromFile.call(this,t,e,i)},BoardGroup.prototype.addSprite=function(t,e,i,s){var a=this;return s&&(a=this.textGroup),addSprite.call(this,t,e,i,this.spriteAtlas,a)},BoardGroup.prototype.addSpriteNextTo=function(t,e){var i=addSprite.call(this,t,0,0,this.spriteAtlas,this);return i.x=e.x+e.width,i.y=e.y,i},BoardGroup.prototype.addFoe=function(t,e,i){return addSprite.call(this,t,e,i,this.spriteAtlas,this.foeGroup)},BoardGroup.prototype.addPlatform=function(t,e,i){return addSprite.call(this,t,e,i,this.spriteAtlas,this.platformGroup)},BoardGroup.prototype.addBitmap=function(t,e,i){var s;return s=this.create(0,0,t),void 0===e&&(s.kill(),e=i=0),s.anchor.set(.5),s.dx=.5+e,s.dy=.5+i,s.x=s.dx*this.size.width,s.y=s.dy*this.size.height,s},BoardGroup.prototype.setTexture=function(t,e){dataStorage.debug?t.loadTexture(e):t.frameName=e},BoardGroup.prototype.resize=function(t,e,i,s,a){this.scale.set(t),this.foeGroup.scale.set(t),this.platformGroup.scale.set(t),this.offsetX=e,this.offsetY=i;var o=this.size.width,h=this.size.height;if(this.textGroup.x=this.x=this.foeGroup.x=this.platformGroup.x=(s-o*t)/2+e,this.textGroup.y=this.y=this.foeGroup.y=this.platformGroup.y=(a-h*t)/2+i,this.children.forEach(function(t){t.x=t.dx*o,t.y=t.dy*h,t.isBookmark&&(this.size===this.landSize?t.angle=0:(t.angle=90,t.y=t.dx*o,t.x=t.dy*h))},this),this.foeGroup.children.forEach(function(t){t.x=t.dx*o,t.y=t.dy*h},this),this.textGroup.forEach(function(e){var i=t;e.x=e.dx*o*i,e.y=e.dy*h*i,e.fontSize=Math.floor(e.size*i)+"px"},this),this.scrollX){var r=this.scrollSprites=[],n=this.game.width/t;n+=450*playState.level.length;var l=Math.floor(n/(this.size.width/10))+1,d=0,p=1,c=this.addPlatform("play-block-"+p+".png",0,.2);p=1===p?5:1,this.game.physics.arcade.enable(c),c.body.immovable=!0,c.body.allowGravity=!1,c.x=-this.x/t;for(var u=c.width;d<l;d++){var g=this.addPlatform("play-block-"+p+".png",0,.2);p=1===p?5:1,g.x=c.x+u,c=g,this.game.physics.arcade.enable(c),c.body.immovable=!0,c.body.allowGravity=!1,r.push(c)}}this.worldX=this.x+this.size.width/2*t,this.worldY=this.y+this.size.height/2*t},BoardGroup.prototype.getCenterX=function(t){return this.x+t.x},BoardGroup.prototype.getCenterY=function(t){return this.y+t.y},BoardGroup.prototype.move=function(t,e,i){t.dx=.5+e,t.dy=.5+i,t.x=t.dx*this.size.width,t.y=t.dy*this.size.height},BoardGroup.prototype.moveTo=function(t,e){t.dx=e.dx,t.dy=e.dy,t.x=t.dx*this.size.width,t.y=t.dy*this.size.height},BoardGroup.prototype.xy=function(t,e){return{x:t*this.size.width,y:e*this.size.height}},ControlGroup=function(t,e,i,s){Phaser.Group.call(this,t),this.landSize=e,this.portSize=i,this.smallScreen=s,this.size=t.width>t.height?this.landSize:this.portSize,this.textGroup=this.game.add.group(),this.spriteAtlas="atlas"},ControlGroup.prototype=Object.create(Phaser.Group.prototype),ControlGroup.prototype.constructor=ControlGroup,ControlGroup.prototype.addText=function(t,e,i,s,a,o){return addText.call(this,t,e,i,s,a,o)},ControlGroup.prototype.addSpriteFromFile=function(t,e,i){return addSpriteFromFile.call(this,t,e,i)},ControlGroup.prototype.addSprite=function(t,e,i,s,a){var o=addSprite.call(this,t,e,i,this.spriteAtlas);return o.portx=s,o.porty=a,o},ControlGroup.prototype.setTexture=function(t,e){dataStorage.debug?t.loadTexture(e):t.frameName=e},ControlGroup.prototype.resize=function(t,e,i,s,a){if(this.scale.set(t),this.size===this.landSize){this.exit&&this.exit.kill();var o=this.size.width,h=a/t;this.children.forEach(function(t){t.x=t.dx*o,t.y=t.dy*h},this)}else{this.exit&&this.exit.revive();o=720,h=this.size.height;this.children.forEach(function(t){t.x=t.dy*o,t.y=.5*h},this)}this.textGroup.x=this.x=(s-o*t)/2+e,this.textGroup.y=this.y=(a-h*t)/2+i,this.textGroup.forEach(function(e){e.x=e.dx*o*t,e.y=e.dy*h*t,e.fontSize=Math.floor(e.size*t)+"px"},this)},ControlGroup.prototype.move=function(t,e,i){t.dx=.5+e,t.dy=.5+i,t.x=t.dx*this.size.width,t.y=t.dy*this.size.height},ControlGroup.prototype.getCenterX=function(t){return this.x+t.x*this.scale.x},ControlGroup.prototype.getCenterY=function(t){return this.y+t.y*this.scale.y},HeaderGroup=function(t,e,i,s){Phaser.Group.call(this,t),this.landSize=e,this.portSize=i,this.state=s,this.size=t.width>t.height?this.landSize:this.portSize,this.textGroup=this.game.add.group(),this.fixedToCamera=!0,this.textGroup.fixedToCamera=!0},HeaderGroup.prototype=Object.create(Phaser.Group.prototype),HeaderGroup.prototype.constructor=HeaderGroup,HeaderGroup.prototype.addText=function(t,e,i,s,a){return addText.call(this,t,e,i,s,a)},HeaderGroup.prototype.addSprite=function(t,e,i){return addSprite.call(this,t,e,i,"atlas")},HeaderGroup.prototype.setTexture=function(t,e){dataStorage.debug?t.loadTexture(e):t.frameName=e},HeaderGroup.prototype.moveSprites=function(t,e,i){var s=this.health[0].width,a=this.health[0].height;if(this.size===this.landSize){e=e/this.scale.x-1.25*s,i=(i-2)/t;i+=360;for(var o=0;o<this.health.length;o++)this.health[o].x=e,this.health[o].y=i-4*a+o*a*7/6;this.exit.x=this.health[0].x,this.exit.y=this.health[0].y-1.5*a}else{e=(e-2)/t,i=i/this.scale.y-1.25*a,e+=720/t/2*t;for(o=0;o<this.health.length;o++)this.health[o].x=e-4*s+o*s*7/6,this.health[o].y=i;this.exit.x=this.health[0].x-1.25*s,this.exit.y=this.health[0].y}if(this.score){s=90,a=64,this.size===this.landSize?("header-score-port.png"!==this.score.frameName&&this.setTexture(this.score,"header-score-port.png"),e-=20,this.score.x=e,this.score.y=i,this.scoreLabel.x=0,this.scoreLabel.y=5,this.bg.x=e-20,this.bg.y=i,"header-score-port.png"!==this.score1.frameName&&this.setTexture(this.score1,"header-score-port.png"),this.score1.x=e,this.score1.y=this.score.y+4.75*a,this.score1Label.x=0,this.score1Label.y=5,"header-score-port.png"!==this.score2.frameName&&this.setTexture(this.score2,"header-score-port.png"),this.score2.x=e,this.score2.y=this.score.y+3.25*a,this.score2Label.x=0,this.score2Label.y=5,"header-score-port.png"!==this.score3.frameName&&this.setTexture(this.score3,"header-score-port.png"),this.score3.x=e,this.score3.y=this.score.y+1.75*a,this.score3Label.x=0,this.score3Label.y=5):("header-score-port.png"!==this.score.frameName&&this.setTexture(this.score,"header-score-port.png"),this.score.x=e,this.score.y=this.exit.y-10,this.scoreLabel.x=0,this.scoreLabel.y=5,"header-score-port.png"!==this.score1.frameName&&this.setTexture(this.score1,"header-score-port.png"),this.score1.x=this.score.x+2.5*this.score.width,this.score1.y=this.score.y,this.score1Label.x=0,this.score1Label.y=5,"header-score-port.png"!==this.score2.frameName&&this.setTexture(this.score2,"header-score-port.png"),this.score2.x=this.score.x+1.75*this.score.width,this.score2.y=this.score.y,this.score2Label.x=0,this.score2Label.y=5,"header-score-port.png"!==this.score3.frameName&&this.setTexture(this.score3,"header-score-port.png"),this.score3.x=this.score.x+this.score.width,this.score3.y=this.score.y,this.score3Label.x=0,this.score3Label.y=5),this.score.bringToTop(),this.score1.bringToTop(),this.score2.bringToTop(),this.score3.bringToTop(),this.scoreLabel.fontSize=Math.floor(82);this.score1Label.fontSize=Math.floor(28),this.score2Label.fontSize=Math.floor(28),this.score3Label.fontSize=Math.floor(28)}},HeaderGroup.prototype.resize=function(t,e,i,s,a){this.scaled=t,this.scale.set(t);var o=10*t;if(this.info){var h=this.info.width,r=this.info.height;this.size,this.landSize,this.info.x=s/t-h/2-o,this.info.y=r/2+o}if(playService.resize(o,o,t),this.health&&this.health.length){h=this.health[0].width,r=this.health[0].height;e=h/2+o;if(this.size===this.landSize)for(var n=0;n<this.health.length;n++)this.health[n].x=e,this.health[n].y=a/3/t+r+n*r*5/4;else for(n=0;n<this.health.length;n++)this.health[n].x=s/2/t-h+n*h*5/4,this.health[n].y=r/2+2*o}if(this.score&&(h=190,r=32,this.size===this.landSize?("header-score-port.png"!==this.score.frameName&&this.setTexture(this.score,"header-score-port.png"),this.score.x=0+this.score.width/2+o,this.score.y=a/t-this.score.height/2-o,this.scoreLabel.x=0,this.scoreLabel.y=5,this.scoreTime&&(this.scoreTime.frameName!=="header-"+this.scoreType+"-land.png"&&this.setTexture(this.scoreTime,"header-"+this.scoreType+"-land.png"),this.scoreTime.x=this.score.width/2+15*t,this.scoreTime.y=a/2/t+2*r*t,this.scoreTimeLabel.x=this.scoreTime.x*t,this.scoreTimeLabel.y=(this.scoreTime.y+27)*t)):("header-score-port.png"!==this.score.frameName&&this.setTexture(this.score,"header-score-port.png"),this.score.x=s/t-this.score.width/2-o,this.score.y=this.score.height/2+2*o,this.scoreLabel.x=0,this.scoreLabel.y=5,this.scoreTime&&(this.scoreTime.frameName!=="header-"+this.scoreType+"-port.png"&&this.setTexture(this.scoreTime,"header-"+this.scoreType+"-port.png"),this.scoreTime.x=s/2/t+h*t,this.scoreTime.y=r/2+o,this.scoreTimeLabel.x=(this.scoreTime.x+25)*t,this.scoreTimeLabel.y=(this.scoreTime.y+6)*t)),this.scoreLabel.fontSize=Math.floor(38),this.scoreTimeLabel&&(this.scoreTimeLabel.fontSize=Math.floor(38*t))),this.exit&&(this.exit.x=.5*this.exit.width,this.exit.y=.5*this.exit.height),this.appOption){o=.6;this.appOption.x=this.appOption.width/2,this.appOption.y=this.appOption.height/2,this.appInfo.x=this.game.width-this.appInfo.width/2,this.appInfo.y=this.appInfo.height/2}if(bootState.app&&this.optionBg){h=this.appOption.width,r=this.appOption.height;this.optionBg.x=this.appOption.x,this.optionBg.y=this.appOption.y,this.optionSound.x=this.appOption.x,this.optionSound.y=this.optionBg.height/2-this.optionSound.height+15,this.optionMusic.x=this.optionSound.x+80,this.optionMusic.y=this.optionSound.y-50,this.optionReset.x=this.optionMusic.x+40,this.optionReset.y=this.optionMusic.y-75}},HeaderGroup.prototype.showApp=function(t){},HeaderGroup.prototype.toggleAudio=function(t){return bootState.sound=!bootState.sound,bootState.sound?this.setTexture(this.optionSound,"header-option-sound-active.png"):this.setTexture(this.optionSound,"header-option-sound.png"),window.localStorage.setItem("option-sound",bootState.sound?"1":"0"),bootState.sound},HeaderGroup.prototype.enable=function(t){if("app"===t){if(this.appOption)return;this.appOption=this.addSprite("header-option.png",0,0),this.appOption.inputEnabled=!0,this.appOption.input.useHandCursor=!0,bootState.sound,this.appInfo=this.addSprite("header-info.png",0,0),this.appInfo.inputEnabled=!0,this.appInfo.input.useHandCursor=!0,t="header-option.png"}if("header-option.png"===t){var e;this.optionBg=this.addSprite("header-option-bg.png",0,0),this.optionBg.kill(),e=bootState.sound?"header-option-sound-active.png":"header-option-sound.png",this.optionSound=makeSprite(this.game,e,-153,25);var i={fill:"#ffffff",font:"20px "+dataStorage.fontHeader};(a=this.game.add.text(this.optionSound.width/2,0,"Sound ON/OFF",i)).anchor.set(0,.5),this.optionSound.addChild(a),this.optionSound.inputEnabled=!0,this.optionSound.anchor.set(.5),this.optionSound.input.useHandCursor=!0,e=dataStorage.isMusic?"header-option-music-active.png":"header-option-music.png",this.optionBg.addChild(this.optionSound),this.optionMusic=makeSprite(this.game,"header-option-fullscreen.png",-110,110),(a=this.game.add.text(this.optionSound.width/2,0,"Landscape / Portrait",i)).anchor.set(0,.5),this.optionMusic.addChild(a),this.optionMusic.inputEnabled=!0,this.optionMusic.input.useHandCursor=!0,this.optionMusic.anchor.set(.5),this.optionBg.addChild(this.optionMusic),this.optionReset=makeSprite(this.game,"header-exit.png",-110,110),(a=this.game.add.text(this.optionSound.width/2,0,"Reset progress",i)).anchor.set(0,.5),this.optionReset.addChild(a),this.optionReset.inputEnabled=!0,this.optionReset.input.useHandCursor=!0,this.optionReset.anchor.set(.5),this.optionBg.addChild(this.optionReset)}else if("header-health.png"===t){this.health=[];for(var s=0;s<3;s++)this.health[s]=this.addSprite("header-health.png",0,0),this.health[s].inputEnabled=!0,this.health[s].alpha=1,this.health[s].input.useHandCursor=!0}else if("header-score.png"===t||"header-time.png"===t||"header-bug.png"===t){this.scoreType="header-bug.png"===t?"bug":"header-time.png"===t?"time":"score",this.score=this.addSprite("header-"+this.scoreType+"-land.png",0,0),this.score.inputEnabled=!0,this.score.input.useHandCursor=!0;i={fill:"#ffffff",font:dataStorage.fontHeader};var a=this.scoreLabel=this.game.add.text(0,0,"",i);this.score.addChild(a),a.setShadow(3,3,"rgba(0,0,0,0.5)",5),a.anchor.set(.5,.5);var o={fill:"#ffffff",font:dataStorage.fontHeader,align:"center"};this.score1=this.addSprite("header-"+this.scoreType+"-land.png",0,0),this.score1.fontSize=12,this.score1.scale.set(.85),this.score1.inputEnabled=!0,this.score1.input.useHandCursor=!0,a=this.score1Label=this.game.add.text(0,0,"",o),this.score1.addChild(a),a.setShadow(3,3,"rgba(0,0,0,0.5)",5),a.anchor.set(.5,.5);a.wordWrap=!0,a.wordWrapWidth=100,this.score1.kill(),this.score2=this.addSprite("header-"+this.scoreType+"-land.png",0,0),this.score2.fontSize=12,this.score2.scale.set(.85),this.score2.inputEnabled=!0,this.score2.input.useHandCursor=!0,a=this.score2Label=this.game.add.text(0,0,"",o),this.score2.addChild(a),a.setShadow(3,3,"rgba(0,0,0,0.5)",5),a.anchor.set(.5,.5),a.wordWrap=!0,a.wordWrapWidth=100,this.score2.kill(),this.score3=this.addSprite("header-"+this.scoreType+"-land.png",0,0),this.score3.fontSize=12,this.score3.scale.set(.85),this.score3.inputEnabled=!0,this.score3.input.useHandCursor=!0,a=this.score3Label=this.game.add.text(0,0,"",o),this.score3.addChild(a),a.setShadow(3,3,"rgba(0,0,0,0.5)",5),a.anchor.set(.5,.5),a.wordWrap=!0,a.wordWrapWidth=100,this.score3.kill()}else if("header-time-score.png"===t||"header-health-score.png"===t){this.scoreType="header-time-score.png"===t?"time":"health",this.scoreTime=this.addSprite("header-"+this.scoreType+"-land.png",0,0),this.scoreTime.inputEnabled=!0,this.scoreTime.input.useHandCursor=!0;i={fill:"#ffffff",font:dataStorage.fontHeader};(a=this.scoreTimeLabel=this.game.add.text(0,0,"",i)).anchor.set(.5,.5),this.score=this.addSprite("header-score-land.png",0,0),this.score.inputEnabled=!0,this.score.input.useHandCursor=!0;i={fill:"#ffffff",font:dataStorage.fontHeader};(a=this.scoreLabel=this.game.add.text(0,0,"",i)).anchor.set(.5,.5)}else if("header-exit.png"===t)this.exit=this.addSprite(t,0,0),this.exit.inputEnabled=!0,this.exit.input.useHandCursor=!0;else if("header-quack.png"===t)this.exit=this.addSprite(t,0,0),this.exit.inputEnabled=!0,this.exit.input.useHandCursor=!0;else if("header-ad.png"===t);else if("header-info.png"===t){var h=this.info=this.addSprite("header-option.png",0,0);h.inputEnabled=!0,h.input.useHandCursor=!0}},HeaderGroup.prototype.onFullscreen=function(){this.game.scale.isFullScreen?(this.optionFullscreen.frame=this.optionFullscreen.spritesheetStart,this.game.scale.stopFullScreen()):(this.optionFullscreen.frame=this.optionFullscreen.spritesheetStart+1,this.game.scale.startFullScreen(!1)),this.state.popupGroup.dim.kill()},HeaderGroup.prototype.onChangeFullScreen=function(t){t.isFullScreen?onEnterFullScreen():onLeaveFullScreen()},HeaderGroup.prototype.select=function(t){t===this.optionSound&&(dataStorage.setAudio(!dataStorage.isAudio),dataStorage.isAudio?(this.setTexture(this.optionSound,"header-option-sound-active.png"),dataStorage.isMusic?this.setTexture(this.optionMusic,"header-option-music-active.png"):this.setTexture(this.optionMusic,"header-option-music.png")):(this.setTexture(this.optionSound,"header-option-sound.png"),this.setTexture(this.optionMusic,"header-option-music.png"))),t===this.optionMusic&&(dataStorage.setMusic(!dataStorage.isMusic),dataStorage.isMusic?this.setTexture(this.optionMusic,"header-option-music-active.png"):this.setTexture(this.optionMusic,"header-option-music.png"))},HeaderGroup.prototype.setScore=function(t){this.scoreLabel&&(this.scoreLabel.text=t)},HeaderGroup.prototype.setTime=function(t){this.scoreTimeLabel&&(this.scoreTimeLabel.text=t)},HeaderGroup.prototype.showOption=function(){this.game.world.bringToTop(this),this.optionBg.scale.set(0),this.optionBg.revive();this.game.add.tween(this.optionBg.scale).to({x:1,y:1},500,Phaser.Easing.Back.InOut,!0),this.game.physics&&this.game.physics.arcade&&(this.game.physics.arcade.isPaused=!0)},HeaderGroup.prototype.hideOption=function(){this.game.add.tween(this.optionBg.scale).to({x:0,y:0},500,Phaser.Easing.Back.InOut,!0).onComplete.addOnce(function(){this.optionBg.kill()},this)},HeaderGroup.prototype.getCenterX=function(t){return this.x+t.x*this.scale.x},HeaderGroup.prototype.getCenterY=function(t){return this.y+t.y*this.scale.y};var CanvasImage=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)};CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},CanvasImage.prototype.update=function(t){this.context.putImageData(t,0,0)},CanvasImage.prototype.getPixelCount=function(){return this.width*this.height},CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var ColorThief=function(){};if(ColorThief.prototype.getColor=function(t,e){return this.getPalette(t,5,e)[0]},ColorThief.prototype.getPalette=function(t,e,i,s){void 0===e&&(e=10),(void 0===i||i<1)&&(i=10);for(var a,o,h,r,n=t.data,l=[],d=0;d<s;d+=i)o=n[(a=4*d)+0],h=n[a+1],r=n[a+2],n[a+3]>=125&&(o>250&&h>250&&r>250||l.push([o,h,r]));var p=MMCQ.quantize(l,e);return p?p.palette():null},!pv)var pv={map:function(t,e){var i={};return e?t.map(function(t,s){return i.index=s,e.call(i,t)}):t.slice()},naturalOrder:function(t,e){return t<e?-1:t>e?1:0},sum:function(t,e){var i={};return t.reduce(e?function(t,s,a){return i.index=a,t+e.call(i,s)}:function(t,e){return t+e},0)},max:function(t,e){return Math.max.apply(null,e?pv.map(t,e):t)}};var MMCQ=function(){var t=5,e=8-t,i=1e3,s=.75;function a(e,i,s){return(e<<2*t)+(i<<t)+s}function o(t){var e=[],i=!1;function s(){e.sort(t),i=!0}return{push:function(t){e.push(t),i=!1},peek:function(t){return i||s(),void 0===t&&(t=e.length-1),e[t]},pop:function(){return i||s(),e.pop()},size:function(){return e.length},map:function(t){return e.map(t)},debug:function(){return i||s(),e}}}function h(t,e,i,s,a,o,h){this.r1=t,this.r2=e,this.g1=i,this.g2=s,this.b1=a,this.b2=o,this.histo=h}function r(){this.vboxes=new o(function(t,e){return pv.naturalOrder(t.vbox.count()*t.vbox.volume(),e.vbox.count()*e.vbox.volume())})}function n(t,e){if(e.count()){var i=e.r2-e.r1+1,s=e.g2-e.g1+1,o=e.b2-e.b1+1,h=pv.max([i,s,o]);if(1==e.count())return[e.copy()];var r,n,l,d,p=0,c=[],u=[];if(h==i)for(r=e.r1;r<=e.r2;r++){for(d=0,n=e.g1;n<=e.g2;n++)for(l=e.b1;l<=e.b2;l++)d+=t[a(r,n,l)]||0;p+=d,c[r]=p}else if(h==s)for(r=e.g1;r<=e.g2;r++){for(d=0,n=e.r1;n<=e.r2;n++)for(l=e.b1;l<=e.b2;l++)d+=t[a(n,r,l)]||0;p+=d,c[r]=p}else for(r=e.b1;r<=e.b2;r++){for(d=0,n=e.r1;n<=e.r2;n++)for(l=e.g1;l<=e.g2;l++)d+=t[a(n,l,r)]||0;p+=d,c[r]=p}return c.forEach(function(t,e){u[e]=p-t}),g(h==i?"r":h==s?"g":"b")}function g(t){var i,s,a,o,h,n=t+"1",l=t+"2",d=0;for(r=e[n];r<=e[l];r++)if(c[r]>p/2){for(a=e.copy(),o=e.copy(),h=(i=r-e[n])<=(s=e[l]-r)?Math.min(e[l]-1,~~(r+s/2)):Math.max(e[n],~~(r-1-i/2));!c[h];)h++;for(d=u[h];!d&&c[h-1];)d=u[--h];return a[l]=h,o[n]=a[l]+1,[a,o]}}}return h.prototype={volume:function(t){return this._volume&&!t||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},count:function(t){var e=this.histo;if(!this._count_set||t){var i,s,o,h=0;for(i=this.r1;i<=this.r2;i++)for(s=this.g1;s<=this.g2;s++)for(o=this.b1;o<=this.b2;o++)index=a(i,s,o),h+=e[index]||0;this._count=h,this._count_set=!0}return this._count},copy:function(){return new h(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},avg:function(e){var i=this.histo;if(!this._avg||e){var s,o,h,r,n=0,l=1<<8-t,d=0,p=0,c=0;for(o=this.r1;o<=this.r2;o++)for(h=this.g1;h<=this.g2;h++)for(r=this.b1;r<=this.b2;r++)n+=s=i[a(o,h,r)]||0,d+=s*(o+.5)*l,p+=s*(h+.5)*l,c+=s*(r+.5)*l;this._avg=n?[~~(d/n),~~(p/n),~~(c/n)]:[~~(l*(this.r1+this.r2+1)/2),~~(l*(this.g1+this.g2+1)/2),~~(l*(this.b1+this.b2+1)/2)]}return this._avg},contains:function(t){var i=t[0]>>e;return gval=t[1]>>e,bval=t[2]>>e,i>=this.r1&&i<=this.r2&&gval>=this.g1&&gval<=this.g2&&bval>=this.b1&&bval<=this.b2}},r.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var e=this.vboxes,i=0;i<e.size();i++)if(e.peek(i).vbox.contains(t))return e.peek(i).color;return this.nearest(t)},nearest:function(t){for(var e,i,s,a=this.vboxes,o=0;o<a.size();o++)((i=Math.sqrt(Math.pow(t[0]-a.peek(o).color[0],2)+Math.pow(t[1]-a.peek(o).color[1],2)+Math.pow(t[2]-a.peek(o).color[2],2)))<e||void 0===e)&&(e=i,s=a.peek(o).color);return s},forcebw:function(){var t=this.vboxes;t.sort(function(t,e){return pv.naturalOrder(pv.sum(t.color),pv.sum(e.color))});var e=t[0].color;e[0]<5&&e[1]<5&&e[2]<5&&(t[0].color=[0,0,0]);var i=t.length-1,s=t[i].color;s[0]>251&&s[1]>251&&s[2]>251&&(t[i].color=[255,255,255])}},{quantize:function(l,d){if(!l.length||d<2||d>256)return!1;var p=function(i){var s,o,h,r,n=new Array(1<<3*t);return i.forEach(function(t){o=t[0]>>e,h=t[1]>>e,r=t[2]>>e,s=a(o,h,r),n[s]=(n[s]||0)+1}),n}(l);p.forEach(function(){});var c=function(t,i){var s,a,o,r=1e6,n=0,l=1e6,d=0,p=1e6,c=0;return t.forEach(function(t){s=t[0]>>e,a=t[1]>>e,o=t[2]>>e,s<r?r=s:s>n&&(n=s),a<l?l=a:a>d&&(d=a),o<p?p=o:o>c&&(c=o)}),new h(r,n,l,d,p,c,i)}(l,p),u=new o(function(t,e){return pv.naturalOrder(t.count(),e.count())});function g(t,e){for(var s,a=1,o=0;o<i;)if((s=t.pop()).count()){var h=n(p,s),r=h[0],l=h[1];if(!r)return;if(t.push(r),l&&(t.push(l),a++),a>=e)return;if(o++>i)return}else t.push(s),o++}u.push(c),g(u,s*d);for(var m=new o(function(t,e){return pv.naturalOrder(t.count()*t.volume(),e.count()*e.volume())});u.size();)m.push(u.pop());g(m,d-m.size());for(var f=new r;m.size();)f.push(m.pop());return f}}}(),playLogicJigsaw={showTutorial:function(){if(!this.tutorialOngoing){this.tutorialOngoing=!0;var t=this.tutorial++;switch(this.inputLockTime=this.time.time+150,t){case 1:dataStorage.isMusic&&dataStorage.isAudio,this.hasArcadePhysics?(this.startGame(),this.time.events.add(750,function(){this.tutorialGroup.showHand("\nThis is YOU!\n\n"+this.hitToContinue,this.player.sprite,this.boardGroup),this.game.physics.arcade.isPaused=!0},this)):this.tutorialGroup.showHand(Text.misplacedDrag,{x:180,y:180},this.boardGroup);break;case 2:this.hasArcadePhysics?(this.tutorialGroup.hand.kill(),this.tutorialGroup.handText.text="\nPress and HOLD to turn.",this.game.physics.arcade.isPaused=!0):this.tutorialGroup.showHand(Text.swapTiles,{x:540,y:180},this.boardGroup);break;case 3:this.hasArcadePhysics?(this.game.physics.arcade.isPaused=!1,this.player.sprite.score>1?(this.tutorialGroup.handText.text="\nGREAT!\n\nYou are ready to race.",this.time.events.add(1e3,function(){this.tutorial=0,this.tutorialGroup.hide()},this)):this.tutorial=3):(this.tutorialGroup.hand.kill(),this.tutorialGroup.handText.text=Text.fixRest,this.time.events.add(3e3,function(){this.tutorial=0,this.tutorialGroup.hide()},this))}}},releaseTile:function(t,e,i){if(this.selectSprite&&(this.selectSprite.scale.set(1),bootState.app),t.targetObject&&t.targetObject.sprite!==this.selectSprite)return dataStorage.isAudio&&this.soundEffects.play("tak"),void(this.selectSprite=null);var s=this.selectSprite;if(this.moveCount++,s.locked);else{dataStorage.isAudio&&this.soundEffects.play("tok"),this.moves--;var a,o=this.dx,h=this.dy,r=s.x-s.xx,n=s.y-s.yy,l=0,d=0;r<=-o/2?l=Math.floor((r+o/2)/o):r>=o/2&&(l=Math.floor((r+o/2)/o)),n<=-h/2?d=Math.floor((n+h/2)/h):n>=h/2&&(d=Math.floor((n+h/2)/h));for(var p=0;p<this.group.children.length;p++){var c=this.group.children[p];if(c!==s&&c.xPos===s.xPos+l&&c.yPos===s.yPos+d){c.locked?(this.showText(s,Text.AlreadyInPlace),c.x-=2,this.add.tween(c).to({x:c.xx+4},100,Phaser.Easing.Linear.None,!0,0,0,!0).onComplete.add(function(t){t.x=t.xx})):a=c;break}}e&&i?this.playLogic.swapTiles.call(this,e,i):this.playLogic.swapTiles.call(this,s,a)}this.selectSprite=null},swapDone:function(t,e){var i=t.xPos,s=t.yPos;t.xPos=e.xPos,t.yPos=e.yPos,e.xPos=i,e.yPos=s;i=t.xPos+this.cols/2;var a,o,h=(s=t.yPos+this.rows/2)*this.cols+i,r=e.xPos+this.cols/2,n=(e.yPos+this.rows/2)*this.cols+r;h!==t.id&&n!==e.id?(this.tweening=!1,this.playerLives--,bootState.app&&localStorage.setItem("picturepuzzleLives",this.playerLives),this.playerLives>0||bootState.app&&0===this.playerLives?(dataStorage.isAudio,this.headerGroup.health&&(this.headerGroup.health[this.playerLives].alpha=.25),bootState.app?(playState.playSound("tok"),this.showText(t,"Incorrect placement\nGuesses "+this.playerLives+" / 3")):this.showText(t,Text.tileNotInPlace)):bootState.app?(this.showAdPopup(),playState.headerGroup.showApp(!0),this.popupGroup.showDialog("Watch an ad to continue\nand get three new guesses.",null,this,!0,!0)):0===this.playerLives?(dataStorage.isAudio&&this.soundEffects.play("notify"),this.headerGroup.health&&(this.headerGroup.health[this.playerLives].alpha=.25),playState.outOfMoves?this.popupGroup.showDialog(Text.outOfLives,null,this,!0,!0):this.showText(t,Text.TileAlreadyInPlace)):(dataStorage.isAudio,this.showText(t,Text.TileAlreadyInPlace))):(a=t.width/this.boardGroup.scale.x,o=t.height/this.boardGroup.scale.y,h===t.id&&(t.locked=!0,this.tweening=!1,this.effectGroup.start(t.x,t.y,a,o),t.border.destroy()),n===e.id&&(e.locked=!0,this.tweening=!1,this.effectGroup.start(e.x,e.y,a,o),e.border.destroy()),this.checkComplete())},swapTiles:function(t,e){if(this.tweening=!0,e){this.tweening=!0;var i=t.xx,s=t.yy;t.xx=e.xx,t.yy=e.yy,e.xx=i,e.yy=s,this.add.tween(e).to({x:e.xx,y:e.yy},150,Phaser.Easing.Linear.None,!0).onComplete.add(function(t){},this),this.add.tween(t).to({x:t.xx,y:t.yy},150,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){},this),this.time.events.add(200,function(){this.playLogic.swapDone.call(this,t,e),this.tweening=!1},this)}else bootState.app||(this.lastSelected=this.selectSprite),this.add.tween(t).to({x:t.xx,y:t.yy},100,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.tweening=!1},this)},selectTile:function(t,e){if(this.tweening)return null;let i=this.selectSprite;if(this.selectSprite||t.targetObject&&t.targetObject.sprite.id>=0)if(this.selectSprite){if(e.visible){var s=this.input.x-this.dragX,a=this.input.y-this.dragY;s*s+a*a>.01*(e.width*e.width+e.height*e.height)?(this.selectSprite.x=this.startX+s/this.group.scale.x,this.selectSprite.y=this.startY+a/this.group.scale.y,this.selectSprite.drag=!0):(this.selectSprite.x=this.startX,this.selectSprite.y=this.startY)}}else if(t.targetObject.sprite.locked){dataStorage.isAudio&&this.soundEffects.play("tak");var o=t.targetObject.sprite;o.x-=2,this.tweening=!0,this.add.tween(o).to({x:o.xx+4},100,Phaser.Easing.Linear.None,!0,0,0,!0).onComplete.add(function(t){this.tweening=!1,t.x=t.xx},this),this.showText(o,Text.AlreadyInPlace)}else this.tutorialOngoing=!1,this.selectSprite=t.targetObject.sprite,this.selectSprite.drag=!1,i=this.selectSprite,this.selectSprite.bringToTop(),this.add.tween(this.selectSprite.scale).to({x:1.02,y:1.02},50,Phaser.Easing.Linear.None,!0,0,0,!0),dataStorage.isAudio&&this.soundEffects.play("tik"),this.dragX=this.input.x,this.dragY=this.input.y,this.startX=this.selectSprite.x,this.startY=this.selectSprite.y;return i},countMisplaced:function(){for(var t=0,e=0;e<this.group.children.length;e++){var i=this.group.children[e],s=i.xPos+this.cols/2;(i.yPos+this.rows/2)*this.cols+s!==i.id&&t++}return t},checkComplete:function(){var t=playLogicJigsaw.countMisplaced.call(this);if(this.headerGroup.setScore(t),t>0)return!1;this.inputLockTime=this.time.time+1500,this.image.alpha=1,this.image.bringToTop(),this.world.bringToTop(this.effectGroup),this.playSound("good"),dataStorage.isAudio&&this.time.events.add(50,function(){this.soundEffects.play("good")},this),this.time.events.add(300,function(){this.showText(null,Text.PuzzleSolved);var t={font:"24px",fill:"#000",wordWrap:!0,wordWrapWidth:playState.game.width,fontWeight:"normal",align:"center"},e=this.add.text(this.world.centerX,5*this.game.height/6,Text.photoBy+mainState.author,t);e.setShadow(1,1,"rgba(255,255,255,1)",1),e.anchor.set(.5),t={font:"18px",fill:"#000",wordWrap:!0,wordWrapWidth:playState.game.width,fontWeight:"normal",align:"center"};var i=mainState.chapter.info.total_photos;i>20&&(i=20),(e=this.add.text(e.x,e.y-e.height/2,"Photo "+(mainState.chapter.level+1)+" / "+i,t)).y-=e.height/2*1,e.setShadow(1,1,"rgba(255,255,255,1)",1),e.anchor.set(.5)},this),this.time.events.add(1e3,function(){this.clickToEnd=!0;var t=this.add.text(this.world.centerX,this.game.height,this.hitToContinue,{font:"18px",fill:"#000",wordWrap:!1,fontWeight:"normal",align:"center"});t.y-=1.25*t.height,t.setShadow(1,1,"rgba(255,255,255,1)",1),t.anchor.set(.5)},this)},createLevel:function(){this.image&&this.image.destroy(),this.image=this.add.image(this.game.world.centerX,this.game.world.centerY,mainState.image),this.image.anchor.set(.5),this.image.alpha=.33,this.createPuzzle(),bootState.app?(this.playerLives=localStorage.getItem("picturepuzzleLives"),null===this.playerLives&&(this.playerLives="3",localStorage.setItem("picturepuzzleLives",this.playerLives)),this.playerLives=parseInt(this.playerLives)):this.playerLives=3,this.totalMoves=this.moves},moveTile:function(t){t.x=this.game.width/2+this.dx*t.xPos,t.y=this.game.height/2+this.dy*t.yPos,t.x+=t.width/2,t.y+=t.height/2,t.xx=t.x,t.yy=t.y},calcLevel:function(){var t;if(bootState.app){switch(mainState.chapter.level%10){case 0:t=22;break;case 1:case 2:t=32;break;case 3:t=33;break;case 4:t=32;break;case 5:t=33;break;case 6:t=42;break;case 7:t=32;break;case 8:t=33;break;case 9:t=42;break;case 10:t=43;break;case 11:default:t=55}}else{if(0===mainState.difficulty)switch(mainState.chapter.level%10){case 0:case 1:case 2:t=0;break;case 3:t=1;break;case 4:case 5:t=0;break;case 6:t=1;break;case 7:t=0;break;case 8:case 9:t=1}if(1===mainState.difficulty)switch(mainState.chapter.level%10){case 0:case 1:t=0;break;case 2:case 3:case 4:t=1;break;case 5:t=0;break;case 6:case 7:case 8:t=1;break;case 9:t=2}if(2===mainState.difficulty)switch(mainState.chapter.level%10){case 0:t=0;break;case 1:case 2:t=1;break;case 3:t=2;break;case 4:t=1;break;case 5:case 6:t=2;break;case 7:t=3;break;case 8:t=2;break;case 9:t=1}}return mainState.forceLevel>=0&&(t=mainState.forceLevel),t},createPuzzle:function(t){var e,i,s,a=this.cache.getImage(mainState.image),o=a.width,h=a.height,r=playLogicJigsaw.calcLevel(),n=playGridJigsaw.shuffle(this,r);this.tutorial?this.puzzleRandom=0:this.puzzleRandom=this.rnd.integerInRange(0,n.length-1),e=this.puzzleRandom;var l=Math.min(o,h);l=Math.min(l,this.game.width),l=Math.min(l,this.game.height);var d=this.game.width,p=this.game.height;bootState.app||(d=l,p=l),(y=this.make.bitmapData(d,p)).clear(),y.ctx.beginPath(),y.ctx.rect(0,0,y.width-1,y.height-1),y.ctx.fillStyle="#000000",y.ctx.fill(),y.ctx.stroke(),(t=this.add.sprite(this.game.world.centerX,this.game.world.centerY,y)).anchor.set(.5),this.dx=d/this.cols,this.dy=p/this.rows;var c=this.make.sprite(0,0,mainState.image);this.group=this.game.add.group();var u=-1,g=(o-this.dx*this.cols)/2,m=(h-this.dy*this.rows)/2;this.moves=0;var f=this.make.bitmapData(this.dx,this.dy);for(f.clear(),f.ctx.beginPath(),f.ctx.rect(0,0,f.width-1,f.height-1),f.ctx.strokeStyle="#000",f.ctx.lineWidth=2,f.ctx.stroke(),this.border=f,i=0;i<this.rows;i++)for(s=0;s<this.cols;s++){var v,x;v=parseInt(n[e][i][s]/this.cols);var y,S=-(x=n[e][i][s]%this.cols)*this.dx,T=-v*this.dy;(y=this.make.bitmapData(this.dx,this.dy)).clear(),y.draw(c,S-g,T-m,o,h);S=s-this.cols/2,T=i-this.rows/2;(t=this.group.create(this.game.width/2+this.dx*S,this.game.height/2+this.dy*T,y)).xPos=S,t.yPos=T,t.x+=t.width/2,t.y+=t.height/2,t.anchor.set(.5),t.xx=t.x,t.yy=t.y,t.inputEnabled=!0,t.locked=!1,t.input.bringToTop=!0,t.id=x+v*this.cols,t.id>u&&(u=t.id,this.spriteSlot=t),t.anchor.set(.5),this.playLogic.renderBorder.call(this,t)}},renderBorder:function(t){var e=this.make.sprite(0,0,this.border);e.anchor.set(.5),t.addChild(e),t.border=e},getSize:function(){return{w:this.dx,h:this.dy}}},playLogicSliding={showTutorial:function(){if(!this.tutorialOngoing){this.tutorialOngoing=!0;var t=this.tutorial++;switch(this.inputLockTime=this.time.time+250,t){case 1:dataStorage.isMusic&&dataStorage.isAudio,this.hasArcadePhysics?(this.startGame(),this.time.events.add(750,function(){this.tutorialGroup.showHand("\nThis is YOU!\n\n"+this.hitToContinue,this.player.sprite,this.boardGroup),this.game.physics.arcade.isPaused=!0},this)):this.tutorialGroup.showHand(Text.slideMisplaced,{x:540,y:180},this.boardGroup);break;case 2:this.hasArcadePhysics?(this.tutorialGroup.hand.kill(),this.tutorialGroup.handText.text="\nPress and HOLD to turn.",this.game.physics.arcade.isPaused=!0):(this.tutorialGroup.hand.kill(),this.tutorialGroup.handText.text=Text.slidetutor);break;case 3:this.hasArcadePhysics?(this.game.physics.arcade.isPaused=!1,this.player.sprite.score>1?(this.tutorialGroup.handText.text="\nGREAT!\n\nYou are ready to race.",this.time.events.add(1e3,function(){this.tutorial=0,this.tutorialGroup.hide()},this)):this.tutorial=3):(this.tutorialGroup.handText.text=Text.tutorOneMore,this.time.events.add(3e3,function(){this.tutorial=0,this.tutorialGroup.hide()},this))}}},releaseTile:function(t){if(t.targetObject&&t.targetObject.sprite!==this.selectSprite)return dataStorage.isAudio&&this.soundEffects.play("tak"),void(bootState.app||(this.selectSprite=null));var e,i=this.selectSprite;if(i.xPos!==this.spriteSlot.xPos||i.yPos!==this.spriteSlot.yPos-1&&i.yPos!==this.spriteSlot.yPos+1||(e=this.spriteSlot),i.yPos!==this.spriteSlot.yPos||i.xPos!==this.spriteSlot.xPos-1&&i.xPos!==this.spriteSlot.xPos+1||(e=this.spriteSlot),e){this.tutorialOngoing=!1;var s=i.xx,a=i.yy;i.xx=e.xx,i.yy=e.yy,e.xx=s,e.yy=a;var o=i.xPos,h=i.yPos;i.xPos=e.xPos,i.yPos=e.yPos,e.xPos=o,e.yPos=h,this.add.tween(e).to({x:e.xx,y:e.yy},150,Phaser.Easing.Linear.None,!0),this.add.tween(i).to({x:i.xx,y:i.yy},150,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.checkComplete()},this)}bootState.app||(this.selectSprite=null)},selectTile:function(t){if(!this.tweening&&(this.selectSprite||t.targetObject&&t.targetObject.sprite.id>=0)&&!this.selectSprite){var e,i=t.targetObject.sprite;if(i.xPos!==this.spriteSlot.xPos||i.yPos!==this.spriteSlot.yPos-1&&i.yPos!==this.spriteSlot.yPos+1||(e=!0),i.yPos!==this.spriteSlot.yPos||i.xPos!==this.spriteSlot.xPos-1&&i.xPos!==this.spriteSlot.xPos+1||(e=!0),!e)return dataStorage.isAudio&&this.soundEffects.play("tak"),this.inputLockTime=this.time.time+150,void this.showText(i,"Can't slide that tile.");dataStorage.isAudio&&this.soundEffects.play("tik"),this.selectSprite=i,this.selectSprite.bringToTop()}},countMisplaced:function(){for(var t=0,e=0;e<this.group.children.length;e++){var i=this.group.children[e],s=i.xPos+this.cols/2;(i.yPos+this.rows/2)*this.cols+s!==i.id&&t++}return t},checkComplete:function(){var t=playLogicSliding.countMisplaced.call(this);return this.headerGroup.setScore(t),!(t>0)&&(this.inputLockTime=this.time.time+1500,this.image.alpha=1,this.image.bringToTop(),dataStorage.isAudio&&this.time.events.add(50,function(){this.soundEffects.play("good")},this),this.time.events.add(300,function(){this.showText(null,Text.PuzzleSolved)},this),this.time.events.add(1e3,function(){this.clickToEnd=!0;var t=this.add.text(this.world.centerX,3*this.world.centerY/2,this.hitToContinue,{font:"24px",fill:"#000000",wordWrap:!1,fontWeight:"normal",align:"center"});t.setShadow(1,1,"rgba(255,255,255,1)",1),t.anchor.set(.5)},this),!0)},createLevel:function(){this.image&&this.image.destroy(),this.image=this.add.image(this.game.world.centerX,this.game.world.centerY,mainState.image),this.image.anchor.set(.5),this.image.alpha=.33,this.createPuzzle(),bootState.app?(this.playerLives=localStorage.getItem("picturepuzzleLives")||"3",this.playerLives=parseInt(this.playerLives)):this.playerLives=3,this.totalMoves=this.moves},moveTile:function(t){t.x=this.game.width/2+this.dx*t.xPos,t.y=this.game.height/2+this.dy*t.yPos,t.x+=t.width/2,t.y+=t.height/2,t.xx=t.x,t.yy=t.y},calcLevel:function(){var t;if(0===mainState.difficulty)switch(mainState.chapter.level%10){case 0:t=0;break;case 1:t=1;break;case 2:t=0;break;case 3:t=1;break;case 4:t=0;break;case 5:t=1;break;case 6:t=0;break;case 7:t=1;break;case 8:t=0;break;case 9:t=1}if(1===mainState.difficulty)switch(mainState.chapter.level%10){case 0:t=0;break;case 1:case 2:case 3:t=1;break;case 4:t=0;break;case 5:case 6:case 7:case 8:t=1;break;case 9:t=2}if(2===mainState.difficulty)switch(mainState.chapter.level%10){case 0:t=0;break;case 1:case 2:case 3:t=1;break;case 4:t=2;break;case 5:t=1;break;case 6:t=2;break;case 7:t=3;break;case 8:t=2;break;case 9:t=1}return t},createPuzzle:function(t){var e,i,s,a=this.cache.getImage(mainState.image),o=a.width,h=a.height,r=playLogicSliding.calcLevel(),n=playGridSliding.shuffle(this,r);this.tutorial?this.puzzleRandom=0:this.puzzleRandom=this.rnd.integerInRange(0,n.length-1),e=this.puzzleRandom;var l=Math.min(o,h);l=Math.min(l,this.game.width),l=Math.min(l,this.game.height),(f=this.make.bitmapData(l,l)).clear(),f.ctx.beginPath(),f.ctx.rect(0,0,f.width-1,f.height-1),f.ctx.fillStyle="#000000",f.ctx.fill(),f.ctx.stroke(),(t=this.add.sprite(this.game.world.centerX,this.game.world.centerY,f)).anchor.set(.5),this.dx=l/this.cols,this.dy=l/this.rows;var d=this.make.sprite(0,0,mainState.image);this.group=this.game.add.group();var p=-1,c=(o-this.dx*this.cols)/2,u=(h-this.dy*this.rows)/2;for(this.moves=0,i=0;i<this.rows;i++)for(s=0;s<this.cols;s++){var g,m;g=parseInt(n[e][i][s]/this.cols);var f,v=-(m=n[e][i][s]%this.cols)*this.dx,x=-g*this.dy;(f=this.make.bitmapData(this.dx,this.dy)).clear(),f.ctx.beginPath(),f.ctx.rect(0,0,f.width-1,f.height-1),f.ctx.fillStyle="#c4c4cc",f.ctx.fill(),f.draw(d,v-c,x-u,o,h),f.ctx.stroke();v=s-this.cols/2,x=i-this.rows/2;(t=this.group.create(this.game.width/2+this.dx*v,this.game.height/2+this.dy*x,f)).xPos=v,t.yPos=x,t.x+=t.width/2,t.y+=t.height/2,t.anchor.set(.5),t.xx=t.x,t.yy=t.y,t.inputEnabled=!0,t.locked=!1,t.input.bringToTop=!0,t.id=m+g*this.cols,t.id>p&&(p=t.id,this.spriteSlot=t),t.anchor.set(.5)}this.spriteSlot.tint=0}},playLogicRolling={showTutorial:function(){if(!this.tutorialOngoing){this.tutorialOngoing=!0;var t=this.tutorial++;switch(this.inputLockTime=this.time.time+250,t){case 1:dataStorage.isMusic&&dataStorage.isAudio,this.hasArcadePhysics?(this.startGame(),this.time.events.add(750,function(){this.tutorialGroup.showHand("\nThis is YOU!\n\n"+this.hitToContinue,this.player.sprite,this.boardGroup),this.game.physics.arcade.isPaused=!0},this)):this.tutorialGroup.showHand(Text.rotateMisplaced,{x:180,y:180},this.boardGroup);break;case 2:this.hasArcadePhysics?(this.tutorialGroup.hand.kill(),this.tutorialGroup.handText.text="\nPress and HOLD to turn.",this.game.physics.arcade.isPaused=!0):(this.tutorialGroup.hand.kill(),this.tutorialGroup.handText.text=Text.tutorOneMore);break;case 3:this.hasArcadePhysics?(this.game.physics.arcade.isPaused=!1,this.player.sprite.score>1?(this.tutorialGroup.handText.text="\nGREAT!\n\nYou are ready to race.",this.time.events.add(1e3,function(){this.tutorial=0,this.tutorialGroup.hide()},this)):this.tutorial=3):(this.tutorialGroup.handText.text=Text.tutorOneMore,this.time.events.add(3e3,function(){this.tutorial=0,this.tutorialGroup.hide()},this))}}},releaseTile:function(t){if(t.targetObject&&t.targetObject.sprite!==this.selectSprite)return dataStorage.isAudio&&this.soundEffects.play("tak"),void(this.selectSprite=null);var e=this.selectSprite;this.moveCount++,0===e.angle?(this.playerLives--,this.playerLives>0?(dataStorage.isAudio,this.headerGroup.health[this.playerLives].alpha=.25,this.showText(e,Text.pickOnlyRotated)):0===this.playerLives?(dataStorage.isAudio&&this.soundEffects.play("notify"),this.headerGroup.health[this.playerLives].alpha=.25,playState.outOfMoves?this.popupGroup.showDialog(Text.outOfLives,null,this,!0,!0):this.showText(e,Text.pickOnlyRotated)):(dataStorage.isAudio,this.showText(e,Text.pickOnlyRotated))):(this.tutorialOngoing=!1,dataStorage.isAudio&&this.soundEffects.play("tok"),this.moves--,this.headerGroup.setScore(this.moves),this.add.tween(e).to({angle:0},150,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){},this)),this.selectSprite=null},selectTile:function(t){if(!this.tweening&&(this.selectSprite||t.targetObject&&t.targetObject.sprite.id>=0)&&!this.selectSprite)if(t.targetObject.sprite.locked){this.inputLockTime=this.time.time+750,dataStorage.isAudio&&this.soundEffects.play("tak");var e=t.targetObject.sprite;e.x-=2,this.add.tween(e).to({x:e.xx+4},100,Phaser.Easing.Linear.None,!0,0,0,!0).onComplete.add(function(t){t.x=t.xx},this),this.showText(e,"Piece already in place.")}else this.selectSprite=t.targetObject.sprite,this.selectSprite.bringToTop(),dataStorage.isAudio&&this.soundEffects.play("tik")},checkComplete:function(){for(var t=0;t<this.group.children.length;t++){if(0!==this.group.children[t].angle)return!1}this.inputLockTime=this.time.time+1500,this.image.alpha=1,this.image.bringToTop(),dataStorage.isAudio&&this.time.events.add(50,function(){this.soundEffects.play("good")},this),this.time.events.add(300,function(){this.showText(null,Text.PuzzleSolved)},this),this.time.events.add(1e3,function(){this.clickToEnd=!0;var t=this.add.text(this.world.centerX,3*this.world.centerY/2,this.hitToContinue,{font:"24px",fill:"#000000",wordWrap:!1,fontWeight:"normal",align:"center"});t.setShadow(1,1,"rgba(255,255,255,1)",1),t.anchor.set(.5)},this)},createLevel:function(){this.image&&this.image.destroy(),this.image=this.add.image(this.game.world.centerX,this.game.world.centerY,mainState.image),this.image.anchor.set(.5),this.image.alpha=.33,this.createPuzzle(),bootState.app?(this.playerLives=localStorage.getItem("picturepuzzleLives")||"3",this.playerLives=parseInt(this.playerLives)):this.playerLives=3,this.totalMoves=this.moves},moveTile:function(t){t.x=this.game.width/2+this.dx*t.xPos,t.y=this.game.height/2+this.dy*t.yPos,t.x+=t.width/2,t.y+=t.height/2,t.xx=t.x,t.yy=t.y},calcLevel:function(){var t;if(0===mainState.difficulty)switch(mainState.chapter.level%15){case 0:t=0;break;case 1:t=1;break;case 2:t=0;break;case 3:case 4:case 5:t=1;break;case 6:t=0;break;case 7:t=1;break;case 8:t=2;break;case 9:t=1;break;case 10:t=2;break;case 11:t=3;break;case 12:t=2;break;case 13:t=1;break;case 14:t=0}if(1===mainState.difficulty)switch(mainState.chapter.level%15){case 0:t=0;break;case 1:case 2:case 3:t=1;break;case 4:t=2;break;case 5:case 6:t=1;break;case 7:case 8:case 9:t=2;break;case 10:t=3;break;case 11:t=1;break;case 12:t=2;break;case 13:t=3;break;case 14:t=4}if(2===mainState.difficulty)switch(mainState.chapter.level%15){case 0:t=0;break;case 1:t=1;break;case 2:t=2;break;case 3:t=1;break;case 4:t=2;break;case 5:t=3;break;case 6:t=2;break;case 7:t=3;break;case 8:t=4;break;case 9:t=3;break;case 10:t=4;break;case 11:t=5;break;case 12:t=4;break;case 13:t=5;break;case 14:t=6}return t},createPuzzle:function(t){var e,i,s,a=this.cache.getImage(mainState.image),o=a.width,h=a.height,r=playLogicRolling.calcLevel(),n=playGridRolling.shuffle(this,r);this.tutorial?this.puzzleRandom=0:this.puzzleRandom=this.rnd.integerInRange(0,n.length-1),e=this.puzzleRandom;var l=Math.min(o,h);l=Math.min(l,this.game.width),l=Math.min(l,this.game.height),(v=this.make.bitmapData(l,l)).clear(),v.ctx.beginPath(),v.ctx.rect(0,0,v.width-1,v.height-1),v.ctx.fillStyle="#000000",v.ctx.fill(),v.ctx.stroke(),(t=this.add.sprite(this.game.world.centerX,this.game.world.centerY,v)).anchor.set(.5),this.dx=l/this.cols,this.dy=l/this.rows;var d=this.make.sprite(0,0,mainState.image);this.group=this.game.add.group();var p=-1,c=[0,0,0],u=(o-this.dx*this.cols)/2,g=(h-this.dy*this.rows)/2;for(this.moves=0,i=0;i<this.rows;i++)for(s=0;s<this.cols;s++){var m,f;m=i;var v,x=-(f=s)*this.dx,y=-m*this.dy;(v=this.make.bitmapData(this.dx,this.dy)).clear(),v.ctx.beginPath(),v.ctx.rect(0,0,v.width-1,v.height-1),v.ctx.fillStyle="#c4c4cc",v.ctx.fill(),v.draw(d,x-u,y-g,o,h),v.ctx.stroke();x=s-this.cols/2,y=i-this.rows/2;if((t=this.group.create(this.game.width/2+this.dx*x,this.game.height/2+this.dy*y,v)).xPos=x,t.yPos=y,t.x+=t.width/2,t.y+=t.height/2,t.anchor.set(.5),t.xx=t.x,t.yy=t.y,t.inputEnabled=!0,t.locked=!1,t.input.bringToTop=!0,t.id=f+m*this.cols,t.id>p&&(p=t.id,this.spriteSlot=t),1===n[e][i][s]){for(var S=0,T=0;T<c.length;T++)S+=c[T],c[T]++;this.moves++;var b=this.rnd.integerInRange(1,S);b<=c[0]?(t.angle=90,c[0]=0):b<=c[0]+c[1]?(t.angle=-90,c[1]=0):b<=c[0]+c[1]+c[2]&&(t.angle=180,c[2]=0)}t.anchor.set(.5)}},countMisplaced:function(){return this.moves}};Phaser.Filter.Gray=function(t){Phaser.Filter.call(this,t),this.uniforms.gray={type:"1f",value:1},this.fragmentSrc=["precision mediump float;","varying vec2       vTextureCoord;","varying vec4       vColor;","uniform sampler2D  uSampler;","uniform float      gray;","void main(void) {","gl_FragColor = texture2D(uSampler, vTextureCoord);","gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126 * gl_FragColor.r + 0.7152 * gl_FragColor.g + 0.0722 * gl_FragColor.b), gray);","}"]},Phaser.Filter.Gray.prototype=Object.create(Phaser.Filter.prototype),Phaser.Filter.Gray.prototype.constructor=Phaser.Filter.Gray,Object.defineProperty(Phaser.Filter.Gray.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(t){this.uniforms.gray.value=t}});var playLogicColors={showTutorial:function(){this.tutorialOngoing,this.tutorialOngoing=!0;var t=this.tutorial++;switch(this.inputLockTime=this.time.time+250,t){case 1:dataStorage.isMusic&&dataStorage.isAudio,this.hasArcadePhysics?(this.startGame(),this.time.events.add(750,function(){this.tutorialGroup.showHand("\nThis is YOU!\n\n"+this.hitToContinue,this.player.sprite,this.boardGroup),this.game.physics.arcade.isPaused=!0},this)):this.tutorialGroup.showHand(Text.colorHelp1,{x:90,y:360},this.boardGroup);break;case 2:this.hasArcadePhysics?(this.tutorialGroup.hand.kill(),this.tutorialGroup.handText.text="\nPress and HOLD to turn.",this.game.physics.arcade.isPaused=!0):this.tutorialGroup.showHand(Text.colorHelp2,{x:90,y:360},this.boardGroup);break;case 3:this.hasArcadePhysics?(this.game.physics.arcade.isPaused=!1,this.player.sprite.score>1?(this.tutorialGroup.handText.text="\nGREAT!\n\nYou are ready to race.",this.time.events.add(1e3,function(){this.tutorial=0,this.tutorialGroup.hide()},this)):this.tutorial=3):(this.tutorialGroup.hand.kill(),this.tutorialGroup.showHand(Text.colorHelp3,{x:90,y:360},this.boardGroup),this.time.events.add(3e3,function(){this.tutorial=0,this.tutorialGroup.hide()},this))}},releaseTile:function(t){if(this.selectSprite){if(t.targetObject&&t.targetObject.sprite!==this.selectSprite)return dataStorage.isAudio,void(this.selectSprite=null);var e=this.selectSprite;if(this.moveCount++,e.locked);else if(dataStorage.isAudio&&this.soundEffects.play("tok"),1===this.gameType||2===this.gameType)if(1===e.id){var i;for(i=0;i<this.boardGroup.children.length;i++)this.boardGroup.children[i].inputEnabled=!1,this.game.add.tween(this.boardGroup.children[i]).to({alpha:0},500,Phaser.Easing.Quadratic.None,!0);this.game.add.tween(this.paletteLabel).to({alpha:0},500,Phaser.Easing.Quadratic.None,!0),this.showText(e,Text.correct),this.tutorial>0&&this.showTutorial(),this.time.events.add(1250,function(){this.tutorialOngoing=!1,this.paletteLabel.kill(),3===this.gameType?this.gameOver(!0):(playLogicColors.createGame.call(playState,playState.gameType+1),playState.headerGroup.setScore(playState.playLogic.countMisplaced.call(playState)))},this)}else this.playerLives--,this.playerLives>0?(dataStorage.isAudio,this.headerGroup.health[this.playerLives].alpha=.25,this.showText(e,Text.sorryWrong)):0===this.playerLives?(dataStorage.isAudio&&this.soundEffects.play("notify"),this.headerGroup.health[this.playerLives].alpha=.25,playState.outOfMoves?this.popupGroup.showDialog(Text.OutOfLives,null,this,!0,!0):this.showText(e,Text.sorryWrong)):dataStorage.isAudio,e.kill();else if(3===this.gameType&&this.selectSprite){var s,a=e.xx,o=e.yy;this.boardGroup.children.forEach(function(t){if(!s&&t.id>1&&t!==e&&t.id>1&&t.alive&&Math.abs(e.x-t.x)+Math.abs(e.y-t.y)<e.width/2)return void(s=t)},this),s&&(a=s.xx,o=s.yy,s.xx=e.xx,s.yy=e.yy,e.xx=a,e.yy=o,this.add.tween(s).to({x:s.xx,y:s.yy},120,Phaser.Easing.Linear.None,!0,0,0).onComplete.add(function(t){playLogicColors.checkColorsComplete.call(this)},this)),this.add.tween(e).to({x:a,y:o},100,Phaser.Easing.Linear.None,!0,0,0).onComplete.add(function(t){},this)}this.selectSprite=null}else this.selectSprite=null},checkColorsComplete:function(){var t,e;this.colorMoves--;var i=0;for(t=0;t<this.boardGroup.children.length;t++)for(var s=0;s<this.boardGroup.children.length;s++)if((e=this.boardGroup.children[s]).id===t+1){if(e.x<i)return this.colorMoves<=0&&(this.playerLives--,this.playerLives>0&&(dataStorage.isAudio,this.headerGroup.health[this.playerLives].alpha=.25),0===this.playerLives?(dataStorage.isAudio&&this.soundEffects.play("notify"),this.headerGroup.health[this.playerLives].alpha=.25,playState.outOfMoves?this.popupGroup.showDialog(Text.OutOfLives,null,this,!0,!0):this.showText(e,Text.IncorrectLoseLife)):dataStorage.isAudio),!1;i=e.x;break}for(t=0;t<this.boardGroup.children.length;t++)e.inputEnabled=!1,this.game.add.tween(this.boardGroup.children[t]).to({alpha:0},500,Phaser.Easing.Quadratic.None,!0);this.game.add.tween(this.paletteLabel).to({alpha:0},500,Phaser.Easing.Quadratic.None,!0),this.time.events.add(500,function(){this.paletteLabel.destroy()},this),this.time.events.add(1250,function(){this.tutorialOngoing=!1},this),this.inputLockTime=this.time.time+1500,this.image.filters=null,this.image.bringToTop(),this.world.bringToTop(this.effectGroup),dataStorage.isAudio&&this.time.events.add(50,function(){this.soundEffects.play("good")},this),this.time.events.add(300,function(){this.showText(null,Text.PuzzleSolved)},this),this.time.events.add(1e3,function(){this.clickToEnd=!0;var t=this.add.text(this.world.centerX,3*this.world.centerY/2,this.hitToContinue,{font:"24px",fill:"#000000",wordWrap:!1,fontWeight:"normal",align:"center"});t.setShadow(1,1,"rgba(255,255,255,1)",1),t.anchor.set(.5)},this)},selectTile:function(t){if(!this.tweening&&(this.selectSprite||t.targetObject&&t.targetObject.sprite.id>=0))if(this.selectSprite){if(3===this.gameType){var e=this.input.x-this.dragX,i=this.input.y-this.dragY;this.selectSprite.x=this.startX+e/this.boardGroup.scale.x,this.selectSprite.y=this.startY+i/this.boardGroup.scale.y}}else if(t.targetObject.sprite.locked){this.inputLockTime=this.time.time+750,dataStorage.isAudio&&this.soundEffects.play("tak");var s=t.targetObject.sprite;s.x-=2,this.add.tween(s).to({x:s.xx+4},100,Phaser.Easing.Linear.None,!0,0,0,!0).onComplete.add(function(t){t.x=t.xx},this),this.showText(s,Text.TileAlreadyInPlace)}else this.selectSprite=t.targetObject.sprite,this.selectSprite.bringToTop(),this.add.tween(this.selectSprite.scale).to({x:1.1,y:1.1},50,Phaser.Easing.Linear.None,!0,0,0,!0),dataStorage.isAudio&&this.soundEffects.play("tik"),3===this.gameType&&(this.dragX=this.input.x,this.dragY=this.input.y,this.startX=this.selectSprite.x,this.startY=this.selectSprite.y)},countMisplaced:function(){return 4-this.gameType},checkComplete:function(){if(playLogicColors.countMisplaced.call(this)>0)return!1;this.inputLockTime=this.time.time+1500,this.image.alpha=1,this.image.bringToTop(),this.world.bringToTop(this.effectGroup),dataStorage.isAudio&&this.time.events.add(50,function(){this.soundEffects.play("good")},this),this.time.events.add(300,function(){this.showText(null,Text.PuzzleSolved)},this),this.time.events.add(1e3,function(){this.clickToEnd=!0;var t=this.add.text(this.world.centerX,3*this.world.centerY/2,this.hitToContinue,{font:"24px",fill:"#000000",wordWrap:!1,fontWeight:"normal",align:"center"});t.setShadow(1,1,"rgba(255,255,255,1)",1),t.anchor.set(.5)},this)},createLevel:function(){this.image&&this.image.destroy(),this.image=this.add.image(this.game.world.centerX,this.game.world.centerY,mainState.image),this.image.anchor.set(.5),this.createPuzzle(),bootState.app?(this.playerLives=localStorage.getItem("picturepuzzleLives")||"3",this.playerLives=parseInt(this.playerLives)):this.playerLives=3,this.totalMoves=this.moves},moveTile:function(t){t.x=this.game.width/2+this.dx*t.xPos,t.y=this.game.height/2+this.dy*t.yPos,t.x+=t.width/2,t.y+=t.height/2,t.xx=t.x,t.yy=t.y},calcLevel:function(){for(var t=1,e=0,i=mainState.difficulty+1,s=0;s<mainState.chapter.level;s++)e===t?(t-0==1&&t<i&&t++,e=0):e++;return e},getPalette:function(t,e,i){return(new ColorThief).getPalette(e,t,10,i)},createPoints:function(t,e,i){var s=this.game.width/10;s>52&&(s=52);var a=this.game.height/10;a<52&&(s=a),this.blockSize=s,e||(e=10);for(var o=Math.floor((this.game.width-t*i*(s+e))/2),h=this.labelY,r=[],n=0;n<t;n++)r.push(new Phaser.Point(o,h)),o+=s+e;return r},rand:function(t){for(var e=t.length-1;e>=0;e--){var i=playState.rnd.integerInRange(0,e),s=t[e];t[e]=t[i],t[i]=s}return t},pickColor:function(t){var e,i,s=copy(t);switch(this.level){case 0:i=.4;break;case 1:i=.35;break;case 2:i=.3;break;case 3:i=.25;break;case 4:i=.2;break;case 5:i=.15;break;default:i=.1}do{s.h=Math.random(),(e=t.h<s.h?s.h-t.h:t.h-s.h)>.5&&(e=1-e)}while(e<i);return s},createMainColor:function(t){this.backGroup=this.add.group(),this.staticTiles=this.add.group(),this.tiles=this.add.group();var e=playLogicColors.createPoints.call(this,t.length,10,1),i=[],s=[];for(r=0;r<e.length;r++)s.push(e[r]);for(s=playLogicColors.rand(s),r=0;r<s.length;r++)i.push(s[r]);this.blockSize;t[0].s<.3&&(t[0].s+=(.5-t[0].s)/2),t[0].l<.3&&(t[0].l+=(.5-t[0].l)/2);this.game.width;var a=.125*-(t.length-1)/2,o=[];for(r=0;r<t.length;r++)o.push(a+.125*r);do{var h=0;playLogicColors.rand(o);for(var r=0;r<o.length;r++)o[r]>o[r+1]&&h++}while(h<2);for(r=0;r<t.length;r++){var n=t[r];r>0&&(n=playLogicColors.pickColor.call(this,t[0]));var l=Phaser.Color.HSLtoRGB(n.h,n.s,n.l);Phaser.Color.componentToHex(l.r),Phaser.Color.componentToHex(l.g),Phaser.Color.componentToHex(l.b);a=o[r],sprite=this.boardGroup.addSprite("button-white.png",a,.1);var d="0x"+Phaser.Color.componentToHex(l.r)+Phaser.Color.componentToHex(l.g)+Phaser.Color.componentToHex(l.b);sprite.tint=d,sprite.anchor.set(.5),sprite.inputEnabled=!0,sprite.input.useHandCursor=!0,sprite.input.bringToTop=!0,sprite.id=r+1}},createGame:function(t){this.boardGroup.removeAll(),this.gameType=t;var e,i=t,s=playState.hues,a=this.game.height/16;a>32&&(a=32);this.labelY=i/4*this.game.height;if(1===i?(e=Text.mainColor,-.3,this.paletteLabel=this.boardGroup.addText(e,0,-.05,"ffffff",48),this.paletteLabel.anchor.x=.5,this.paletteLabel.setShadow(2,2,"#000000",2)):2===i?(this.paletteLabel.text=Text.bestSwatch,this.paletteLabel.revive(),this.paletteLabel.alpha=1,-.1):(this.paletteLabel.text=Text.rainbowlike,this.paletteLabel.revive(),this.paletteLabel.alpha=1,.15),1===i)playLogicColors.createMainColor.call(this,copy(s));else if(2===i)playLogicColors.createPalette.call(this,copy(s));else{var o=this.add.filter("Gray");this.image.filters=[o],playLogicColors.createColors.call(this,s)}this.image.sendToBack()},createPalette:function(t){var e;t.length--,this.backGroup=this.add.group(),this.staticTiles=this.add.group(),this.tiles=this.add.group();var i=playLogicColors.createPoints.call(this,t.length-1,1,3),s=[],a=[];for(e=0;e<i.length;e++)a.push(i[e]);for(a=playLogicColors.rand(a),e=0;e<a.length;e++)s.push(a[e]);this.blockSize,t[0].h;var o=[0,1,2];playLogicColors.rand(o);for(var h=0,r=-8*h/2-.05,n=0;n<3;n++){this.game.width;h=(o[n]-1)/3;var l=this.boardGroup.addSprite("swatch-bg.png",h,.1);for(l.inputEnabled=!0,l.input.useHandCursor=!0,l.id=n+1,r=-l.height/2,e=1;e<t.length;e++){var d=t[e];n>0&&(d=playLogicColors.pickColor(d));var p,c=Phaser.Color.HSLtoRGB(d.h,d.s,d.l),u="0x"+Phaser.Color.componentToHex(c.r)+Phaser.Color.componentToHex(c.g)+Phaser.Color.componentToHex(c.b);p=makeSprite(this.game,"button-black.png",r,0),l.addChild(p),p.tint=u,p.anchor.set(.5);var g=mainState.difficulty+1;r+=l.height/g,3===e&&(r+=.05),p.id=n+1}this.blockSize}},createColors:function(t){this.colorMoves=3,t.sort(function(t,e){return t.h>e.h?1:t.h<e.h?-1:0}),this.backGroup=this.add.group(),this.staticTiles=this.add.group(),this.tiles=this.add.group();var e=playLogicColors.createPoints.call(this,t.length,10,1),i=[];i.push(e[0]);var s=[];for(h=1;h<e.length;h++)s.push(e[h]);var a=!1;do{s=playLogicColors.rand(s);for(var o=0,h=0;h<s.length;h++){if(s[h].x<o){a=!0;break}o=s[h].x}}while(!a);for(h=0;h<s.length;h++)i.push(s[h]);this.blockSize;var r,n=1-t[t.length-1].h+t[0].h,l=0;for(h=1;h<t.length;h++)t[h].h-t[h-1].h>n&&(n=t[h].h-t[h-1].h,l=h);var d=.125*-(t.length-1)/2,p=[];for(h=1;h<t.length;h++)p.push(d+.125*h);do{var c=0;playLogicColors.rand(p);for(h=0;h<p.length-1;h++)p[h]>p[h+1]&&c++}while(c<2);for(h=l,r=0;r<t.length;r++,h++){h>=t.length&&(h=0);var u=t[h];u.s<.5&&(u.s+=(.6-u.s)/2),u.l<.5&&(u.l+=(.6-u.l)/2),u.l>.7&&(u.l-=(u.l-.6)/2),u.l=.5;var g,m=Phaser.Color.HSLtoRGB(u.h,u.s,u.l),f=(Phaser.Color.componentToHex(m.r),Phaser.Color.componentToHex(m.g),Phaser.Color.componentToHex(m.b),"0x"+Phaser.Color.componentToHex(m.r)+Phaser.Color.componentToHex(m.g)+Phaser.Color.componentToHex(m.b));0===r?((g=this.boardGroup.addSprite("button-black.png",d,.1)).tint=f,g.anchor.set(.5)):(d=p[r-1],(g=this.boardGroup.addSprite("button-white.png",d,.1)).tint=f,g.anchor.set(.5),g.inputEnabled=!0,g.input.useHandCursor=!0,g.input.bringToTop=!0,g.xx=g.x,g.yy=g.y),g.id=r+1}},createPuzzle:function(t){var e=this.cache.getImage(mainState.image),i=this.make.bitmapData(e.width,e.height);i.draw(e),i.update();var s=this.level+3;s>5&&(s=5),s=4,this.level,s=mainState.difficulty+4;for(var a=playLogicColors.getPalette(s,i.imageData,e.width*e.height),o=[],h=0;h<a.length;h++){var r=a[h],n=Phaser.Color.RGBtoHSL(r[0],r[1],r[2]);n.r=r[0],n.g=r[1],n.b=r[2],o.push(n)}this.hues=o,playLogicColors.createGame.call(this,1)}};function removeScore(t,e){for(var i=0;i<t.scores.length;i++)if(parseInt(e.chapter)===parseInt(t.scores[i].chapter))return void t.scores.splice(i,1)}playGridJigsaw={gameID:1,type:Text.JigsawPuzzle,tutorial:!1,scoresLandscape:[{chapter:"523016",level:0,progress:0},{chapter:"379486",level:0,progress:0},{chapter:"522963",level:0,progress:0},{chapter:"522342",level:0,progress:0},{chapter:"bw4rb07ryhI",level:0,progress:0},{chapter:"GjUDzlyeMHc",level:0,progress:0},{chapter:"560557",level:0,progress:0},{chapter:"hMJOL917PiM",level:0,progress:0},{chapter:"484937",level:0,progress:0},{chapter:"522390",level:0,progress:0},{chapter:"VWxeBWSDl14",level:0,progress:0},{chapter:"615718",level:0,progress:0},{chapter:"523009",level:0,progress:0},{chapter:"522965",level:0,progress:0},{chapter:"484541",level:0,progress:0}],scoresPortrait:[{chapter:"9ezD-KvnDUY",level:0,progress:0},{chapter:"Ubp6NroqrHE",level:0,progress:0},{chapter:"tkGYzb4ar40",level:0,progress:0},{chapter:"kS1UetVyIgA",level:0,progress:0},{chapter:"H3JPnpyawFc",level:0,progress:0},{chapter:"HAT2BYXEz4M",level:0,progress:0},{chapter:"bBtAg-irXyU",level:0,progress:0},{chapter:"dLypgKFm5to",level:0,progress:0},{chapter:"0eNbJTCjaSQ",level:0,progress:0},{chapter:"lwHsTTDiyMc",level:0,progress:0},{chapter:"QOQZoaVwrRw",level:0,progress:0},{chapter:"TwzCMIS0A-k",level:0,progress:0},{chapter:"TEHGZqyEKmg",level:0,progress:0},{chapter:"ywiIfzY9Urc",level:0,progress:0},{chapter:"SNDzuyiOC6A",level:0,progress:0}],setOrientation:function(t){console.log(t),this.scores="Landscape"===t?this.scoresLandscape:this.scoresPortrait},setChapter:function(t){this.playScore=t;for(var e=0;e<this.scores.length;e++)if(parseInt(t.chapter)===parseInt(this.scores[e].chapter))return t.level=Math.max(t.level,this.scores[e].level),t.progress=Math.max(t.progress,this.scores[e].progress),this.scores[e];return this.scores.push({chapter:t.chapter,level:t.level,progress:t.progress}),this.lastChapter()},addChapter:function(t){if(parseInt(t.chapter)!==parseInt(this.playScore)){(t.level>0||t.progress>0)&&(this.tutorial=!1),this.scores||(this.scores=this.scoresLandscape);for(var e=0;e<this.scores.length;e++)if(parseInt(t.chapter)===parseInt(this.scores[e].chapter))return void(t.level>this.scores[e].level?(this.scores[e].level=t.level,t.progress>=0&&(this.scores[e].progress=t.progress)):t.level===this.scores[e].level&&t.progress>this.scores[e].progress&&t.progress>=0&&(this.scores[e].progress=t.progress));t.level||(t.level=0),t.progress||(t.progress=0),this.scores.push({chapter:t.chapter,level:t.level,progress:t.progress})}},firstChapter:function(){return this.scores[0]},lastChapter:function(){return this.scores[this.scores.length-1]},nextChapter:function(t){for(var e=0;e<this.scores.length-1;e++)if(parseInt(this.scores[e].chapter)===parseInt(t))return this.scores[e+1];return null},prevChapter:function(t){for(var e=this.scores.length-1;e>=0;e--)if(parseInt(this.scores[e].chapter)===parseInt(t))return this.scores[e-1];return null},levels:[],shuffleNoApp:function(t,e){var i;switch(e){case 0:t.cols=2,t.rows=2,i=[[[1,2],[3,0]],[[3,0],[1,2]],[[1,3],[0,2]],[[2,0],[3,1]]];break;case 1:t.cols=3,t.rows=3,i=[[[2,0,1],[4,5,3],[8,6,7]],[[7,3,6],[1,8,4],[2,0,5]],[[8,7,1],[5,2,4],[0,3,6]],[[5,7,3],[2,0,6],[4,8,1]],[[7,5,6],[8,2,0],[4,3,1]]];break;case 2:t.cols=4,t.rows=4,i=[[[6,13,5,15],[14,9,12,3],[4,11,2,7],[0,10,8,1]],[[6,13,5,15],[14,9,12,3],[4,11,2,7],[0,10,8,1]],[[8,11,15,6],[2,7,13,1],[9,12,3,0],[14,4,10,5]],[[7,8,5,14],[13,15,9,6],[3,12,2,4],[10,1,0,11]],[[5,3,6,13],[15,11,4,0],[12,14,1,10],[8,7,2,9]]];break;case 3:t.cols=5,t.rows=5,i=[[[6,18,5,16,24],[17,14,22,9,3],[21,4,2,23,13],[19,10,8,20,0],[1,11,12,7,15]],[[16,13,19,15,23],[14,22,12,3,20],[4,11,21,17,8],[0,24,18,1,5],[7,2,9,6,10]],[[8,11,15,6,16],[19,21,13,18,23],[22,12,3,17,20],[14,4,10,5,2],[1,7,24,0,9]],[[7,17,24,14,18],[13,20,9,6,19],[23,12,16,21,11],[10,1,0,2,22],[15,4,8,3,5]],[[18,23,19,13,1],[15,11,24,20,14],[22,17,16,10,5],[8,21,2,9,6],[0,7,12,4,3]]]}return i},shuffle:function(t,e){var i;if(e<22)return this.shuffleNoApp(t,e);switch(e){case 22:t.cols=2,t.rows=2,i=[[[1,3],[0,2]],[[2,0],[3,1]],[[3,2],[1,0]]];break;case 32:playState.game.width>playState.game.height?(t.cols=3,t.rows=2,i=[[[1,0,3],[2,5,4]],[[5,2,4],[1,3,0]],[[1,3,0],[2,5,4]],[[4,2,5],[1,0,3]],[[2,5,1],[4,3,0]],[[4,3,0],[5,2,1]]]):(t.cols=2,t.rows=3,i=[[[5,2],[3,4],[1,0]],[[4,3],[5,1],[2,0]],[[2,5],[0,4],[3,1]],[[5,0],[4,2],[3,1]],[[3,5],[1,4],[0,2]],[[3,2],[4,1],[5,0]]]);break;case 42:playState.game.width>playState.game.height?(t.cols=4,t.rows=2,i=[[[2,4,1,6],[7,3,0,5]],[[7,3,4,6],[1,0,2,5]],[[4,6,5,1],[2,0,7,3]],[[7,4,6,2],[0,5,3,1]],[[5,7,3,0],[4,2,1,6]],[[3,7,1,6],[5,2,4,0]]]):(t.cols=2,t.rows=4,i=[[[2,6],[1,4],[7,0],[3,5]],[[7,3],[4,6],[1,0],[2,5]],[[5,7],[3,6],[2,0],[1,4]],[[7,4],[6,2],[0,5],[3,1]],[[3,7],[4,2],[6,0],[1,5]],[[3,7],[1,6],[5,2],[4,0]]]);break;case 33:t.cols=3,t.rows=3,i=[[[4,2,6],[5,8,0],[1,3,7]],[[8,3,6],[1,7,4],[2,0,5]],[[8,7,4],[5,2,1],[0,3,6]],[[5,7,6],[2,0,3],[4,8,1]],[[7,3,6],[8,5,0],[2,4,1]]];break;case 43:playState.game.width>playState.game.height?(t.cols=4,t.rows=3,i=[[[6,5,1,9],[2,0,11,8],[4,7,3,10]],[[9,3,11,7],[1,10,4,8],[2,6,0,5]],[[10,3,8,11],[5,2,4,0],[1,7,6,9]],[[5,7,3,0],[11,2,10,6],[4,8,1,9]],[[2,5,11,8],[10,7,0,4],[9,3,1,6]]]):(t.cols=3,t.rows=4,i=[[[9,5,1],[6,2,0],[11,8,4],[7,3,10]],[[9,3,11],[7,1,10],[4,8,5],[6,0,2]],[[10,3,8],[11,5,2],[1,4,0],[7,6,9]],[[5,7,3],[0,11,2],[10,6,4],[8,1,9]],[[2,5,11],[8,10,7],[9,4,0],[3,1,6]]]);break;case 53:t.cols=5,t.rows=3,i=[[[12,9,13,7,2],[14,4,1,11,5],[6,8,0,10,3]],[[9,3,6,7,11],[14,10,13,12,4],[8,0,2,5,1]],[[8,7,1,11,6],[14,12,10,13,0],[4,2,3,9,5]],[[13,7,3,0,9],[11,12,10,6,2],[14,8,1,5,4]],[[7,5,11,4,8],[3,14,0,12,10],[9,13,1,6,2]]];break;case 44:t.cols=4,t.rows=4,i=[[[6,13,5,15],[14,9,12,3],[4,11,2,7],[0,10,8,1]],[[8,11,15,6],[2,7,13,1],[9,12,3,0],[14,4,10,5]],[[4,8,5,14],[10,2,0,11],[13,15,9,6],[3,12,1,7]],[[5,3,14,6],[15,13,4,11],[12,7,1,10],[8,0,2,9]]];break;case 54:t.cols=5,t.rows=4,i=[[[6,19,4,17,15],[16,14,12,9,2],[1,5,3,7,11],[18,10,8,13,0]],[[17,13,19,15,11],[14,7,2,1,12],[4,6,9,16,8],[0,10,18,3,5]],[[8,11,15,5,17],[18,7,13,19,0],[9,12,1,16,3],[14,4,10,6,2]],[[7,18,5,12,17],[14,16,1,6,19],[3,13,15,4,10],[11,9,0,2,8]],[[17,7,19,12,5],[16,9,4,0,14],[13,18,15,10,2],[3,6,1,11,8]]];case 55:t.cols=5,t.rows=5,i=[[[6,18,5,16,24],[17,14,22,9,3],[21,4,2,23,13],[19,10,8,20,0],[1,11,12,7,15]],[[16,13,19,15,23],[14,22,12,3,20],[4,11,21,17,8],[0,24,18,1,5],[7,2,9,6,10]],[[8,11,15,6,16],[19,21,13,18,23],[22,12,3,17,20],[14,4,10,5,2],[1,7,24,0,9]],[[7,17,24,14,18],[13,20,9,6,19],[23,12,16,21,11],[10,1,0,2,22],[15,4,8,3,5]],[[18,23,19,13,1],[15,11,24,20,14],[22,17,16,10,5],[8,21,2,9,6],[0,7,12,4,3]]]}return i},nextScore:function(t){for(var e=0;e<this.scores.length-1;e++)if(parseInt(this.scores[e].chapter)===parseInt(t))return this.scores[e+1];return null}},playGridSliding={gameID:3,type:Text.SlidingPuzzle,tutorial:!0,scores:[{chapter:201310,level:0,progress:0}],setChapter:function(t){this.playScore=t;for(var e=0;e<this.scores.length;e++)if(parseInt(t.chapter)===parseInt(this.scores[e].chapter))return t.level=Math.max(t.level,this.scores[e].level),t.progress=Math.max(t.progress,this.scores[e].progress),this.scores[e];return this.scores.push({chapter:t.chapter,level:t.level,progress:t.progress}),this.lastChapter()},addChapter:function(t){if(parseInt(t.chapter)!==parseInt(this.playScore)){(t.level>0||t.progress>0)&&(this.tutorial=!1);for(var e=0;e<this.scores.length;e++)if(parseInt(t.chapter)===parseInt(this.scores[e].chapter))return void(t.level>this.scores[e].level?(this.scores[e].level=t.level,t.progress>=0&&(this.scores[e].progress=t.progress)):t.level===this.scores[e].level&&t.progress>this.scores[e].progress&&t.progress>=0&&(this.scores[e].progress=t.progress));t.level||(t.level=0),t.progress||(t.progress=0),this.scores.push({chapter:t.chapter,level:t.level,progress:t.progress})}},firstChapter:function(){return this.scores[0]},lastChapter:function(){return this.scores[this.scores.length-1]},nextChapter:function(t){for(var e=0;e<this.scores.length-1;e++)if(parseInt(this.scores[e].chapter)===parseInt(t))return this.scores[e+1];return null},prevChapter:function(t){for(var e=this.scores.length-1;e>=0;e--)if(parseInt(this.scores[e].chapter)===parseInt(t))return this.scores[e-1];return null},levels:[],shuffle:function(t,e){var i;switch(e){case 0:t.cols=2,t.rows=2,i=[[[3,0],[2,1]],[[3,0],[2,1]],[[0,3],[2,1]],[[3,1],[0,2]]];break;case 1:t.cols=3,t.rows=3,i=[[[1,4,8],[0,2,7],[3,6,5]],[[8,0,5],[3,6,4],[7,2,1]],[[0,5,1],[6,8,2],[4,3,7]],[[1,2,8],[6,3,5],[4,0,7]],[[7,1,8],[0,4,2],[3,5,6]]];break;case 2:t.cols=4,t.rows=4,i=[[[4,7,13,5],[15,0,6,14],[12,2,1,10],[11,8,9,3]],[[7,12,14,1],[0,2,6,5],[13,9,15,3],[11,4,10,8]],[[5,6,15,1],[9,12,8,11],[13,0,4,2],[14,7,10,3]],[[9,6,12,10],[7,4,15,11],[2,5,0,14],[13,3,1,8]],[[3,0,1,2],[5,7,14,8],[15,10,9,13],[11,12,4,6]]];break;case 3:t.cols=5,t.rows=5,i=[[[16,6,8,1,3],[17,7,23,10,11],[12,20,22,24,9],[14,5,13,4,21],[18,0,15,2,19]],[[21,24,14,18,9],[16,1,19,12,3],[10,5,17,6,2],[11,7,23,13,0],[15,8,4,20,22]],[[0,19,20,3,7],[11,2,15,13,24],[5,9,14,8,4],[10,6,1,21,23],[17,18,22,12,16]],[[22,21,23,1,24],[19,12,0,5,9],[13,10,6,3,4],[15,16,17,18,8],[7,20,2,11,14]],[[7,13,18,12,3],[0,2,8,16,1],[21,22,11,6,23],[10,4,9,20,19],[15,24,14,17,5]]]}return i},nextScore:function(t){for(var e=0;e<this.scores.length-1;e++)if(parseInt(this.scores[e].chapter)===parseInt(t))return this.scores[e+1];return null}},playGridRolling={gameID:2,type:Text.RollingPuzzle,tutorial:!0,scores:[{chapter:486083,level:0,progress:0}],setChapter:function(t){this.playScore=t;for(var e=0;e<this.scores.length;e++)if(parseInt(t.chapter)===parseInt(this.scores[e].chapter))return t.level=Math.max(t.level,this.scores[e].level),t.progress=Math.max(t.progress,this.scores[e].progress),this.scores[e];return this.scores.push({chapter:t.chapter,level:t.level,progress:t.progress}),this.lastChapter()},addChapter:function(t){if(parseInt(t.chapter)!==parseInt(this.playScore)){(t.level>0||t.progress>0)&&(this.tutorial=!1);for(var e=0;e<this.scores.length;e++)if(parseInt(t.chapter)===parseInt(this.scores[e].chapter))return void(t.level>this.scores[e].level?(this.scores[e].level=t.level,t.progress>=0&&(this.scores[e].progress=t.progress)):t.level===this.scores[e].level&&t.progress>this.scores[e].progress&&t.progress>=0&&(this.scores[e].progress=t.progress));t.level||(t.level=0),t.progress||(t.progress=0),this.scores.push({chapter:t.chapter,level:t.level,progress:t.progress})}},firstChapter:function(){return this.scores[0]},lastChapter:function(){return this.scores[this.scores.length-1]},nextChapter:function(t){for(var e=0;e<this.scores.length-1;e++)if(parseInt(this.scores[e].chapter)===parseInt(t))return this.scores[e+1];return null},prevChapter:function(t){for(var e=this.scores.length-1;e>=0;e--)if(parseInt(this.scores[e].chapter)===parseInt(t))return this.scores[e-1];return null},levels:[],shuffle2:function(t,e){},shuffle:function(t,e){var i;switch(e){case 0:t.cols=2,t.rows=2,i=[[[1,1],[1,0]],[[1,0],[1,1]],[[1,1],[0,1]],[[0,1],[1,1]]];break;case 1:t.cols=3,t.rows=3,i=[[[1,0,1],[0,1,1],[1,0,1]],[[0,1,1],[1,0,1],[1,0,1]],[[1,0,1],[1,1,0],[1,0,1]],[[0,1,1],[1,1,1],[0,1,0]],[[1,1,1],[0,1,0],[1,1,0]]];break;case 2:t.cols=4,t.rows=4,i=[[[1,0,1,1],[0,1,0,1],[1,0,1,1],[0,1,1,0]],[[0,1,1,0],[0,1,1,1],[0,1,1,1],[1,0,1,0]],[[0,1,0,1],[1,0,1,1],[1,1,1,0],[0,0,1,1]],[[0,0,1,1],[1,1,0,1],[0,1,1,0],[1,1,0,1]],[[1,0,0,1],[1,1,1,0],[1,0,0,1],[0,1,1,1]]];break;case 3:t.cols=5,t.rows=5,i=[[[1,0,1,1,0],[1,0,1,1,0],[1,1,1,0,1],[0,1,1,1,0],[1,0,1,1,1]],[[1,0,1,0,1],[1,0,1,1,0],[1,1,0,1,1],[1,0,1,0,1],[1,1,0,1,1]],[[1,1,0,1,1],[0,1,1,0,1],[1,1,1,1,0],[0,1,0,1,1],[1,1,1,0,0]],[[1,0,1,1,1],[1,1,1,0,0],[0,1,1,1,1],[1,0,1,1,0],[1,0,1,0,1]],[[0,1,1,1,0],[0,1,1,1,1],[1,0,1,1,1],[0,1,1,0,1],[1,0,1,1,0]]];break;case 4:t.cols=6,t.rows=6,i=[[[1,0,1,1,1,1],[1,1,0,1,1,0],[1,0,1,0,1,1],[1,0,1,1,1,0],[1,1,0,1,0,1],[1,0,1,1,0,1]],[[1,0,1,1,0,1],[1,0,1,1,1,1],[1,1,0,0,1,1],[1,1,0,1,0,1],[1,1,0,1,0,1],[0,1,1,1,0,1]],[[1,1,1,0,1,0],[0,1,1,1,0,1],[1,1,1,1,1,0],[0,1,1,0,1,1],[1,1,1,0,1,0],[1,0,0,1,1,1]],[[1,1,0,0,1,1],[1,1,1,0,1,0],[0,1,1,1,0,1],[1,0,1,1,1,1],[1,0,1,1,0,1],[1,1,1,1,0,0]],[[0,1,1,1,1,0],[1,0,1,1,0,1],[1,0,1,0,1,1],[0,1,1,1,0,1],[1,1,0,1,1,0],[1,1,0,1,1,1]]];break;case 5:t.cols=7,t.rows=7,i=[[[1,1,1,1,0,0,1],[1,1,0,1,1,1,0],[1,1,0,1,0,1,1],[1,1,1,0,1,0,1],[1,1,1,0,1,0,1],[1,0,1,1,1,0,1],[1,0,1,1,0,1,1]],[[1,0,1,1,1,0,1],[1,0,0,1,1,1,1],[1,1,0,1,0,1,1],[1,1,0,1,1,1,0],[1,1,0,1,1,0,1],[1,1,0,1,1,0,1],[1,1,1,0,1,0,1]],[[1,1,1,1,0,1,0],[0,1,1,1,1,0,1],[1,1,1,0,0,1,1],[0,1,1,1,0,1,1],[1,0,1,1,1,0,1],[1,1,1,1,0,1,0],[1,1,0,1,0,1,1]],[[1,1,0,1,0,1,1],[1,1,1,0,1,1,0],[0,1,1,1,1,0,1],[1,1,0,1,1,1,0],[1,1,1,0,0,1,1],[1,1,0,0,1,1,1],[1,1,1,1,0,0,1]],[[0,1,1,1,1,1,0],[1,0,1,1,1,0,1],[1,0,1,1,0,1,1],[0,1,1,1,1,0,1],[1,1,0,1,1,1,0],[1,0,1,0,1,1,1],[1,1,0,0,1,1,1]]];break;case 6:t.cols=8,t.rows=8,i=[[[1,0,1,0,1,0,1,1],[1,1,0,1,0,1,0,1],[1,0,1,1,1,0,1,0],[1,1,1,0,1,0,1,1],[1,1,0,1,0,1,1,1],[0,1,1,1,1,0,0,1],[0,1,1,1,1,0,1,1],[1,1,1,0,1,0,1,0]],[[1,0,1,0,1,0,1,1],[1,0,1,1,1,0,1,0],[0,1,1,0,1,1,1,1],[1,1,0,1,0,1,1,1],[1,1,0,1,1,0,1,1],[1,1,0,0,1,0,1,1],[1,1,0,1,1,0,0,1],[1,1,0,1,1,0,1,0]],[[1,1,0,1,1,0,1,0],[0,1,1,0,1,0,1,1],[1,1,0,1,0,1,0,1],[0,1,1,1,1,1,0,1],[1,1,1,1,0,1,0,1],[1,0,1,0,1,1,1,0],[0,1,1,0,1,1,1,0],[1,0,1,1,1,0,0,1]],[[1,1,0,1,1,1,1,0],[1,1,1,0,1,0,1,0],[0,1,1,1,0,1,1,1],[1,1,0,1,1,0,1,0],[0,1,1,0,1,1,1,1],[0,1,0,1,1,0,1,1],[1,0,1,1,0,1,1,0],[0,0,1,1,0,0,1,1]],[[0,1,0,1,0,1,1,1],[1,1,0,1,1,1,0,1],[1,0,1,1,1,0,1,1],[1,0,1,1,1,0,0,1],[1,0,1,1,1,0,1,0],[1,1,0,0,1,1,0,1],[1,1,0,0,1,0,1,1],[0,1,1,0,1,0,1,1]]]}return i},nextScore:function(t){for(var e=0;e<this.scores.length-1;e++)if(parseInt(this.scores[e].chapter)===parseInt(t))return this.scores[e+1];return null}},playGridColor={gameID:4,type:Text.ColorPuzzle,tutorial:!0,scores:[{chapter:530903,level:0,progress:0}],setChapter:function(t){this.playScore=t;for(var e=0;e<this.scores.length;e++)if(parseInt(t.chapter)===parseInt(this.scores[e].chapter))return t.level=Math.max(t.level,this.scores[e].level),t.progress=Math.max(t.progress,this.scores[e].progress),this.scores[e];return this.scores.push({chapter:t.chapter,level:t.level,progress:t.progress}),this.lastChapter()},addChapter:function(t){if(parseInt(t.chapter)!==parseInt(this.playScore)){(t.level>0||t.progress>0)&&(this.tutorial=!1);for(var e=0;e<this.scores.length;e++)if(parseInt(t.chapter)===parseInt(this.scores[e].chapter))return void(t.level>this.scores[e].level?(this.scores[e].level=t.level,t.progress>=0&&(this.scores[e].progress=t.progress)):t.level===this.scores[e].level&&t.progress>this.scores[e].progress&&t.progress>=0&&(this.scores[e].progress=t.progress));t.level||(t.level=0),t.progress||(t.progress=0),this.scores.push({chapter:t.chapter,level:t.level,progress:t.progress})}},firstChapter:function(){return this.scores[0]},lastChapter:function(){return this.scores[this.scores.length-1]},nextChapter:function(t){for(var e=0;e<this.scores.length-1;e++)if(parseInt(this.scores[e].chapter)===parseInt(t))return this.scores[e+1];return null},prevChapter:function(t){for(var e=this.scores.length-1;e>=0;e--)if(parseInt(this.scores[e].chapter)===parseInt(t))return this.scores[e-1];return null},levels:[],shuffle:function(t,e){var i;switch(e){case 0:t.cols=2,t.rows=2,i=[[[1,2],[3,0]],[[3,0],[1,2]],[[1,3],[0,2]],[[2,0],[3,1]]];break;case 1:t.cols=3,t.rows=3,i=[[[2,0,1],[4,5,3],[8,6,7]],[[7,3,6],[1,8,4],[2,0,5]],[[8,7,1],[5,2,4],[0,3,6]],[[5,7,3],[2,0,6],[4,8,1]],[[7,5,6],[8,2,0],[4,3,1]]];break;case 2:t.cols=4,t.rows=4,i=[[[6,13,5,15],[14,9,12,3],[4,11,2,7],[0,10,8,1]],[[6,13,5,15],[14,9,12,3],[4,11,2,7],[0,10,8,1]],[[8,11,15,6],[2,7,13,1],[9,12,3,0],[14,4,10,5]],[[7,8,5,14],[13,15,9,6],[3,12,2,4],[10,1,0,11]],[[5,3,6,13],[15,11,4,0],[12,14,1,10],[8,7,2,9]]];break;case 3:t.cols=5,t.rows=5,i=[[[6,18,5,16,24],[17,14,22,9,3],[21,4,2,23,13],[19,10,8,20,0],[1,11,12,7,15]],[[16,13,19,15,23],[14,22,12,3,20],[4,11,21,17,8],[0,24,18,1,5],[7,2,9,6,10]],[[8,11,15,6,16],[19,21,13,18,23],[22,12,3,17,20],[14,4,10,5,2],[1,7,24,0,9]],[[7,17,24,14,18],[13,20,9,6,19],[23,12,16,21,11],[10,1,0,2,22],[15,4,8,3,5]],[[18,23,19,13,1],[15,11,24,20,14],[22,17,16,10,5],[8,21,2,9,6],[0,7,12,4,3]]]}return i},nextScore:function(t){for(var e=0;e<this.scores.length-1;e++)if(parseInt(this.scores[e].chapter)===parseInt(t))return this.scores[e+1];return null}};var volume=1,playState={buttonUp:!1,puzzleRandom:0,outOfMoves:!1,allDone:!1,selectTile1:null,selectTile2:null,entryInfo:function(){var t=mainState.chapter.data[mainState.chapter.level].description;t||(t=mainState.chapter.info.title),t.length>120&&(t=t.substr(0,120),t+="...");var e=mainState.chapter.level+1+" / "+mainState.chapter.info.total_photos,i=mainState.levelLabel.text,s=mainState.image;this.level&&(this.level.title&&(t=this.level.title),this.level.desc&&(i=this.level.desc),this.level.image&&(s=this.level.image)),this.popupGroup.showInfo(t,e,i,this.hitToStart,0,this,this.startCountdown,!1,s)},gameOver:function(t){if(bootState.app){var e=parseInt(localStorage.getItem(mainState.getOrientation()+"picturepuzzlelevelNo"+mainState.chapter.chapter))||0;return e++,localStorage.setItem(mainState.getOrientation()+"picturepuzzlelevelNo"+mainState.chapter.chapter,""+e),mainState.chapter.progress=1,mainState.chapter.level=e,void fadeOutEffect(this,16777215).onComplete.addOnce(function(){t&&e<20&&(mainState.goNextLevel=!0),this.backToMenu(),this.state.start("mainState")},this)}var i;(i=mainState.chapter.info.title).length>30&&(i=i.substr(0,30),i+="..."),this.playerLives>0?(++this.feedbackNo>=this.feedback.length-1&&(this.feedbackNo=0),this.feedback[this.feedbackNo],this.upgrade=!0,this.time.events.add(.1*Phaser.Timer.SECOND,function(){dataStorage.isAudio},this),this.inputLockTime=this.time.time+250):(i,i=Text.trytosolvewithoutguessing,this.level&&this.level.title&&this.level.title,this.time.events.add(.2*Phaser.Timer.SECOND,function(){this.startTime=0},this)),mainState.music,dataStorage.isAudio,this.playGrid.tutorial?(playState.upgrade=!1,this.playGrid.tutorial=!1):this.upgrade=!0,this.playerLives<=0&&(playState.upgrade=!1),mainState.chapter.progress=1,mainState.chapter.level++,dataStorage.saveScores(),fadeOutEffect(this,0).onComplete.addOnce(function(){this.backToMenu()},this)},releaseTile:function(t){if(this.buttonUp=!0,this.selectTile1,this.playLogic.releaseTile.call(this,t,this.selectTile1,this.selectTile2),this.selectTile1&&this.selectTile2)return this.selectTile1=null,this.selectTile2=null,this.graphics.visible=!1,void playState.playSound("tik");this.selectTile1&&this.selectTile1.drag&&(this.selectTile1=null,this.graphics.visible=!1)},selectTile:function(t,e){if(bootState.app&&this.headerGroup.showApp(!1),!this.graphics){this.graphics=this.game.add.graphics(),this.graphics.lineStyle(3,16711935,1);let t=this.playLogic.getSize.call(this);this.graphics.drawRect(-t.w/2,-t.h/2,t.w,t.h),this.graphics.visible=!1}var i=this.playLogic.selectTile.call(this,t,this.graphics);i?i!==this.selectTile1?this.selectTile1?(this.graphics.visible=!0,this.selectTile2=i):(this.selectTile1=i,this.selectTile1.addChild(this.graphics),this.time.events.add(10,function(){this.graphics.visible=!0},this),this.playSound("tik")):i===this.selectTile1&&this.buttonUp&&(this.inputLockTime=this.time.time+250,this.selectTile1=null,this.selectTile2=null,this.graphics.visible=!1,this.playSound("tik")):(this.selectTile1=null,this.selectTile2=null,this.graphics.visible=!1),this.buttonUp=!1},checkComplete:function(){this.playLogic.checkComplete.call(this)},createLevel:function(){this.playLogic.createLevel.call(this)},moveTile:function(t){this.playLogic.moveTile.call(this,t)},calcLevel:function(){this.playLogic.calcLevel.call(this)},createPuzzle:function(t){this.playLogic.createPuzzle.call(this,t)},renderBg:function(t){},arcadeSpeed:75,startGame:function(){if(this.level)for(var t=0;t<=this.level.id;t++)this.crafts[t].start(250*t);this.hasArcadePhysics&&(this.game.physics.arcade.isPaused=!1),this.startTime=this.time.time},name:"playState",hitToContinue:Text.PressToContinue,hitToStart:Text.PressToContinue,spriteAtlas:"atlas",level:null,feedbackNo:0,feedback:["Superb!","Perfect!","Excellent!","Brilliant!","Amazing!","Wonderful!","Fantastic!","Outstanding!"],upgrade:!1,swapLandscapeToPortrait:!0,hasArcadePhysics:!1,hasMusicLoop:!0,hasButton:!0,worldBounds:!1,allowOrientationChange:!0,scoreTip:Text.misplaced,scoreHealth:Text.loseLives,timeTip:"Time to run this level.",bpm:0,hasHealth:!0,resize:function(){if(bootState.app){if(!this.oldSize)return;var t=Math.abs(this.game.width-this.oldSize.width)/this.game.width,e=Math.abs(this.game.height-this.oldSize.height)/this.game.height;if(t>.2||e>.2)return console.log("layout change",t,e),void this.backToMenu()}if(!this.allowOrientationChange){var i=this.game.width>this.game.height?1:2;this.orientation!==i&&(this.backToMenu(),this.orientation=3)}var s=onResize.call(this,this.scale,{width:this.game.width,height:this.game.height});if(this.resizeSprites(s),this.helpText&&(this.helpText.fontSize=s*this.helpTextSize),this.worldBounds){this.player.sprite;var a=this.boardGroup.size.width,o=this.boardGroup.size.height,h=-a,r=-o,n=3*a,l=3*o;this.game.physics.arcade.setBounds(h,r,n,l)}this.renderBg(s)},resizeSprites:function(t){this.group&&this.group.forEach(function(t){this.moveTile(t)},this)},init:function(){this.game.input.touch.preventDefault=!0,this.playGrid=bootState.playGrid,this.playLogic=bootState.playLogic,this.playGrid===playGridSliding?this.hasHealth=!1:this.hasHealth=!0,this.tutorial=this.playGrid.tutorial,this.orientation=this.game.width>this.game.height?1:2,this.level=mainState.level,this.bestScore=0},preload:function(){if(bootState.isApp||this.load.image("banner","cache/banner.png"),bootState.app&&this.load.image(mainState.image),dataStorage.debug&&this.spriteAtlas)for(var t=this.game.cache.getFrameData(this.spriteAtlas).getFrames(),e=0;e<t.length;e++){var i=t[e].name;this.cache.checkImageKey(i)||this.load.image(i,"cache/"+this.spriteAtlas+"/"+i)}},playSound:function(t){if(bootState.sound&&this.soundEffects){var e=volume;if("good"===t)return;this.soundEffects.play(t,e)}},create:function(){if(bootState.app&&(mainState.nextImage&&(this.load.image(mainState.nextImage),this.load.start()),this.cache.checkSoundKey("sound-effects")&&(this.soundEffects=this.add.audioSprite("sound-effects"))),this.quit=!1,this.buttonUp=!1,this.puzzleRandom=0,this.outOfMoves=!1,this.allDone=!1,this.selectTile1=null,this.selectTile2=null,this.oldSize={width:this.game.width,height:this.game.height},this.allDone)return this.allDone=!1,void this.state.start("mainState");this.clickToEnd=!1,this.upgrade=!1,this.moveCount=0,this.saturn=new Phaser.Rectangle(0,0,160,160),this.game.canvas.oncontextmenu=function(t){t.preventDefault()},this.cache.checkSoundKey("sound-effects")?(this.soundEffects=this.add.audioSprite("sound-effects"),Object.keys&&Object.keys(this.soundEffects.sounds).forEach(function(t,e){this.soundEffects.sounds[t].allowMultiple=!0},this)):dataStorage.isAudio=!1,this.hasButton&&(this.space=this.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.cursors=this.input.keyboard.createCursorKeys()),this.hasArcadePhysics&&(this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.physics.arcade.isPaused=!0),this.effectGroup=new EffectGroup(this.game,{width:720,height:720},{width:720,height:720}),this.effectGroup.enable("sparkle"),this.createBoard(),this.createHeader(),this.createTutorial(),this.createPopup(),this.world.bringToTop(this.effectGroup),this.world.mask&&this.world.mask.destroy(),this.world.mask=null,this.helpTextSize=64;var t={font:this.helpTextSize+"px",fill:"#ffffff",wordWrap:!1,fontWeight:"bold",align:"center"};this.helpText=this.add.text(0,0,"",t),this.helpText.setShadow(2,2,"rgba(0,0,0,1)",2),this.helpText.anchor.set(.5),this.helpText.kill(),this.hasArcadePhysics&&(this.countSprite=this.boardGroup.addSprite("number-3.png",0,-.2).kill(),this.startedCoundDown=!1,this.start()),this.game.scale.setResizeCallback(this.onResize,this),this.crafts=[],this.resize(),bootState.app||(this.tutorial>0?this.showTutorial():this.entryInfo()),this.adbanner=null,"file:"===new URL(window.location).protocol?this.isApp=!0:this.isApp=!1,this.inputLockTime=this.time.time+250,bootState.app||mainState.loadNextLevel(this.game),this.time.events.add(.25*Phaser.Timer.SECOND,function(){"undefined"!=typeof webapp_ad&&this.time.events.add(1*Phaser.Timer.SECOND,function(){this.loadAd()},this)},this)},loadAd:function(){Android.loadAd()||this.time.events.add(1*Phaser.Timer.SECOND,function(){this.loadAd()},this)},adShown:function(t){if(this.problemDone)return this.loadAd(),void this.gameOver(!0,0);this.tipShown=!0,this.time.events.add(1*Phaser.Timer.SECOND,function(){this.loadAd()},this)},start:function(){this.hasButton&&(this.spaceKey=this.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.input.keyboard.addKeyCapture([Phaser.Keyboard.SPACEBAR])),this.isGameOver=!1,this.hasArcadePhysics&&(this.countdown=0),this.game.onPause.add(this.onPaused,this),this.game.onResume.add(this.onResumed,this)},onPaused:function(){this.orientation=4,this.backToMenu()},onResumed:function(){},stopCountdown:function(){if(this.countdown){if(this.countdown--,1===this.countdown)return;switch(this.countSprite.alpha=1,this.countdown){case 4:this.countSprite.revive(),this.boardGroup.setTexture(this.countSprite,"number-3.png");break;case 3:this.boardGroup.setTexture(this.countSprite,"number-2.png");break;case 2:this.boardGroup.setTexture(this.countSprite,"number-1.png")}this.add.tween(this.countSprite).to({alpha:0},500,Phaser.Easing.Linear.None,!0)}else this.countdown=5,dataStorage.isAudio;this.countdown>1&&this.time.events.add(750,function(){this.stopCountdown()},this)},startCountdown:function(){if(this.startMusic(),this.hasArcadePhysics){if(this.countdown){switch(this.countdown--,this.countSprite.alpha=1,this.countdown){case 4:this.countSprite.revive(),this.boardGroup.setTexture(this.countSprite,"number-3.png");break;case 3:this.boardGroup.setTexture(this.countSprite,"number-2.png");break;case 2:this.boardGroup.setTexture(this.countSprite,"number-1.png");break;case 1:return dataStorage.isMusic&&dataStorage.isAudio,void(this.hasArcadePhysics&&this.startGame())}this.add.tween(this.countSprite).to({alpha:0},500,Phaser.Easing.Linear.None,!0)}else this.countdown=2,this.player.enter();this.time.events.add(500,function(){this.startCountdown()},this)}},resume:function(){this.popupGroup.pausedTime&&(this.pausedTime=this.time.time-this.popupGroup.pausedTime,this.startTime+=this.pausedTime),this.hasArcadePhysics&&(this.game.physics.arcade.isPaused=!1)},createPopup:function(){this.popupGroup=new PopupGroup(this.game,{width:this.game.width,height:this.game.height}),this.popupGroup.enable("info"),this.popupGroup.enable("popup-banner.png"),this.popupGroup.enable("popup-dialog-quit.png")},createTutorial:function(){this.tutorialGroup=new TutorialGroup(this.game,{width:this.game.width,height:this.game.height}),this.tutorialGroup.enable("popup-hand.png")},update:function(){if(!this.quit){if(this.hasArcadePhysics&&!this.game.physics.arcade.isPaused&&this.checkVictory())return this.game.physics.arcade.isPaused=!0,this.inputLockTime=this.time.time+1e3,void this.time.events.add(150,function(){this.gameWin()},this);if(this.hasArcadePhysics&&!this.game.physics.arcade.isPaused){if(this.game.physics.arcade.overlap(this.boardGroup,this.boardGroup.foeGroup,this.overlap,null,this))return;for(var t=!1,e=0;e<this.crafts.length-1;e++){var i=this.crafts[e],s=this.crafts[e+1];i.sprite.tractorBeamLockedDir||s.sprite.tractorBeamLockedDir||this.game.physics.arcade.collide(i.sprite,s.sprite)&&(t=!0)}t&&dataStorage.isAudio&&this.soundEffects.play("car-hit")}if(this.inputLockTime>=this.time.time||this.world.mask)return this.inputLockTime,void this.time.time;if(this.hasButton,!this.game.input.activePointer.isDown&&this.selectSprite){var a=this.game.input.activePointer;return this.releaseTile(a),void(this.tutorial>0&&this.showTutorial())}if(this.game.input.activePointer.isDown){if(this.clickToEnd)return this.inputLockTime=this.time.time+500,void this.gameOver(!0);if((a=this.game.input.activePointer).targetObject){var o=a.targetObject.sprite;if(this.adbanner)return void(o!==this.adbanner&&o!==this.adbannerclose||(o===this.adbanner&&window.open("https://play.google.com/store/apps/details?id=com.minimindgames.boardgameproblems","_blank"),this.adbannerbg.kill(),this.adbanner.kill(),this.adbannerclose.kill(),this.adbanner=null));if(this.popupGroup.visible){if(bootState.app)return o===this.popupGroup.skip&&(this.inputLockTime=this.time.time+1e3,this.playerLives=3,localStorage.setItem("picturepuzzleLives",this.playerLives),this.gameOver(!1)),void(o===this.popupGroup.play&&(this.showAdBanner(),this.inputLockTime=this.time.time+1e3,this.playerLives=3,localStorage.setItem("picturepuzzleLives",this.playerLives),this.popupGroup.hide()));o===this.popupGroup.quit?(this.inputLockTime=this.time.time+1e3,this.backToMenu()):o!==this.popupGroup.dialogBg&&(this.inputLockTime=this.time.time+1e3,this.popupGroup.hide())}else if(o===this.headerGroup.exit)this.inputLockTime=this.time.time+750,dataStorage.isAudio&&this.time.events.add(50,function(){this.soundEffects.play("notify")},this),this.popupGroup.showDialog(Text.AreYouSureToQuit,null,this,!0,!0);else if(o===this.headerGroup.score)this.inputLockTime=this.time.time+750,this.popupGroup.showBanner(this.scoreTip);else{if(this.hasHealth&&this.headerGroup.health.length>0)for(e=0;e<this.headerGroup.health.length;e++)if(o===this.headerGroup.health[e])return this.inputLockTime=this.time.time+750,void this.popupGroup.showBanner(this.scoreHealth);this.selectTile(a)}this.tutorialGroup.visible&&this.showTutorial()}else this.tutorialGroup.visible&&this.showTutorial(),this.popupGroup.visible&&(this.inputLockTime=this.time.time+750,this.popupGroup.hide())}this.inputLockTime,this.time.time}},showAdPopup:function(){this.selectTile1=null,this.selectTile2=null,this.graphics.visible=!1},showAdBanner:function(){if(isApp&&-1===location.href.indexOf("localhost"))webapp_ad.show(this.adShown.bind(this));else{this.adbannerbg=makeSprite(this.game,"popup-dim.png"),this.adbannerbg.width=this.game.width,this.adbannerbg.height=this.game.height,this.game.world.add(this.adbannerbg),this.adbanner=this.add.image(this.game.width/2,this.game.height/2,"banner"),this.adbanner.anchor.set(.5),this.adbanner.inputEnabled=!0,this.adbanner.input.useHandCursor=!1;let t=this.game.width/this.adbanner.width;t>1&&(t=1),this.adbanner.scale.set(t),this.adbannerclose=makeSprite(this.game,"popup-dialog-close.png"),this.adbannerclose.anchor.set(.5),this.game.world.add(this.adbannerclose),this.adbannerclose.inputEnabled=!0,this.adbannerclose.input.useHandCursor=!0,this.adbannerclose.x=.7*this.adbannerclose.width,this.adbannerclose.y=.7*this.adbannerclose.height}},backToMenu:function(t=.1){for(var e in this.quit=!0,this.graphics&&(this.graphics.destroy(),this.graphics=null),this.texture=this.textureSprite=this.textureBg=this.textureBgSprite=null,this.boardTexture=null,PIXI.BaseTextureCache)delete PIXI.BaseTextureCache[e];for(var e in PIXI.TextureCache)delete PIXI.TextureCache[e];t>0?this.time.events.add(Phaser.Timer.SECOND*t,function(){this.state.start("mainState")},this):this.state.start("mainState")},popupHidden:function(){this.isGameOver?this.time.events.add(750,function(){},this):(this.popupGroup.pausedTime&&(this.pausedTime=this.time.time-this.popupGroup.pausedTime,this.startTime+=this.pausedTime),this.game.physics.arcade.isPaused=!1)},createHeader:function(){this.headerGroup=new HeaderGroup(this.game,{width:0,height:75},{width:0,height:75},this),bootState.app?this.hasHealth=!1:(this.headerGroup.enable("header-score.png"),this.headerGroup.enable("header-exit.png"),this.hasHealth&&this.headerGroup.enable("header-health.png"),this.headerGroup.setScore(this.playLogic.countMisplaced.call(playState)))},createBoard:function(){if(this.boardGroup=new BoardGroup(this.game,{width:720,height:720},{width:720,height:720},0),this.createLevel(),this.goalFlag){var t=this.level.length*this.arcadeSpeed/this.boardGroup.size.width;this.goalFlag=this.boardGroup.addSprite("play-goal-1.png",t-.5,.1),dataStorage.debug||(this.goalFlag.animations.add("goal-flag",["play-goal-1.png","play-goal-3.png","play-goal-2.png","play-goal-3.png"]),this.goalFlag.animations.play("goal-flag",10,!0))}},shutdown:function(){this.bg=this.boardBg=null},gameLose:function(t,e){if(this.player.sprite.alive){var i=playService.getPlayer("me");0===i.wins&&playService.setScore(i.wins+1),this.player.sprite.kill(),this.player.sprite.tractorBeam&&(this.player.sprite.tractorBeam.alpha=0,this.player.sprite.tractorBeamBubble.alpha=0),this.time.events.add(200,function(){this.showText(null,t)},this),--this.playerLives>0?(this.inputLockTime=this.time.time+500,this.time.events.add(e,function(){this.oneMoreTime()},this)):(dataStorage.isAudio,mainState.music,this.inputLockTime=this.time.time+1e3,this.isGameOver=!0,this.time.events.add(e,function(){this.game.physics.arcade.isPaused=!0,this.endGame(t)},this))}},gameWin:function(){var t=playService.getPlayer("me");if(playService.setScore(t.wins+1),0===mainState.score)e=this.level.desc;else{++this.feedbackNo>=this.feedback.length-1&&(this.feedbackNo=0);var e=this.feedback[this.feedbackNo]}this.endGame(e),this.inputLockTime=this.time.time+1e3},endGame:function(t){mainState.music,dataStorage.isAudio&&this.soundEffects.play("upgrade"),this.inputLockTime=this.time.time+750,this.game.camera.reset(),this.bestScore>=100||(t=this.bestScore>=this.level.progress?this.bestScore===this.level.progress?"Your score "+this.bestScore+" %!":"Your new highscore "+this.bestScore+" %!":"Your score "+this.bestScore+" %!"),this.bestScore>this.level.progress&&(this.level.progress=this.bestScore,dataStorage.setProgress(this.level.id,this.level.progress));this.popupGroup.showInfo(this.level.title,"",t,this.hitToContinue,0,this,this.backToMenu,!0,"player-win-1.png")},showText:function(t,e){this.helpText.text=e,this.helpText.x=this.game.width/2,this.helpText.y=this.game.height/3,this.helpText.alpha=1,this.helpText.bringToTop(),this.helpText.revive(),this.add.tween(this.helpText).to({alpha:0},2e3,Phaser.Easing.Quadratic.In,!0,0).onComplete.add(function(){this.helpText.kill()},this),this.countdown=0},showTutorial:function(){this.playLogic.showTutorial.call(this)},startup:function(){this.startTime=this.time.time,this.resume()},overlap:function(t){if(this.effectGroup.start(this.boardGroup.getCenterX(t),this.boardGroup.getCenterY(t),0,0),t===this.player.sprite)this.gameLose("Crash on Rock!",1250);else{t.kill(),this.boardGroup.move(t,0,0);for(var e=0;e<this.crafts.length;e++)if(this.crafts[e].sprite===t){this.crafts[e].start(0);break}}dataStorage.isAudio&&this.soundEffects.play("explode")},collide:function(t,e){return!1},oneMoreTime:function(){this.hasHealth&&(this.headerGroup.health[this.playerLives].alpha=.25),this.boardGroup.move(this.player.sprite,0,0),this.player.start(0)},startMusic:function(){if(mainState.music){if(mainState.music.isPlaying&&this.time.time<=mainState.musicTime+3e4)return;mainState.music.stop()}dataStorage.isMusic&&dataStorage.isAudio&&this.time.events.add(50,function(){var t=["POL-lonely-soul-short","POL-online-deal-short","POL-full-hand-short","POL-heartbeats-short","POL-tv-show-2-short","POL-tv-show-1-short","POL-top-secret-short","POL-sweet-resort-short","POL-still-life-short","POL-smoke-club-short","POL-solitude-short","POL-mighty-bop-short","POL-metro-short","POL-late-night-short","POL-her-skin-short","POL-borsalino-short"];this.mainMusic=t[mainState.musicNo],this.time.time>mainState.musicTime+3e4&&(mainState.musicNo++,mainState.musicTime=this.time.time),mainState.musicNo>=t.length&&(mainState.musicNo=0);var e="";bootState.isApp&&(e=""),this.load.audio(this.mainMusic,[e+"music/"+this.mainMusic+".ogg",e+"music/"+this.mainMusic+".mp3"]),this.load.start(),this.load.onLoadComplete.addOnce(this.loadComplete,this)},this)},loadComplete:function(){dataStorage.isMusic&&"playState"===this.game.state.current&&(mainState.music=this.game.add.audio(this.mainMusic),mainState.music.loopFull(.25))}},mainState=(volume=.3,{forceLevel:-1,isCreateMode:!1,backgroundColor:"0xeeeeee",currentCollection:0,musicTime:0,difficulty:1,goNextLevel:!1,chapterN:-1,startPlay:function(){},addPhoto:function(){var t=this.photo=this.boardGroup.addSpriteFromFile(this.image,0,0),e=this.game.add.graphics(0,0);e.dx=e.dy=0,this.boardGroup.add(e),e.beginFill();return e.drawRect(90,160,540,400),e.endFill(),t.mask=e,t.height<720&&t.scale.set(720/t.height),t},updateProgress:function(){t=this.titleSprite=this.boardGroup.addSprite("main-board-title.png",0,-311.5/720),this.nextSprite=t=this.boardGroup.addSprite("main-board-next.png",298/720,294.5/720),t.inputEnabled=!0,t.input.useHandCursor=!0,t.kill(),this.prevSprite=t=this.boardGroup.addSprite("main-board-prev.png",-298/720,294.5/720),t.inputEnabled=!0,t.input.useHandCursor=!0,t.kill(),this.worldLabel=this.boardGroup.addText("",0,-.32,"000000",40),this.levelLabel=this.boardGroup.addText("",0,-.38,"000000",30),this.authorLabel=this.boardGroup.addText("",0,.35,"333333",32),this.authorLabel.inputEnabled=!0,this.authorLabel.input.useHandCursor=!0,this.authorLabel.kill(),this.addPhoto().sendToBack(),x=0,y=.35;var t=this.playBg=this.boardGroup.addSprite("main-level1.png",0,y);this.add.tween(this.playBg.scale).to({x:.99,y:.98},500,Phaser.Easing.Sinusoidal.In,!0).repeat(Number.MAX_VALUE).yoyo(!0),this.play=this.boardGroup.addSprite("main-play.png",0,y),this.playBg.inputEnabled=!0,this.playBg.input.useHandCursor=!0,this.play.kill();this.playText=this.add.text(0,0,Text.PLAY,{font:"48px",fill:"#ffffff",wordWrap:!1,align:"center"}),this.playText.anchor.set(.5),this.playText.setShadow(3,3,"rgba(0,0,0,0.5)",5),this.playBg.addChild(this.playText),this.shortcut1=this.addShortcut("Info",-.25,.35,1,playGridJigsaw),this.shortcut3=this.addShortcut(Text.find,.25,.35,3,playGridJigsaw),this.openChapter(this.chapter)},openChapter:function(t){var e,i;this.chapter=t,t.level>=t.info.total_photos?this.enablePlay=!1:this.enablePlay=!0;var s,a=this.playGrid.type;this.enablePlay?i=e=t.info.title:(e=t.info.title,i=a+"All complete. Select next.");var o,h,r=(s=t.level<t.info.total_photos?t.data[t.level]:t.data[t.info.total_photos-1]).user.name;(e=t.info.title).length>30&&(e=e.substr(0,30),e+="..."),i=this.enablePlay?a:Text.PuzzleSolved,this.worldLabel.text=e,this.levelLabel.text=i,this.authorLabel.text="Photo by "+r+" ",this.authorName=r,this.collectionName=this.chapter.info.user.name,this.enablePlay&&t===this.chapter?this.playBg.revive():(this.playBg.kill(),this.play.kill()),this.playGrid.lastChapter().chapter!==t.chapter?this.nextSprite.revive():this.nextSprite.kill(),this.playGrid.firstChapter().chapter!==t.chapter?this.prevSprite.revive():this.prevSprite.kill();var n=this.game;n.width>n.height?(o=n.width,h=n.height):(o=n.height,h=n.width),o<720&&(o=720),h<720&&(h=720);var l=s.urls.full+"&w="+o+"&h="+h;this.photo.loadTexture(l)},name:"mainState",spriteAtlas:"atlas",goal:"Music by PlayOnLoop.com\n\nSounds by NoiseForFun.com\n\nSee details at minimindgames.com",score:0,scoreMax:25,resize:function(){if(this.landText||(this.landText=this.add.text(0,0,"Landscape")),"Landscape"===this.landText.text){if(this.game.height>this.game.width)return this.landText.text="Portrait",playGridJigsaw.setOrientation(mainState.getOrientation()),void location.reload()}else if(this.game.width>=this.game.height)return this.landText.text="Landscape",playGridJigsaw.setOrientation(mainState.getOrientation()),void location.reload();var t=onResize.call(this,this.scale,{width:this.game.width,height:this.game.height});if(this.effectGroup&&this.effectGroup.snowing&&(this.effectGroup.snowing.x=this.game.width/2,this.effectGroup.snowing.y=-this.game.height,this.effectGroup.snowing.width=this.game.width,this.effectGroup.snowing.height=2*this.game.height),this.dim&&(this.dim.width=this.game.width,this.dim.height=this.game.height),this.helpText&&(this.helpText.fontSize=64*t),bootState.app){this.time.events.add(.25*Phaser.Timer.SECOND,function(){"undefined"!=typeof webapp_ad&&this.time.events.add(1*Phaser.Timer.SECOND,function(){this.loadAd()},this)},this);var e,i,s=0,a=this.game.width>this.game.height,o=140,h=(a?this.game.height:this.game.width)/(4*o);if(h>1&&(h=1),o*=1.15*h,!this.headerGroup)return;this.headerGroup.appOption.scale.set(h),this.headerGroup.appInfo.scale.set(h),a?(e=this.game.width/2-2*o,i=this.game.height/2-1*o):(e=this.game.width/2-1*o,i=this.game.height/2-2*o);for(var r=0;r<this.collections.length;r++){var n=this.collections[r];n.x=e,n.y=i,n.scale.set(h),e+=o,s++,a?5===s&&(s=0,e-=5*o,i+=o):3===s&&(s=0,e-=3*o,i+=o)}}this.landText&&(this.landText.x=this.game.width/2,this.landText.y=this.landText.height/2)},init:function(t){this.game.input.touch.preventDefault=!1,bootState.app?(bootState.playGrid=playGridJigsaw,bootState.playLogic=playLogicJigsaw,this.playGrid=bootState.playGrid,this.playLogic=bootState.playLogic):this.playGrid=bootState.playGrid},setImage:function(t){this.queryImageSrc=t.src,this.queryImageAuthor=t.author,this.queryImageLink=t.link},preload:function(){if(bootState.app)return this.load.image("quack.png","cache/quack.png"),this.load.atlasXML("atlas","cache/atlas/sprites.png","cache/atlas/sprites.xml"),this.game.load.spritesheet("collections","cache/collections.png",120,120),void this.load.audiosprite("sound-effects",["cache/tracks.ogg"],null,bootState.soundEffects());if(dataStorage.debug&&this.spriteAtlas)for(var t=this.game.cache.getFrameData(this.spriteAtlas).getFrames(),e=0;e<t.length;e++){var i=t[e].name;this.cache.checkImageKey(i)||this.game.load.image(i,"cache/"+this.spriteAtlas+"/"+i)}!this.chapter&&this.chapterLoading&&(this.chapter=this.chapterLoading,this.chapterLoading=null);var s,a,o=this.game.cache.getJSON(this.chapter.chapter);this.chapter.info=o,bootState.app?this.chapter.info.total_photos=o.length:this.chapter.info.total_photos>30&&(this.chapter.info.total_photos=30);var h,r,n=this.game;n.width>n.height?(s=n.width,a=n.height):(s=n.height,a=n.width),s<720&&(s=720),a<720&&(a=720),bootState.app||(o=this.game.cache.getJSON(this.chapter.levels)),this.chapter.data=o,h=this.chapter.level<this.chapter.info.total_photos?this.chapter.level:this.chapter.info.total_photos-1,this.chapter.info.total_photos>30&&(this.chapter.info.total_photos=30),bootState.app,r=o[h],bootState.app,this.queryImageSrc&&(r.urls.full=this.queryImageSrc+"&w="+s+"&h="+a,r.user.name=this.queryImageAuthor,r.user.links.html=this.queryImageLink,this.queryImageSrc=null),this.image=r.urls.full+"&w="+s+"&h="+a,this.author=r.user.name,this.authorLink=r.user.links.html,this.game.load.image(this.image),this.enablePlay=!0,this.startPlay()},loadAd:function(){Android.loadAd()||this.time.events.add(1*Phaser.Timer.SECOND,function(){},this)},playSound:function(t){if(bootState.sound&&this.soundEffects){var e=volume;"good"===t&&(e/=2),this.soundEffects.play(t,e)}},getOrientation:function(){return this.landText.text},create:function(){{let i=16;var t={font:i+"px",fill:"#000",wordWrap:!1,fontWeight:"normal",align:"center",backgroundColor:"#ff0"},e=this.game.width>this.game.height?"Landscape":"Portrait";this.landText=this.add.text(0,0,e,t),this.landText.x=this.game.width/2,this.landText.y=this.landText.height/2*1.25,this.landText.anchor.set(.5),this.landText.inputEnabled=!0,this.landText.input.useHandCursor=!0,this.landText.visible=!1,this.landText.events.onInputUp.add(function(){var t={font:i+"px",fill:"#000",wordWrap:!1,fontWeight:"normal",align:"center",backgroundColor:"#cc99cc"};this.orientationText=this.add.text(this.game.width/2,this.game.height/2," Switching phone orientation.",t),this.orientationText.anchor.set(.5),this.time.events.add(.75*Phaser.Timer.SECOND,function(){var t;"Switch orientation"!==this.landText.text&&(t="Landscape"===this.landText.text?"Portrait":"Landscape",webapp_ad.switchOrientation(t))},this)},this)}if(playGridJigsaw.setOrientation(mainState.getOrientation()),bootState.app){if(this.cache.checkSoundKey("sound-effects")&&(this.soundEffects=this.add.audioSprite("sound-effects")),this.goNextLevel&&(this.goNextLevel=!1,this.loadNextLevel(this.game)))return void this.load.start();this.dim=makeSprite(this.game,"popup-dim.png"),this.game.world.add(this.dim),this.dim.alpha=.75,this.dim.visible=!1,this.createHeader(),this.collections=[];for(var i=0;i<15;i++){(n=this.game.add.sprite(0,0,"collections")).frame=i,n.anchor.set(.5),n.inputEnabled=!0,n.input.useHandCursor=!0,this.collections.push(n);var s=playGridJigsaw.scores[i];0;for(var a=localStorage.getItem(mainState.getOrientation()+"picturepuzzlelevelNo"+s.chapter)||"0",o=parseInt(a),h=0;h<3;h++){var r=makeSprite(this.game,"star.png");r.scale.set(.25),r.anchor.set(.5),r.y=n.height/2+r.height/2*1.15,n.addChild(r),0===h?r.x=-r.width:2===h&&(r.x=r.width),o<=0?r.tint=0:o<10?h>0&&(r.tint=0):o<20&&h>1&&(r.tint=0)}o>=20&&(n.allDone=!0)}this.game.scale.setResizeCallback(this.onResize,this),this.resize(),this.world.mask&&(this.world.mask.destroy(),this.world.mask=null),this.time.events.add(.25*Phaser.Timer.SECOND,function(){document.getElementById("loader")&&(document.getElementById("loader").style.display="none")},this)}var n;if(!bootState.app)if(document.getElementById("loader").style.display="none",(n=this.add.tileSprite(0,0,this.game.width,this.game.height,"atlas","main-bg.png")).alpha=1,n.sendToBack(),this.chapterLoading=null,this.chapter||alert("Oh dear... something is very wrong on the server. Please try to reload."),bootState.app)bootState.app;else if(this.playGrid.tutorial&&this.chapter.level<this.chapter.info.total_photos)this.state.add("playState",playState,!0);else{if(this.collectionLink=this.chapter.info.links.html,playState.upgrade&&this.chapter.level<this.chapter.info.total_photos)return playState.upgrade=!1,void this.state.add("playState",playState,!0);this.recommend=!1,playState.upgrade&&this.chapter.level>=this.chapter.info.total_photos&&(this.recommend=!0),playState.upgrade=!1,this.cache.checkSoundKey("sound-effects")?(this.soundEffects=this.add.audioSprite("sound-effects"),Object.keys&&Object.keys(this.soundEffects.sounds).forEach(function(t,e){this.soundEffects.sounds[t].allowMultiple=!0},this)):dataStorage.isAudio=!1,this.controlGroup=new ControlGroup(this.game,{width:210,height:0},{width:0,height:250}),this.controlGroup.isMain=!0,this.createHeader(),this.createBoard(),this.createPopup();this.boardGroup.addSprite("main-board-bg.png",0,0);this.photo.bringToTop(),this.playBg.bringToTop(),this.play.bringToTop(),this.shortcut1.bringToTop(),this.shortcut3.bringToTop(),this.shortcut3.visible=!1,this.boardGroup.addSprite("frame.png",0,.01);t={font:"128px",fill:"#000000",wordWrap:!1,fontWeight:"bold",align:"center",backgroundColor:"#ffff00"};this.helpText=this.add.text(0,0,"",t),this.helpText.anchor.set(.5),this.helpText.kill(),this.game.scale.setResizeCallback(this.onResize,this),this.resize(),this.startMusic(),this.start(),this.recommend&&this.popupGroup.showDialog(Text.WorldCompletedOpenNext,null,this,!0,!1,!1,!1,!1,!0)}},clearProgress:function(){console.log("clear progress");for(var t=0;t<12;t++){var e=playGridJigsaw.scores[t];localStorage.removeItem(mainState.getOrientation()+"picturepuzzlelevelNo"+e.chapter)}},setDifficulty:function(t){},addImageLoaded2:function(){},fileComplete23:function(t,e,i,s,a){i&&e===this.added&&(this.controlGroup.addSpriteFromFile(e,0,-.8),this.controlGroup.addSpriteFromFile(e,0,-.4),this.controlGroup.addSpriteFromFile(e,0,-.6),this.controlGroup.addSpriteFromFile(e,0,-.2))},addImage3:function(t,e,i){this.added=i,this.load.crossOrigin="Anonymous",this.load.image(i),this.load.onFileComplete.add(this.fileComplete2,this)},addShortcut:function(t,e,i,s,a){var o=this.boardGroup.addSprite("main-button.png",e,i);o.gameID=a.gameID,o.inputEnabled=!0,o.input.useHandCursor=!0,o.scale.set(.7);var h=makeSprite(this.game,"main-shortcut"+s+".png",0,-10);o.addChild(h),h.anchor.set(.5);var r=[Text.TECH,Text.PROB,Text.PUZZ,Text.Fun],n={fill:"#000000",font:dataStorage.fontHeader,align:"center"},l=this.game.add.text(0,47,r[s-1],n);return l.fontSize=24,o.addChild(l),l.setShadow(3,3,"rgba(255,255,255,0.75)",5),l.anchor.set(.5,.5),o.worldID=s,o},addButton:function(t,e,i,s){var a=this.controlGroup.addSprite("main-button.png",e,i);a.inputEnabled=!0,a.input.useHandCursor=!0;var o={fill:"#ffffff",font:dataStorage.fontHeader,align:"center"},h=this.game.add.text(0,0,t,o);return h.fontSize=24,a.addChild(h),h.setShadow(3,3,"rgba(0,0,0,0.5)",5),h.anchor.set(.5,.5),a},createHeader:function(){this.headerGroup=new HeaderGroup(this.game,{width:260,height:0},{width:0,height:190},this),bootState.app?this.headerGroup.enable("app"):(this.headerGroup.enable("header-option.png"),this.headerGroup.enable("header-ad.png"),this.headerGroup.enable("header-info.png"))},createPopup:function(){this.popupGroup=new PopupGroup(this.game,{width:this.game.width,height:this.game.height}),this.popupGroup.enable("popup-banner.png"),this.popupGroup.enable("popup-dialog.png")},createBoard:function(){this.boardGroup=new BoardGroup(this.game,{width:720,height:720},{width:720,height:720}),this.updateProgress()},inputLocked:function(){return this.inputLockTime>=this.time.now||this.world.mask},inputLock:function(){this.inputLockTime=this.time.now+250},inputOption:function(t){if(t===this.headerGroup.info)return this.inputLock(),this.headerGroup.showOption(this),this.popupGroup.dim.tint=1578770,this.popupGroup.dim.revive(),!0},inputPopup:function(t){if(this.popupGroup)return this.popupGroup.visible?t===this.popupGroup.close||t===this.popupGroup.redButton||t===this.popupGroup.play||t===this.popupGroup.claim||3===playState.orientation||4===playState.orientation?(this.popupGroup.recommend?(this.inputLock(),this.popupGroup.hide()):(this.popupGroup.dialogBg.visible&&t===this.popupGroup.play&&("Unsplash"===this.popupGroup.playText.text?window.location.href=this.collectionLink:this.popupGroup.hide()),playState.orientation=0,this.inputLock(),this.popupGroup.hide()),!0):t===this.popupGroup.greenButton?(this.popupGroup.recommend?(this.inputLock(),this.popupGroup.hide()):(this.inputLock(),removeScore(this.playGrid,this.chapter),dataStorage.saveScores(),dataStorage.dataLoaded=!1,bootState.loadGame=-1,bootState.loadCollection=-1,bootState.playGrid=null,bootState.playLogic=null,bootState.reset=!0,bootState.restart()),!0):(this.popupGroup.dialogBg.visible&&(this.inputLock(),this.popupGroup.hide()),!0):this.headerGroup.optionBg.visible?t===this.headerGroup.optionSound?(this.inputLock(),this.headerGroup.select(this.headerGroup.optionSound),dataStorage.isAudio?this.soundEffects&&this.soundEffects.play("tik"):this.music&&this.music.stop(),!0):t===this.headerGroup.optionMusic?(this.inputLock(),this.headerGroup.select(this.headerGroup.optionMusic),dataStorage.isMusic?this.startMusic():this.music&&this.music.stop(),!0):(this.inputLock(),this.headerGroup.hideOption(),this.popupGroup.dim.kill(),!0):void 0},inputExit:function(t){},inputPlay:function(t){if(t===this.playBg)return this.inputLock(),fadeOutEffect(this,0).onComplete.addOnce(function(){this.state.add("playState",playState,!0)},this),!0},inputShortcut:function(t){if(t===this.shortcut1)return this.inputLock(),this.popupGroup.showDialog(Text.collection+this.collectionName+"\n"+Text.photoBy+this.authorName+"\nUnsplash.com\n\nMusic PlayOnLoop.com\nSounds NoiseForFun.com",null,this,!0,!1,!1,!1,"Unsplash"),!0;if(t===this.shortcut3){this.inputLock();var e="best-puzzles/index.html";navigator.userAgent.match(/Android/i)?document.location=e:window.location.replace(e)}},update:function(){if(!this.inputLocked()){var t=null;this.game.input.activePointer.isDown&&this.game.input.activePointer.withinGame&&(t=this.game.input.activePointer,this.orientationText&&this.orientationText.visible&&(this.orientationText.kill(),this.orientationText=null));var e=null;if(t){if(t.targetObject&&(e=t.targetObject.sprite),bootState.app){if(this.dim.visible)return this.inputLock(),e===this.headerGroup.optionSound&&this.headerGroup.toggleAudio(),e===this.headerGroup.optionMusic&&this.time.events.add(.1*Phaser.Timer.SECOND,function(){var t;"Switch orientation"!==this.landText.text&&(t="Landscape"===this.landText.text?"Portrait":"Landscape",this.landText.text="Switch orientation",webapp_ad.switchOrientation(t))},this),e===this.headerGroup.optionReset&&(this.clearProgress(),location.reload()),this.playSound("tik"),this.headerGroup.hideOption(this),void(this.dim.visible=!1);e===this.headerGroup.appOption&&(this.inputLock(),this.headerGroup.showOption(this),this.dim.visible=!0,this.dim.tint=0),e===this.headerGroup.appInfo&&(this.inputLock(),this.playSound("tik"),infoShow(!0));let t=this.collections.indexOf(e);return void(t>=0&&this.startAppChapter(t))}if(this.inputPopup(e))return;if(this.inputOption(e))return;if(this.inputPlay(e))return;if(this.inputShortcut(e))return;if(this.inputExit(e))return}}},startAppChapter:function(t){if(this.inputLockTime=this.time.now+1e3,this.collections[t].allDone){var e={font:64+"px",fill:"#ff00ff",wordWrap:!1,fontWeight:"bold",align:"center"},i=this.add.text(this.game.width/2,this.game.height/2,"ALL SOLVED",e);return i.setShadow(2,2,"rgba(0,0,0,1)",2),i.anchor.set(.5),void this.add.tween(i).to({alpha:0},2e3,Phaser.Easing.Quadratic.In,!0,0).onComplete.add(function(){})}this.chapterN=t;var s=playGridJigsaw.scores[t];this.chapterLoading=null,this.loadChapter(this.game,s),mainState.chapter=s,this.load.onLoadComplete.addOnce(function(){this.loadNextLevel(this.game)},this),this.load.start()},onNextChaperLoaded:function(){var t=this.game.cache.getJSON(this.chapterLoading.chapter);console.log("onNextChaperLoaded",t),this.chapterLoading.info=t,t=this.game.cache.getJSON(this.chapterLoading.levels),this.chapterLoading.data=t,this.chapter.info.total_photos>30&&(this.chapter.info.total_photos=30),this.chapterLoading.info.total_photos>30&&(this.chapterLoading.info.total_photos=30),this.time.events.add(0,function(){var e,i,s,a=this.game;a.width>a.height?(e=a.width,i=a.height):(e=a.height,i=a.width),e<720&&(e=720),i<720&&(i=720),s=this.chapterLoading.level<this.chapterLoading.info.total_photos?t[this.chapterLoading.level]:t[this.chapterLoading.level-1],this.image=s.urls.full+"&w="+e+"&h="+i,this.author=s.user.name,this.game.load.image(this.image),this.load.onLoadComplete.addOnce(this.onNextImageLoaded,this),this.load.start()},this)},onNextImageLoaded:function(){console.log("onNextImageLoaded"),this.openChapter(this.chapterLoading),this.chapterLoading=null},start:function(){(this.game.physics&&(this.game.physics.arcade.isPaused=!1),this.world.mask&&this.world.mask.destroy(),this.bgEffect&&(this.effectGroup=new EffectGroup(this.game,{width:720,height:720},{width:720,height:720}),this.effectGroup.enable(this.bgEffect),this.time.events.add(0,function(){this.effectGroup.start(this.game.width/2,-this.game.height,this.game.width,2*this.game.height)},this)),this.world.mask=null,this.stage.backgroundColor===this.backgroundColor)?(playService.mainStarted=!0,playService.showLogin(),this.started=!0):fadeOutEffect(this,this.backgroundColor,!0).onComplete.addOnce(function(){playService.mainStarted=!0,playService.showLogin(),this.started=!0,this.world.mask.destroy(),this.world.mask=null},this);this.enablePlay,3===playState.orientation?this.popupGroup.showBanner("Game orientation changed."):4===playState.orientation?playState.upgrade?this.showAchievement(!0):this.popupGroup.showBanner("Game resumed."):playState.upgrade&&this.showAchievement(!0)},popupHidden:function(){this.game.physics.arcade.isPaused=!1},shutdown:function(){this.bg=null,this.effectGroup=null},loadImage:function(t){console.log("loadImage",t),this.load.crossOrigin="Anonymous",this.load.image(t),this.load.onFileComplete.add(this.onLoadImage,this),this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.load.start()},updateScores:function(){},updateAchievements:function(){this.currentButton&&this.updateLeaderScore(this.currentButton)},iconComplete:function(t,e,i,s,a){console.log("Loading "+t+" %"),console.log(i+" "+e),i&&e&&this.boardGroup.addSpriteFromFile(e,.1,.1)},printCache:function(t){var e=this.cache.getKeys(t),i="";for(var s in e)i+=s+" ";e.length>0&&console.log(t+":"+i),this.cacheItems+=e.length},showPhaserCache:function(){this.printCache(Phaser.Cache.CANVAS),this.printCache(Phaser.Cache.IMAGE),this.printCache(Phaser.Cache.TEXTURE),this.printCache(Phaser.Cache.SOUND),this.printCache(Phaser.Cache.TEXT),this.printCache(Phaser.Cache.PHYSICS),this.printCache(Phaser.Cache.TILEMAP),this.printCache(Phaser.Cache.BINARY),this.printCache(Phaser.Cache.BITMAPDATA),this.printCache(Phaser.Cache.BITMAPFONT),this.printCache(Phaser.Cache.JSON),this.printCache(Phaser.Cache.XML)},showPixiCache:function(){var t="";for(var e in PIXI.BaseTextureCache)t+=e+" ",this.cacheItems++;for(var e in PIXI.TextureCache)t+=e+" ",this.cacheItems++;console.log("PIXI Base/TextureCache: "+t)},showCache:function(t){this.cacheItems=0,console.log(t),this.showPhaserCache(),this.showPixiCache(),console.log("world length: "+this.world.children.length),console.log("cache length: "+this.cacheItems)},showAchievement:function(t){this.popupGroup.showDialog("",null,this,!0,!1,"Upgrade Snake",t)},showText:function(t,e){this.helpText.text=e,this.helpText.x=this.game.width/2,this.helpText.y=this.game.height/2,this.helpText.alpha=1,this.helpText.bringToTop(),this.helpText.revive(),this.add.tween(this.helpText).to({alpha:0},1750,Phaser.Easing.Quadratic.InOut,!0,0).onComplete.add(function(){},this)},loadChapter:function(t,e){null!==e&&(t.load.crossOrigin="Anonymous",bootState.app&&(e.level=localStorage.getItem(mainState.getOrientation()+"picturepuzzlelevelNo"+e.chapter),null===e.level&&(e.level="0",localStorage.setItem(mainState.getOrientation()+"picturepuzzlelevelNo"+e.chapter,e.level)),e.level=parseInt(e.level)),this.chapterLoading=e,e.levels=e.chapter+"/photos",t.cache.checkJSONKey(e.chapter)||(bootState.app?t.load.json(e.chapter,"https://api.unsplash.com/collections/"+e.levels+"/?client_id="+dataStorage.appID+"&per_page=100"):t.load.json(e.chapter,"https://api.unsplash.com/collections/"+e.chapter+"/?client_id="+dataStorage.appID)),t.cache.checkJSONKey(e.levels)||bootState.app||t.load.json(e.levels,"https://api.unsplash.com/collections/"+e.levels+"/?client_id="+dataStorage.appID+"&per_page=100"))},loadNextLevel:function(t,e){if(bootState.app&&(this.chapter.info={total_photos:this.game.cache.getJSON(this.chapter.chapter).length}),this.forceLevel=-1,this.chapter.level===this.chapter.info.total_photos-1&&(this.forceLevel=2),this.chapter.level<this.chapter.info.total_photos){var i;i=bootState.app?this.game.cache.getJSON(this.chapter.chapter):this.game.cache.getJSON(this.chapter.levels);var s,a,o=this.chapter.level,h=i[o];if((t=this.game).width>t.height?(s=t.width,a=t.height):(s=t.height,a=t.width),s<720&&(s=720),a<720&&(a=720),bootState.app){var r=null;return o<i.length-1&&(r=i[o+1]),r&&(this.nextImage=r.urls.full+"&w="+s+"&h="+a),this.image=h.urls.full+"&w="+s+"&h="+a,this.author=h.user.name,this.authorLink=h.user.links.html,webapp_ad.showGuide(!0,playState),this.state.add("playState",playState,!0),!0}var n=h.urls.full+"&w="+s+"&h="+a;return this.game.load.image(n),!0}return bootState.app||(this.level=0,this.loadChapter(t,this.playGrid.nextChapter(this.chapter.chapter)),this.chapterLoading=null),!1},startMusic:function(){if(this.music){if(this.music.isPlaying&&this.time.time<=this.musicTime+3e4)return;this.music.stop()}return this.time.events.add(10,function(){var t=["POL-lonely-soul-short","POL-online-deal-short","POL-full-hand-short","POL-heartbeats-short","POL-tv-show-2-short","POL-tv-show-1-short","POL-top-secret-short","POL-sweet-resort-short","POL-still-life-short","POL-smoke-club-short","POL-solitude-short","POL-mighty-bop-short","POL-metro-short","POL-late-night-short","POL-her-skin-short","POL-borsalino-short"];this.musicNo||(this.musicNo=this.rnd.integerInRange(0,t.length-1)),this.mainMusic=t[this.musicNo],this.time.time>this.musicTime+3e4&&(this.musicNo++,this.musicTime=this.time.time),this.musicNo>=t.length&&(this.musicNo=0);var e="";bootState.app&&(e=""),this.load.audio(this.mainMusic,[e+"music/"+this.mainMusic+".ogg",e+"music/"+this.mainMusic+".mp3"]),this.load.onLoadComplete.addOnce(this.loadComplete,this),this.load.start()},this),!0},loadComplete:function(){"mainState"===this.game.state.current&&(dataStorage.isMusic&&(this.music=this.game.add.audio(this.mainMusic),this.music.loopFull(.25)),this.time.events.add(100,function(){this.loadExternalImages()},this))},openHTML:function(){},openLink:function(t){var e;(window.minimindgamesInstance.add(2),bootState.loadGame=-1,bootState.loadCollection=-1,mainState.openHTML(t),(e=document.getElementById("images")).style.display="none",(e=document.getElementById("playlist")).style.display="block",(e=document.getElementById("info")).style.display="block",t)&&((e=document.getElementById(t))&&e.scrollIntoView())},openImages:function(){this.openHTML(),document.getElementById("images").style.display="block",document.getElementById("playlist").style.display="none",document.getElementById("info").style.display="block",document.getElementById("info-gametype").innerHTML=this.playGrid.type},loadExternalImages:function(){var t;bootState.app||((t=this.playGrid.nextChapter(this.chapter.chapter))&&mainState.loadChapter(this.game,t),(t=playGridJigsaw.lastChapter())&&mainState.loadChapter(this.game,t),(t=playGridRolling.lastChapter())&&mainState.loadChapter(this.game,t),(t=playGridSliding.lastChapter())&&mainState.loadChapter(this.game,t),(t=playGridColor.lastChapter())&&mainState.loadChapter(this.game,t),t&&this.load.start(),this.chapterLoading=null)},setActiveShortcut:function(t){},htmlHide:function(){},htmlShow:function(){}});function setGameConfig(t,e,i){t.loadGame=e,i&&(t.loadCollection=i)}var hidden,visibilityChange,bootState={app:!0,config:{},backgroundColor:"#fff",soundEffects:function(){return bootState.app?{spritemap:{tik:{start:0,end:.02,loop:!1},tok:{start:1.6,end:2.1,loop:!1},good:{start:.6,end:1.6,loop:!1}}}:{spritemap:{tik:{start:0,end:.05,loop:!1},tok:{start:.1,end:.12,loop:!1},tak:{start:.15,end:.17,loop:!1},good2:{start:.6,end:1.55,loop:!1},deny:{start:1.6,end:2.1,loop:!1},notify:{start:2.1,end:2.96,loop:!1},good:{start:2.96,end:3.2,loop:!1}}}},loadExternalResources:function(){switch(this.loaded=!1,this.createGame=!1,bootState.app&&(this.loadGame=1),parseInt(this.loadGame)){case 3:this.playGrid=playGridSliding,this.playLogic=playLogicSliding;break;case 2:this.playGrid=playGridRolling,this.playLogic=playLogicRolling;break;case 4:this.playGrid=playGridColor,this.playLogic=playLogicColors;break;case 1:this.playGrid=playGridJigsaw,this.playLogic=playLogicJigsaw}if(this.playGrid||(this.playGrid=playGridJigsaw,this.playLogic=playLogicJigsaw),!this.playGrid||!this.playLogic){var t=window.location.href;(t.indexOf("sliding")>0||t.indexOf("liukuva")>0)&&(this.playGrid=playGridSliding,this.playLogic=playLogicSliding),(t.indexOf("color")>0||t.indexOf("värillinen")>0)&&(this.playGrid=playGridColor,this.playLogic=playLogicColors)}var e,i,s;-1!==window.location.href.indexOf("#")&&(i=parseInt(window.location.href.substring(window.location.href.indexOf("#")+1,window.location.href.indexOf("#")+2)),s=parseInt(window.location.href.substring(window.location.href.indexOf("#")+3)),console.log(i,s),parseInt(i)&&parseInt(s)&&(this.loaded=!0,this.loadGame=i,this.loadCollection=s,e=this.playGrid.addChapter({chapter:this.loadCollection,level:0,progress:0})));bootState.app?e=this.playGrid.firstChapter():e||(e=this.playGrid.lastChapter()),bootState.playGrid=this.playGrid,bootState.playLogic=this.playLogic,bootState.chapter=this.chapter=e,this.game.cache.checkJSONKey(this.chapter.chapter)?console.log("ready"):(mainState.loadChapter(this.game,e),this.game.load.start())},name:"bootState",spriteAtlas:"atlas",resize:function(){onResize.call(this,this.scale,{width:this.game.width,height:this.game.height})},init:function(){gameConfig(this),Phaser.Canvas.setTouchAction(game.canvas,"auto"),this.load.crossOrigin="Anonymous",-1===window.location.href.indexOf("localhost")?bootState.app&&(this.load.path="picturepuzzle/"):this.load.path="/picturepuzzle/",this.dataLoaded||(this.dataLoaded=!0,dataStorage.init()),Phaser.Plugin.Debug},preload:function(){this.game.forceSingleUpdate=!0,this.game.renderer.renderSession.roundPixels=!1,this.stage.smoothed=!0,this.game.renderer.clearBeforeRender=!0,this.stage.backgroundColor=this.backgroundColor,this.scale.scaleMode=Phaser.ScaleManager.RESIZE,this.scale.fullScreenScaleMode=Phaser.ScaleManager.RESIZE,this.scale.setShowAll(),this.scale.refresh()},loadComplete:function(){this.state.add("mainState",mainState,!0)},create:function(){if(mainState.chapter=null,mainState.chapterLoading=null,this.input.maxPointers=1,0===window.location.href.indexOf("file:")&&(bootState.app=!0),0===window.location.href.indexOf("file:")&&(bootState.isApp=!0),bootState.app)return this.load.atlasXML("atlas","cache/atlas/sprites.png","cache/atlas/sprites.xml"),this.load.onFileComplete.add(this.fileComplete,this),this.load.onLoadComplete.addOnce(this.loadComplete,this),void this.load.start();this.boardGroup=new BoardGroup(this.game,{width:640,height:640},{width:640,height:640}),bootState.app||(this.boardGroup.addText(dataStorage.title,0,.2,"c98dd0",60),this.boardGroup.addText(Text.gameTitle,0,.3,"98a1c1",48),this.loadText=this.boardGroup.addText(Text.Loading,0,.4,"666666",32)),0===window.location.href.indexOf("//localhost")&&(bootState.isDebug=!0,dataStorage.debug=!0),path="//minimindgames.com/",bootState.isApp&&(path=""),path="";this.load.image("quack.png","cache/quack.png");this.load.audiosprite("sound-effects",[path+"music/sound-effects.ogg"],null,this.soundEffects()),bootState.app||this.loadExternalResources(),this.time.events.add(1,function(){this.load.atlasXML("atlas","cache/atlas/sprites.png","cache/atlas/sprites.xml"),this.load.onFileComplete.add(this.fileComplete,this),this.load.onLoadComplete.addOnce(this.loadComplete,this),this.load.start()},this),this.game.scale.setResizeCallback(this.onResize,this),this.resize()},fileComplete:function(t,e,i,s,a){this.loadText&&this.loadText.setText("Loading "+t+" %")},shutdown:function(){},restart:function(){console.log(bootState);var t=bootState.loadCollection,e=bootState.playGrid.gameID;location.href=location.protocol+"//"+location.host+location.pathname+"#"+e+"-"+t}};function createGame(){var t=window,e={width:t.innerWidth,height:t.innerHeight};window.game=new Phaser.Game(e.width,e.height,Phaser.AUTO,"canvas"),window.game.state.add("bootState",bootState,!0)}function gameConfig(t){}function addListener(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i}function openPlayList(){var t=this.getAttribute("data-id"),e=this.getAttribute("data-dispid");bootState.loadDispID=e||0;return bootState.loadGame=t.substr(0,1),bootState.loadCollection=t.substr(2),bootState.restart(),hideHtml(),!1}function openCollection(){console.log("openCollection");var t=this.getAttribute("data-id");this.href.indexOf("-");bootState.createCollection=!0,bootState.loadGame=0,bootState.loadCollection=parseInt(t),bootState.restart(),console.log("id "+t),console.log(bootState);var e=bootState.loadCollection,i=bootState.playGrid.gameID;return location.href=location.protocol+"//"+location.host+location.pathname+"#"+i+"-"+e,window.location.reload(),!1}function createCollection(){var t=this.getAttribute("data-id");return togglePopup(t),!1}function handleVisibilityChange(){document[hidden]?window.minimindgamesInstance.pause():window.minimindgamesInstance.play()}function queryChanged(t){if(t||(t="random"),t!==window.query){console.log("queryChanged: ",t),window.query=t;for(var e=document.getElementById("imagedata");e.firstChild;)e.removeChild(e.firstChild);window.imageQuery=t,window.minimindgamesInstance.searchCollection()}}void 0!==document.hidden?(hidden="hidden",visibilityChange="visibilitychange"):void 0!==document.mozHidden?(hidden="mozHidden",visibilityChange="mozvisibilitychange"):void 0!==document.msHidden?(hidden="msHidden",visibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(hidden="webkitHidden",visibilityChange="webkitvisibilitychange"),void 0===document.addEventListener||void 0===document[hidden]||document.addEventListener(visibilityChange,handleVisibilityChange,!1),window.minimindgamesInstance=window.minimindgamesInstance||{maxPlayListCount:0,started:!1,beginTime:0,time:0,data:[],url:null,isVisible:!0,play:function(){window.minimindgamesInstance.isVisible=!0,window.minimindgamesInstance.beginTime=Date.now()},pause:function(){window.minimindgamesInstance.isVisible=!1,window.minimindgamesInstance.time+=Date.now()-window.minimindgamesInstance.beginTime},dataUrl2:function(t){var e=[];"[object Array]"===Object.prototype.toString.call(t)?e=t.split(","):e.push(t);for(var i=[],s=0;s<e.length;s++){for(var a=!1,o=0;o<window.minimindgamesInstance.data.length;o++)if(window.minimindgamesInstance.data[o]===e[s]){a=!0;break}a||window.minimindgamesInstance.data.push(e[s])}for(var h=0;h<window.minimindgamesInstance.data.length;h++){var r="stat-spot-"+window.minimindgamesInstance.data[h],n=0;try{tmp=localStorage.getItem(r),parseInt(tmp)>0&&(n=tmp)}catch(t){}i.push(window.minimindgamesInstance.data[h]+"-"+n)}},add:function(t){window.minimindgamesAdded||(window.minimindgamesAdded=!0,window.minimindgamesInstance.beginTime=Date.now(),window.minimindgamesInstance.spotID=t,window.minimindgamesInstance.start())},start:function(){bootState.loadDispID=0,console.log("skip start")},startQuery:function(){bootState.loadDispID=0,this.images=[];var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState&&200===t.status&&t.responseText){var e=JSON.parse(t.responseText);if(e&&e.length>0)try{for(var i=0;i<e.length;i++){var s=e[i],a=s.urls.raw,o=document.createElement("div"),h=document.getElementById("imagedata"),r=document.createElement("a");r.className+=" ",window.minimindgamesInstance.images.push({src:s.urls.full,author:s.user.name,link:s.user.links.html}),r.href="#0-"+(window.minimindgamesInstance.images.length-1),addListener(r,"click",openPlayList),o=document.createElement("div"),a+="?fit=crop",a+="&w=150";var n=document.createElement("img");n.src=a+"&h=150",o.appendChild(n),o.style.cssFloat="left",o.style.padding="10px",r.appendChild(o),h.appendChild(r)}}catch(t){}}};var e="https://api.unsplash.com/photos/random/?client_id=c620666e9a20cba4b20f7a80ea901312a190c431871c38ce6c1df3f82e022995&count=30&w=100&query="+window.imageQuery;t.open("GET",e),t.send()},searchCollection:function(){bootState.loadDispID=0,this.images=[];var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState&&200===t.status&&t.responseText){var e=JSON.parse(t.responseText);if(e&&e.results.length>0)try{for(var i=0;i<e.results.length;i++){var s=e.results[i];if(console.log(s),!(s.total_photos<10)){var a=s.id,o=s.cover_photo.urls.raw,h=document.createElement("div"),r=document.getElementById("imagedata"),n=document.createElement("a");n.className+=" ",n.href="#",n.setAttribute("data-id",a),addListener(n,"click",openCollection),(h=document.createElement("div")).id="id-"+a,o+="?fit=crop",o+="&w=150";var l=document.createElement("img");l.src=o+"&h=150",h.appendChild(l),h.style.cssFloat="left",h.style.padding="10px",n.appendChild(h),r.appendChild(n)}}}catch(t){}}};var e="https://api.unsplash.com/search/collections?client_id=c620666e9a20cba4b20f7a80ea901312a190c431871c38ce6c1df3f82e022995&per_page=100&query="+window.imageQuery;t.open("GET",e),t.send()},updateTime:function(){var t=window.minimindgamesInstance.time/1e3;window.minimindgamesInstance.isVisible&&(t+=(Date.now()-window.minimindgamesInstance.beginTime)/1e3,window.minimindgamesInstance.beginTime=Date.now());return parseInt(t)},clickLink:function(t){}},window.imageQuery="";